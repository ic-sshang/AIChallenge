DRAFT
Environment Variables
Environment variables will be the primary mechanism used to provide the settings to a .Net application for a given environment.  The default ASP dotnet configuration provider will use values provided in the appsettings.json files which can be over written with environment variable values.  .Net uses double underscores to target nested configurations in JSON.
Example: 
An environment variable name “
Logging__LogLevel__Default
“ would be used to override / replace the default log level value from the below appsettings.json configuration.
{
	"Logging": {
		"LogLevel": {
			"Default": "Information",
			"Microsoft.AspNetCore": "Information"
		}
	}
}
Use dashes in the environment variable names
Don't 
Docker Files
Multi-stage builds will be used to simplify build environment configuration and provide a consistent build environment for .Net applications.  Docker will use the .Net SDK docker image to build the application, run unit tests, copy the build output to a new image, and use the new image as the final image for the container (discarding the previous images and content).
Unit Tests
Unit tests are run in the docker image build to reduce bugs from differences between environments.  Images that are produced will have passed all unit tests and get promoted up from lower to the upper environments.  The first environment is local development.  Running the unit tests for images used locally will help identify issues early on in the development process. 
Non-Root
Avoid running software as a root user.  This will improve our security posture and will help prevent malicious users from leveraging our software to run root commands.  Ports like 80 and 443 typically require root permission to bind to them so use a higher port instead, 8080 is our standard for web applications.
ARG CONFIGURATION=Release

# image for building the application
FROM mcr.microsoft.com/dotnet/sdk:6.0 as build-env
WORKDIR /src
COPY src/*.csproj .
RUN dotnet restore
COPY src .
RUN dotnet test --no-restore -c:$CONFIGURATION --results-directory:/testresults --logger:"trx;LogFileName=tests.trx"
RUN dotnet publish --no-restore -c:$CONFIGURATION -o /publish

# final image for running our application, just the runtime and our application assets
FROM mcr.microsoft.com/dotnet/aspnet:6.0 as runtime
WORKDIR /app
COPY --from=build-env /publish .

# for web applicatons use higher ports to avoid root user conflicts
ENV ASPNETCORE_URLS="http://*:8080"
EXPOSE 8080

# create a new group and non root user
RUN addgroup --group www --gid 2000 \
	&& adduser \
	--uid 1000 \
	--gid 2000 \
	"webapp"

# apply new user ownership, run as the new user
RUN chown webapp:www /app
USER webapp:www

# docker command to run on container startup
ENTRYPOINT ["dotnet", "mywebppp.dll"]
 URL:/spaces/ED/pages/2596044801/.Net+Core+Linux+and+Docker+-+CORE