Fill in project details in the table below. Type /date to quickly add the target release date, /jira to link to Jira epics or issues, and @mention functional owners to keep everyone on the same page.
Page Navigation
Jira ticket 
ITR
Release Date
Document status
DRAFT
Document owner
Solution engineer
 
Salesforce SOW
Knowledge Transfer
API Documentation
TEST BASE URL (they allow list and have added the IC servers): 
https://ictesttpsgateway.truecip.truepointsolutions.com/
PROD BASE URL:
API Authentication Method: API Key
APIKEY: E6716711-541E-4B28-87FE-9429F315E33D
Username: IC2022
Password: Modesto
Documentation: 
https://ictesttpsgateway.truecip.truepointsolutions.com/swagger/ui/index
 (filters by IP Address)
Agriculture:
API Details
IC Use
Partner API Name
Description
Request
Response
Specifications
RTDR: Balance Update (Agriculture)
ActivityBalances
Gets the most recent balances for an account, can also be used to pull all new bills
POST [Baseurl]/tps/customer/ar/ActivityBalances
{
    "CustomerID": [Custom1],
    "StartDate": CurrentDate - 6 months (in format  “2021-06-01”), 
    "IncludeAllActivitiesWithOutstandingBalances": 
true
,
}
 
StartDate
: The ‘look back’ period . (Format “2021-06-01” or “2021/06/01”). This will include all activities regardless of if they have a 0 balance
 
IncludeAllActivitesWithOutstandingBalances
: Set to true to include all activities with outstanding balances in addition to the data set of the lookback period.
 
{
  "Status": 0,
  "Message": "",
  "Field": null,
  "ErrorMessages": [],
  "WarningMessages": [],
  "SuccessMessages": [
    "Results Successfully Queried."
  ],
  "Exceptions": [],
  "Value": [
    {
      "AgencyType": "Ag",
      "CustomerId": "0000010160",
      "AccountNumber": "",
      "CustomerInformationKey": 1016,
      "CustomerAccountKey": 0,
      "Name": "Joseph R Miller Trust",
      "AddressStreet": "9425 Yosemite Blvd",
      "AddressCity": "Modesto",
      "AddressState": "CA",
      "AddressZip": "95357-1872",
      "ActivityType": "Bill",
      "ActivityId": "B-132483",
      "ActivityDate": "2020-11-30T00:00:00",
      "ActivityDueDate": "2020-12-20T00:00:00",
      "ActivityLastAdjustmentDate": "2022-08-25T12:59:00",
      "ActivityAmount": 589.22,
      "ActivityAmountDue": 53.57,
      "ActivityDescription": "2020 Irrigation Bills Installment 1"
    }  ],
  "Request": null,
  "Headers": null
}
ActivityID is the bill number
Update balance due with ActivityAmountDue by matching on ActivityID (Invoice Number)
If a successful response is received, and a bill is not included, set the bill to 0
RTDR - blocked status (Agriculture)
Cash only flag
GET[Baseurl]/tps/customer/BillingPreferences/{Custom3}
{
  "Status": 0,
  "Message": "",
  "Field": null,
  "ErrorMessages": [],
  "WarningMessages": [],
  "SuccessMessages": [],
  "Exceptions": [],
  "Value": {
    "CustomerKey": 1016,
    "CustomerId": "0000010160",
    "SendPaperlessBill": true,
    "Email": "
name@nowhere.com
",
    "HasCashPaymentOnlyAccounts": false
  },
  "Request": null,
  "Headers": null
}
If hasCashPaymentOnlyAccounts = true, block ACH and CC payment methods if not blocked
If hasCashPaymentOnlyAccounts = false, unblock ACH and CC payment methods if blocked
Data Pump (Account Changes, Paperless) (
AG
) 
POST [BASEURL]/tps/customer/BillingPreferences/update
{
      "CustomerAccountKey": [AccountNumber],
      "SendPaperlessBill": true or false,
      "SendPaperlessBill_OldValue": true or false,
      "PaperlessBillingEmail": email
      "PaperlessBillingEmail_OldValue": email
      "IsCashPaymentOnly": NOT NEEDED,
      "IsCashPaymentOnly_OldValue": NOT NEEDED,
      "HasActiveRecurringPayment": true or false,
      "HasActiveRecurringPayment_OldValue": true or false,
      "CreatedBy": "InvoiceCloud" (static)
}
{
  "Status": 0,
  "Message": "",
  "Field": null,
  "ErrorMessages": [],
  "WarningMessages": [],
  "SuccessMessages": [
    "Customer Successfully Updated."
  ],
  "Exceptions": [],
  "Value": {
    "CustomerInformationKey": 1016,
    "CustomerId": "0000010160",
    "SendPaperlessBill": false,
    "SendPaperlessBill_OldValue": true,
    "Email": "
name123@nowhere.com
",
    "Email_OldValue": "
name@nowhere.com
",
    "CreatedBy": null
  },
  "Request": null,
  "Headers": null
}
If paperless changes, set old_value to Old_Value and new value to ‘SendPaperlessBill’
Bill Presentment (
Agriculture
)
GET [baseurl]/tps/billing/billproduction/GetEncodedBill/{billNumber}
Bill Number should be the value without the prefix (for example 1234 not B-1234).
This is stored on the bill in 
custom2
base 64 encodedbill
File Mappings
Invoice File
File Summary/Purpose: The purpose of this file is transfer bill/invoice data to IC from the biller
File Extension:  .csv
File Naming Convention: 
File Delimiter: ',' comma separated
Specification: 
Sample File:  
SFTP File Path:
File Transfer Frequency:  As needed
Field Mapping
IC FileSpecID
IC Field
In File (Y/N)
Required (T/F)
Partner Field Name
Partner Field Format
Partner Field Description
Partner Field Character Limit
Record Type
1
RowType
N
TRUE
Set by IC, Always ‘FH’
File Header
2
BillerGuid
N
TRUE
Set by IC
File Header
3
ThirdPartyFileReference
FALSE
File Header
4
FileCreationDate
N
TRUE
Set by IC, current date
File Header
5
InvoiceCount
N
TRUE
Set by IC
File Header
6
TotalInvoiceAmount
N
TRUE
Set by IC
File Header
7
RowType
N
TRUE
Set by IC, Always ‘IH’
Invoice Header
8
RecordType
N
TRUE
Set by IC, always 'N'
Invoice Header
9
InvoiceFormatGuid
N
TRUE
Set by IC
Invoice Header
10
InvoiceNumber
Y
TRUE
ActivityID
Invoice Header
11
InvoiceDate
Y
TRUE
ActivityDate
Invoice Header
12
InvoiceDueDate
Y
TRUE
ActivityDueDate
Invoice Header
13
TotalAmountDue
Y
TRUE
ActivityAmount
Invoice Header
38
Custom1
Y
FALSE
CustomerID
Invoice Header
39
Custom2
Y
FALSE
ActivityID, without prefix (for example ‘B-’ or ‘P-’)
Invoice Header
40
Custom3
FALSE
CustomerInformationKey
Invoice Header
41
Custom4
FALSE
ActivityType
Invoice Header
42
Custom5
FALSE
Activity Description
Invoice Header
43
Custom6
FALSE
DON’T SET THIS, MAY BREAK BILL PRESENTMENT
Invoice Header
44
Custom7
FALSE
Invoice Header
45
Custom8
FALSE
Invoice Header
46
Custom9
FALSE
Invoice Header
47
Custom10
FALSE
Invoice Header
93
BalanceDue
Y
FALSE
ActivityAmountDue
Invoice Header
194
BalanceForward
N
FALSE
open billing, do not set
Invoice Header
252
InvoiceTypeID
N
FALSE
42
345
BillerInstallmentNumber
FALSE
Invoice Header
346
BillerBillYear
Y
FALSE
BillYear
Invoice Header
347
BillerInvoiceNumber
Y
FALSE
ActivityID
Invoice Header
407
PastDue
N
FALSE
(not needed for Modesto because open billing)
Invoice Header
58
RowType
N
TRUE
Set by IC , always ‘CR’
Customer Record
59
AccountNumber
Y
TRUE
CustomerID
Customer Record
60
CustomerName
Y
TRUE
Name
Customer Record
61
Address1
Y
FALSE
AddressStreet
Customer Record
62
Address2
FALSE
Customer Record
63
City
Y
FALSE
AddressCity
Customer Record
64
State
Y
FALSE
AddressState
Customer Record
65
Zip
Y
FALSE
AddressZip
Customer Record
66
Phone
Y
FALSE
Customer Record
67
EmailAddress
FALSE
Customer Record
356
BlockPaymentsCC
FALSE
Customer Record
357
BlockPaymentsEFT
FALSE
Customer Record
371
CustomerName2
FALSE
Customer Record
373
DisplayAccountNumber
FALSE
ActivityID
Customer Record
409
Active
FALSE
Customer Record
70
RowType
N
TRUE
Set by IC, Always ‘ID’
Invoice Detail
Payment/Lockbox File
File Summary/Purpose: The purpose of this file is transfer payment data from IC to the biller
File Extension: .dat
File Naming Convention:  IC_CurrentDate.dat (Current date in format yyyymmdd_hh24miss)
Example filename: IC_20220115_262430.dat
File Delimiter: '|' pipe delimited
Specification: ACH Rejects, Credits and Chargebacks not included
Sample File: 
SFTP File Path:
File Transfer Frequency: Daily
Field Mapping
Batch Header
Field
Data Type
Character Limits
Format
Values
Record Type
varchar
2
always HR
Batch Number
varchar
12
yyyymmddhh24mi
Batch Creation Date
varchar
8
yyyymmddhh24mi
Source
varchar
20
‘INVOICE CLOUD’
Payment Record
Field
Data Type
Character Limits
Format
Values
Record Type
varchar
2
always ‘PR’
Record Number
Number
5
Sequence number in file (start at 1 and iterate)
Account Number
varchar
10
Custom1(Lpadded with 0s) 
Customer Name
varchar
100
Customer Name on Account
Account Type
varchar
10
always ‘Irrigation’
Transaction DateTime
varchar
12
yyyymmddhh24mi
Payment Amount
varchar
10
amount without service fee (no commas, two decimal places) 
Payment Source
varchar
100
Payment source description
Payment Type
varchar
60
Check, CreditCard, DebitCard 
If it is possible to send DebitCard as DebitCard do so, if not send as CreditCard
Use ‘Check’ for ACH, OBD would be ACH
Reference Number
varchar
50
PaymentGUID
Trailer Record
Field
Data Type
Character Limits
Format
Values
Record Identifier
varchar
2
always ‘TR’
Record Count
Number
5
Number of records in file
Total $ in batch
Number
12
total amount paid (no commas, two decimal places)
Advanced Settings 
Setting ID
Description
Value
Is value unique per biller? (Y/N)
BIF Customization's
Feature
BIF CUSTOMIZATIONS
AchServiceFee
Not needed
AllowPartialPayments
Biller by Biller
AutoPayCollectionDate
Biller by Biller
BalanceForward
Set in BIF
CreditCardServiceFee
Not Needed
FirstNotifyRequestedDate
Biller by Biller
InvoiceDate
Not needed
InvoiceDueDate
Not needed
InvoiceFormatGuid
Biller by Biller
InvoiceTypeID
Not needed
LateFeeDate
Biller by Biller
LocationReference
Not Needed
MinimumAmountDue
Biller by Biller
PaymentExpirationDate
Biller by Biller
PaymentExpirationMessage
Biller by Biller
PromptPayExpirationDate
Biller by Biller
RegistrationValue
Not Needed
SecondNotifyRequestedDate
Biller by Biller
ThirdNotifyRequestedDate
Biller by Biller
User Interaction and Design
Data Flow - Invoice
Data Flow - Adjustments
Data Flow - Conveyance
Some billers have unique account numbers that are not reused, others may reuse account numbers in which case autoconveyance is required
Data Flow - Payment
Data Flow - Void
Data Flow - ACH Reject
Data Flow - Change Log
Data Flow - Bill Presentment
Payer Experience 
Biller Experience
User Stories
Invoice Cloud Web Services
API Name
API Use/Purpose
Integration Modifications
Jira INT
Date Released
Previous Behavior
Desired Behavior
Business Case / Solution
 URL:/spaces/IM/pages/2590113793/BID+3335+Modesto+Irrigation+District+TruePoint+Agriculture+Technical+Design