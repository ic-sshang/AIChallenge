This document explains the rationale for adding the account number to the 
Postbackurl 
in 
ICCloudPaymentsAPI
. It also details the testing procedure for this new feature and identifies the individuals involved in its development.
Worked On By:
Bruno Saenz (Assignee)
Michael Thorpe (DB Engineer) 
Heather Blood (DB Engineer)
H N Gagan (QA)
Allison Williams (Reporter)
Related Items:
EBPP-25589
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
 
EBPP-25109
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
 
EBPP-25529
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
 
EBPP-25437
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
 
EBPP-25438
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
 
EBPP-25531
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
 
At a Glance 
 
The City of Boulder (BID: 4039) was promised that, as part of their Phase 2, 
CloudPaymentsV2 
would include the account number in the postback. Additionally, InvoiceCloud’s competitors already offer this functionality, putting the company at a disadvantage. After discussions with Tony Cordova, it was decided to add a new parameter to 
ICCloudPaymentsAPI 
to support versioning. This allows us to send the account number without disrupting other billers’ integrations.
Problem
As mentioned, the City of Boulder’s promised work needed to be completed as the functionality was highly anticipated not only by Boulder but also by Al-MyMeter and Herris-AUS, creating urgency. Unfortunately, since 
ICCloudPaymentsAPI 
has been in production for a long time and many of our billers are already integrated with the current version, there were concerns that sending the account number through the postback URL could break integrations for billers who are not expecting it.
This issue was resolved by adding versioning to 
ICCloudPaymentsAPI
 through the creation of a new 
PostbackDataVersion
 parameter. When a biller specifies version 1.1 in the API request, we will send the account number; otherwise, we will not send it, maintaining compatibility with the previous behavior.
Solution
ICCloudPaymentsAPI Repository Changes
A database subtask was created to add a new column to the 
CloudPaymentRequests
 table. This column accepts a Decimal value, aligning with the 
PostbackDataVersion
 format. Additionally, the new 
PostbackDataVersion
 parameter
 was incorporated into the 
ICCloudPaymentsAPI
 repository. This update ensures compatibility for both the previous version of 
ICCloudPaymentsAPI 
(which excludes the account number added to the 
Postbackurl
) and the new version (which includes the account number). This update also includes 
validation
 for the version. Note that the 
PostbackDataVersion 
can not be used without the 
Postbackurl
 parameter filled in the request.
PostbackDataVersion
Result
1.0
Do not send account number in 
Postbackurl
1.1
Send account number in 
Postbackurl
Cloud Payment Versions
MyIIS Repository Changes 
The 
MyIIS
 changes were necessary to support the new 
PostbackDataVersion 
parameter and to include the account number in the postback upon payment completion, as 
ICCloudPaymentsAPI
 redirects the user to 
MyIIS
. To better support both versions, the 
CloudPaymentPostbackRequest 
class was refactored into 
CloudPaymentPostbackDataVersion_1_0.vb
. The 
CloudPaymentPostbackDataVersion_1_1.vb
 
class then inherits from this and adds the account number as an additional property to the postback request. A 
CloudPaymentPostbackFactory
 was also created to handle the validation of the 
PostbackDataVersion
. A database subtask was also created to update the 
selPaymentsByPaymentGuid
 stored procedure to return the customer’s 
AccountNumber
. With these changes, the user will now receive the account number in the postback. 
Please review 
pull request
 for more details.
Testing Procedures
Navigate to 
webhook.site
 . Here you will be given your own unique 
PostbackUrl
Add this URL to the 
Postbackurl
 field as well as the 
PostbackDataVersion 
field in the Cloud Payments request
You should receive a URL in the response. Navigate to it.
You will be redirected to an invoice to pay. Continue through the payment route and make the payment.
Go back to Webhook and observe the most recent post request to see if the account number was sent.
Repeat steps for all test cases
ICCloudPaymentsAPI 
PostbackDataVersion
MultiInvoice
Option 135
Postbackurl
Result
1.1
No
OFF
Valid
Generate URL
1.0
No
OFF
Valid 
Generate URL
Invalid
No
OFF
Valid
Message: “Invalid PostbackDataVersion.” 
1.0
No
OFF
Not entered
Generate URL
1.1
No
OFF
Not entered
“Invalid PostbackUrl.”
None
No
OFF
Valid
Generate URL
None
No
OFF
Empty String
“Invalid PostbackUrl.”
1.1
Yes
OFF
Valid
Generate URL
1.1
Yes
ON
Valid
Generate URL
MyIIS
 
 
 
 
 URL:/spaces/PE/pages/4016439321/EBPP-25589+PostbackURL+Account+Number+Addition