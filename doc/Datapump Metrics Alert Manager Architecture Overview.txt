Introduction
This is a console-based CRON job deployed in the Biller Kubernetes cluster. It runs every 5 minutes to provide near real-time alerts to billers when their CIS APIs—invoked by the Datapump executable (triggered by a Skybot job via the Datapump Controller)—exceed predefined performance thresholds.
The job sends alerts (Email via Mailgun API) for the key metrics such as:
Average Response Time
Error Rate Percentage
Timeout Error Rate
Thresholds for these metrics are configured in CRM for Datapump-enabled billers. When a threshold is breached, the job automatically sends alert emails to the respective billers, helping them identify and address performance issues in their APIs that may be slowing down the Datapump job.
Running the Job
The job does not require any parameters by default but supports optional parameters to control its behavior. It utilizes the 
Microsoft.Extensions.Configuration
 framework and adheres to its standard conventions. Configuration values can be provided in multiple ways, with the following order of precedence (from lowest to highest priority):
appsettings.json
 entries
Environment variables
Operational Details
Query Unprocessed Alerts
The job queries the 
[DataPumpAlert]
 table in the IC_Perflogging database to retrieve all alerts where 
IsProcessed = false
.
Process Each Alert
It iterates through the unprocessed alerts. For each alert:
The email subject and body are dynamically customized with biller-specific data and alert details.
Send Email via Mailgun API
The job sends the customized alert email using the Mailgun API.
Handle Mailgun Response
Upon receiving a successful response from Mailgun, the alert entity’s 
IsProcessed
 flag is set to 
true
.
Bulk Update Processed Alerts
Once all alerts are processed, the job uses Entity Framework’s 
UpdateRange()
 method to update all modified entities in bulk for efficient database write operations.
Process Diagram
2
1
0
0
4351819777
4351033425
1
Untitled Diagram-1748339150817.drawio
1
1
https://invoicecloud.atlassian.net/wiki
Untitled Diagram-1748339150817.drawio
0
581
891
 URL:/spaces/ED/pages/4351033425/Datapump+Metrics+Alert+Manager+Architecture+Overview