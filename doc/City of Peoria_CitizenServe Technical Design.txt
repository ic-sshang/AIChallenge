This integration is being implemented for BID 2249 - City of Peoria AZ. For any additional implementations to use this functionality, the mapping should be reviewed by the Invoice Cloud Solutions Engineering team to ensure compatibility.
Page Navigation
Jira ticket 
Release Date
Document status
in progress
Yellow
Document owner
 
Solution engineer
 
 
Salesforce SOW
N/A
Knowledge Transfer
N/A
API Documentation
Summary: Cloud Invoicing- Invoice Cloud will reach out to CitizenServ API to generate an invoice on the fly based on information the payer enters in the IC Virtual Site.
Test Endpoint: 
https://test.citizenserve.com/Portal/PortalController?Action=getQuery&portalPageDisplay=true&report_ID=641&installationID=24&ctzPagePrefix=Portal_&ParamCount=1&Param_1=PBL19-010007
Prod Endpoint: 
https://www.citizenserve.com/Portal/PortalController?Action=getQuery&portalPageDisplay=true&report_ID=641&installationID=24&ctzPagePrefix=Portal_&ParamCount=1&Param_1=PBL19-010007
Parameter
Type
Value
Notes
Action
String
getQuery
Default
portalPageDisplay
Boolean
true
Default
report_ID
Int
Unique identifier for the report
Will be provided by Citizenserve
installationID
Int
24
Default
ctzPagePrefix
String
Portal_
Default
ParamCount
Int
1
Default
Param_1
String
License Number
 
Details
IC Use
Partner API Name
Description
Request
Response
Specifications
RTDR: Invoice Generation/Balance Update
URL: 
https://test.citizenserve.com/Portal/PortalController?Action=getQuery&portalPageDisplay=true&report_ID=641&installationID=24&ctzPagePrefix=Portal_&ParamCount=1&Param_1=
PBL19-010007
 
Action: GetQuery
portal Page Display: True
Report ID: 641
Installation ID: 24 (Varies per biller)
ctsPagePrefix: Portal
ParamCount: 1
Param_1: License Number (Invoice Number)
[
 {
  "licensenumber" : "PBL19-010007",
  "customerzip" : "85345",
  "accountstatement" : "http://test.citizenserve.com/Documents/24/400417501_Account%20Statement%20Letter.htm ",
  "totalamountdue" : 70,
  "balancedue" : 25,
  "customerstate" : "AZ",
  "customeraddress" : "JOSE SALAZAR 10539 W ALICE Avenue ",
  "customercity" : "PEORIA",
  "description" : "ROCKY POINT SHRIMP",
  "businessaddress" : "10539 W ALICE Avenue  ",
  "customername" : "JOSE L SALAZAR"
} ]
The API is using for generating a new invoice if it does not exist and balance update.
Data Pump: Payment
Add License Payment 
 
https://test.citizenserve.com/citizenws/service/addlicensepayment
REST API- POST
API Key: LKcdKaRNMaYsV6ngQyVBknAWbeyJSu4j
Note: The test environment refreshes about once a month. CitizenServe must to set this back up to make test environment working. Please reach out CitizenServe if endpoint or API key fails.
Sample POST:
 
Method: POST
Headers:
apikey: LKcdKaRNMaYsV6ngQyVBknAWbeyJSu4j
Cache-Control: no-cache
Content-Type: text/plain
 
Body:
{
  "installationID": 24,
  "licenseNumber": "PBL19-010026",
  "paymentAmount": "240.83",
  "paymentDate": "02/12/2022",
  "paymentType": "Credit",
  "paymentReference": "1234123",
  "paymentNote": "Transaction ID: 12412. Paid with VISA.",
  "receivedFrom": "John Smith"
}
Response:
{
    "Status": "Success",
    "Description": "Successfully added payment. Receipt #11863"
}
InstallationID- 24
License Number: Account Number
Payment Amount: Payment Amount
Payment Date: Payment Date MM/DD/YYYY
Payment Type: Credit, ACH
Payment Reference: 
Approval Code
Payment Note: Payment  GUID
Received From: Payor Name
File Mapping
Invoice File
Data Summary/Purpose: Allow a payer, to be able to make payments on invoices that do not yet exist on IC but do on a partner system. The partner will not send us files or integrate with IC, but IC can pull the payer information from an API they have.
Data Transfer: When the payer inputs data in the IC Cloud Store form, IC will retrieve invoice data from an API (see above) to create invoice records.
Field Mapping
IC FileSpecID
IC Field
In File (Y/N)
Required (T/F)
Partner Field Name
Partner Field Format
Record Type
1
RowType
N
TRUE
N/A- Generated by IC
File Header
2
BillerGuid
N
TRUE
N/A- Generated by IC
File Header
4
FileCreationDate
N
TRUE
N/A- Generated by IC
File Header
5
InvoiceCount
N
TRUE
N/A- Generated by IC
File Header
6
TotalInvoiceAmount
N
TRUE
N/A- Generated by IC
File Header
7
RowType
N
TRUE
N/A- Generated by IC
Invoice Header
8
RecordType
N
TRUE
N/A- Generated by IC
Invoice Header
9
InvoiceFormatGuid
N
TRUE
N/A
- Generated by IC
Invoice Header
10
InvoiceNumber
Y
TRUE
License Number
Numeric
Invoice Header
11
InvoiceDate
Y
TRUE
N/A- Generated by IC- Use Today’s Date
Date/Time
Invoice Header
12
InvoiceDueDate
Y
TRUE
N/A- Generated by IC- 
Use Today’s Date
Date/Time
Invoice Header
13
TotalAmountDue
Y
TRUE
Total Amount Due
Currency
Invoice Header
38
Custom1
Y
FALSE
Installation ID
Text
Invoice Header
39
Custom2
Y
FALSE
Business Address
Text
Invoice Header
40
Custom3
Y
FALSE
Text
Invoice Header
41
Custom4
Y
FALSE
Invoice Header
93
BalanceDue
Y
FALSE
Balance Due
Currency
Invoice Header
252
InvoiceTypeID
N
TRUE
N/A- IC To Generate- Will Vary
Invoice Header
58
RowType
N
TRUE
N/A- IC To Generate- Always CR
Customer Record
59
AccountNumber
Y
TRUE
License Number
Alpha Numeric
Customer Record
60
CustomerName
Y
TRUE
Owner
Customer Record
61
Address1
Y
FALSE
Customer Address
Text
Customer Record
63
City
Y
FALSE
Alpha
Customer Record
64
State
Y
FALSE
Alpha
Customer Record
65
Zip
Y
FALSE
Numeric
Customer Record
70
RowType
N
TRUE
N/A- IC To Generate- Always ID
Invoice Detail
Advanced Settings
Setting ID
Description
Value
Is value unique per biller? (Y/N)
8
RTDR EndPoint/WebService URL
{
Biller Provided URL
}
Y
10
RTDR Key or Password if Applicable
{
Biller Provided Password
}
Y
11
DataPump Payments EndPoint/WebService URL
{
Biller Provided URL
}
Y
13
DataPump Payments EndPoint/WebService Password
{
Biller Provided Password
}
Y
16
DataPump Paperless EndPoint/WebService Password
{
Biller Provided Password
}
Y
17
DataPump AutoPay EndPoint/WebService URL
{
Biller Provided URL
}
Y
19
DataPump AutoPay EndPoint/WebService Password
{
Biller Provided Password
}
Y
30
Accela InvoiceNumber Prefix
ACCELA-
Y
64
DataPump Payments CC Code
Web CC|IVR CC|AutopayCC
Y
65
DataPump Payments ACH Code
Web Eck|IVR Eck|AutopayEck
Y
111
Secondary DP Paperless EndPoint URL
{
Biller Provided URL
}
Y
112
Secondary DP Paperless EndPoint Username
{
Biller Provided Username
}
Y
113
Secondary DP Paperless EndPoint Password
{
Biller Provided Password
}
Y
131
JASON Configuration
{"InvoiceOnDemand":{"Integration":"CitizenServe"}}
Y
BIF Customization's
N/A - no BIF customizations need to be set for Cloudstore invoices
User Interaction and Design
Data Flow - Invoice
att2530902026
1
2361655297
CitizenServ Invoice Generation
IM
att2530902020
att2530934787
0
Data Flow - Adjustments
att2531262480
1
2361655297
CitizenServ Adjustments
IM
att2531819523
att2531885057
0
Data Flow - Payment
Payer Experience
Payers will access Invoice Cloud from the Biller website (URL redirect). Payers will use the IC Virtual Site.
Biller Experience
Biller will use the Biller Portal to review payment history.
Invoice Cloud Web Services
API Name
API Use/Purpose
n/a
n/a
Integration Modifications
Jira INT
Date Released
Previous Behavior
Desired Behavior
Business Case / Solution
ITG-3323
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
 
TBD
RTDR does not refresh balance.
RTDR should support balance update. 
RTDR currently only support invoice generation, we need modify the RTDR to support refresh balance.  
 URL:/spaces/IM/pages/2361655297/City+of+Peoria+CitizenServe+Technical+Design