1
6
false
default
list
true
Deployment Date
4/28/2024 @ 5 AM Eastern
Status
Deployed, Tested and Verified
Summary
This change will enable accessing the DevTest VMs from a Public Network and DNS path but will have Firewall Rules in place to limit access to the DevTest VMs based on known IP Address using a WAF Firewall Rule in Cloudflare.  Note Devtest8 (
cert
) and DevTest 14 (
devtest
) will remain publicly available.  This changes will make the following changes:
 GoDaddy DNS records for DNS resolution
Cloudflare DNS records for WAF Proxying
Palo Alto NonProd Firewall instance will forward all Inbound Traffic to NonProd Kong
Kong Routes for DevTest VMs
Change NonProd 
invoicecloud.com
 Private DNS Zone resolution for DevTest VM URLs, routing the traffic thru Cloudflare, Palo Alto, and Kong instead of directly routing to the VM IP Address
Steps for Deployment
Remove following records from 
invoicecloud.com
 GoDaddy and Cloudflare. 
 or 
 
cert
icg-boarding-cert
icg-payments-cert
icg-reporting-cert
my-cert
devtest
my-devtest
Run the 
Kong_Infrastructure deployment pipeline
 using this 
branch
. 
 
This will deploy the first 53 Public DNS records to Cloudflare and GoDaddy so we do not go over GoDaddy limit of 60 calls per minute.
Also deploys NonProd Palo A Record to Cloudflare 
npd.invoicecloud.com
Also deploys Firewall Rule to Cloudflare for 
invoicecloud.com
 that will block traffic for hostnames that are not allowed public access (public access for DevTest 14 and 8 which are 
devtest
 and 
cert
 respectively).
Update the 
branch 
to deploy the remainder of DevTest VM Public DNS Records to Cloudflare and GoDaddy. 
 
This will deploy the remaining Public DNS records to Cloudflare and GoDaddy so we do not go over GoDaddy limit of 60 calls per minute.
Also updates the Firewall Rule to Cloudflare for 
invoicecloud.com
 adding the rest of the hostnames to the rule that are not allowed full public access.
Run the 
Hub_Infrastructure deployment pipeline
 using this 
branch
. 
 
Will update the NonProd 
invoicecloud.com
 Private DNS Zone changing DevTest hostnames from 
A
 records straight to the VM IP to 
CNAME
 records that will route the traffic thru Cloudflare and the full Network Ingress stack which will improve Networking Configuration testing in an effort to reduce Network Configuration issues making it to the Production Network.
Tests Cases
Test connectivity from NonProd AVD. 
 
tests-devtest-vms-from-invoicecloud-laptop-and-avd.js - Repos (azure.com)
Test Expectations
Can access
devtest
cert
devtest1
devtest2
devtest3
devtest4
devtest5
devtest6
devtest8
devtest9
devtest10
devtest11
devtest12
devtest13
devtest14
Test connectivity from Prod AVD. 
 
Test Expectations
Can access
devtest
cert
Cannot access
devtest1
devtest2
devtest3
devtest4
devtest5
devtest6
devtest8
devtest9
devtest10
devtest11
devtest12
devtest13
devtest14
Test connectivity from Term Server (thru host file on Term Servers). 
 
Test Expectations
Can access
devtest
cert
devtest1
devtest2
devtest3
devtest4
devtest5
devtest6
devtest8
devtest9
devtest10
devtest11
devtest12
devtest13
devtest14
Test connectivity from InvoiceCloud Laptop. 
 
tests-devtest-vms-from-invoicecloud-laptop-and-avd.js - Repos (azure.com)
Test Expectations
Can access
devtest
cert
devtest1
devtest2
devtest3
devtest4
devtest5
devtest6
devtest8
devtest9
devtest10
devtest11
devtest12
devtest13
devtest14
Test Connectivity from Personal Laptop. 
 
Test Expectations
Cannot access
devtest
cert
devtest1
devtest2
devtest3
devtest4
devtest5
devtest6
devtest8
devtest9
devtest10
devtest11
devtest12
devtest13
devtest14
Test Connectivity from Azure Load Test. 
 
functional - Repos (azure.com)
Test Expectations
Behind NAT can access
devtest
cert
devtest1
devtest2
devtest3
devtest4
devtest5
devtest6
devtest8
devtest9
devtest10
devtest11
devtest12
devtest13
devtest14
Not behind NAT can access
devtest
cert
devtest8
devtest14
Not behind NAT cannot access
devtest1
devtest2
devtest3
devtest4
devtest5
devtest6
devtest9
devtest10
devtest11
devtest12
devtest13
Regression Test Suite for all Applications. 
 
Regression tests for 
https://devtest.invoicecloud.com
Regression tests for 
https://cert.invoicecloud.com
Regression tests for 
https://www.invoicecloud.com
Test Connectivity from PSN. 
 
Test 
https://cert.invoicecloud.com
 connectivity
 URL:/spaces/platform/pages/3196321866/Kong+DV2+-+NonProd+Deployment