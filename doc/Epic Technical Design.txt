Fill in project details in the table below. Type /date to quickly add the target release date, /jira to link to Jira epics or issues, and @mention functional owners to keep everyone on the same page.
Page Navigation
Jira ticket 
ITR
14642
Release Date
Document status
DRAFT
Document owner
 
Solution engineer
Salesforce SOW
Knowledge Transfer
API Documentation
Unique Biller Integration Values (will be provided on the Integration Coding Form):
TEST: 
https://c1sdkuat.teamfocusins.com/ETM/C1/
…
PROD: 
https://c1sdkprod.teamfocusins.com/etm/c1/
…
API Authentication Method: Basic 
UserName: InvoiceCloud
Password: InvCld$C1
IC Use
Partner API Name
Description
Request
Response
Specifications
RTDR: Balance Update
upx_InvoiceCloud_GetInvoiceBalance
Used to pull Balance Information from TeamFocus
GET:
https://c1sdkuat.teamfocusins.com/ETM/C1
/dbquery/upx_InvoiceCloud_GetInvoiceBalance?cr.@invoice_id_in=
{InvoiceNumber}
xml
<?xml version="1.0"?><ConceptOneReply Process_Status="PRC" Process_Message="Request successfully processed." Reply_Code="1" Process_Date="2021-10-27T04:16:20-00:00" SDK_Version="11.0.10.0"><DBQueryProcess Procedure_Name="upx_InvoiceCloud_GetInvoiceBalance" Process_Status="PRC" Process_Message="Query successfully processed."><Criteria><Parameter Name="@invoice_id_in">8106105</Parameter></Criteria><Result><InvoiceBalance><BalanceDue>323.00</BalanceDue><VoidStatus>N</VoidStatus></InvoiceBalance></Result></DBQueryProcess></ConceptOneReply>
Update balance to the value in node 
<BalanceDue>
.
RTDR: Block Payment Methods
upx_InvoiceCloud_GetInvoiceBalance
Used to block payment methods on IC.
After the balance update check 
ConceptOneReply/DBQueryProcess/Result/InvoiceBalance/Status
to see if the value is V or D. If so, then set exp date to 
01/01/2021
and set the exp message to 
Invoice has been Voided/Deleted.
Otherwise, unexpire the invoice.
Data Pump: Payment
ConceptOneRequestReceiptProcess
ConceptOneRequestReceiptProcessReceipt
Post a payment on the Invoice, which requires the payment to be in full
            'to confirm this, the TotalAmountDue, BalanceDue, and payment amount must be equal.  If not, 
            'an "On_Account" receipt needs to be made.  This will also require Reconciliation information.
ConceptOneRequestReceiptProcess:
.Book_Entity_ID = BookEntityID, (Second part From DP Username Adv. Setting)
                .Book_Loc_ID = BookLocID, (Third part From DP Username Adv. Setting)
                .Event = "Create;Post",
                .Process_Status = "",
                .Process_Message = "",
                .WF_User_ID = "",
                .WF_Object_Code = "",
                .Task_ID = "",
                .Keep_Project_Open = "N",
                .Keep_Task_Open = "N"
ConceptOneRequestReceiptProcessReceipt:
.Amount = ICPaymentAmount,
.Tran_Date = ICPaymentDate,
.AutoRecon_Object = New ConceptOneRequestReceiptProcessReceiptAutoRecon_Object() With
  {
    .Object_Code = "Invoice", (values are "Invoice" or "On Account")
    .Object_ID = ICInvoiceNumber (InvoiceNumber of the invoice being paid or blank if @Object_Code is On Account.)
  },
  .Memo = CustomerAccountNumber (From the paymentRecord),
  .Payment_Method = "INCLD", (Hardcoded value for Team Focus indicating payment came from Invoice Cloud.)
  .Entity_Ledger = New ConceptOneRequestReceiptProcessReceiptEntity_Ledger() With
  {
    .Ledger_Entry = New ConceptOneRequestReceiptProcessReceiptEntity_LedgerLedger_Entry() With
    {
      .Ledger_Entity = New ConceptOneRequestReceiptProcessReceiptEntity_LedgerLedger_EntryLedger_Entity(),
      .Ledger_Class = "R" (R hardcoded for Receivable)
    }
}
ConceptOneRequestReceiptProcess.Payor_Check_Num = ICPaymentGUID
ConceptOneRequestReceiptProcess.Receipt = ConceptOneRequestReceiptProcessReceipt
ConceptOneRequest = ConceptOneRequestReceiptProcess
Before we make the receipt request: 
First check if the payment amount is for the entire balance due. If not, then:
Run an RTDR balance check to get the 
ConceptOneReply/DBQueryProcess/Result/InvoiceBalance/Status
result and the 
ConceptOneReply/DBQueryProcess/Result/InvoiceBalance/ClosedPeriod
If the status is S or A and the closePeriod is Y then return true and set the Memo field to ICCustom2 and then set members of the request object to the following:
ConceptOneRequest.ReceiptProcess.Receipt.AutoRecon_Object.Object_Code = "On Account"
ConceptOneRequest.ReceiptProcess.Receipt.AutoRecon_Object.Object_ID = "" 'Invoice_ID of the invoice being paid or blank if @Object_Code is On Account.
ConceptOneRequest.ReceiptProcess.Receipt.Consumer = New ConceptOneRequestReceiptProcessReceiptConsumer() With
{
  .Entity_ID = ICCustom6,
  .SSN_or_FEIN = ""
}
ConceptOneRequest.ReceiptProcess.Receipt.Received_From = New ConceptOneRequestReceiptProcessReceiptReceived_From() With 'Required if AutoRecon_Object @Object_Code is On Account.
{
  .Role_Type = ICCustom5,
  .Entity_ID = ICCustom1}
ConceptOneRequest.ReceiptProcess.Receipt.Deposit_Account = DepositAccount 'this will need to be a value provided by Epic/Focus, GL Account Number for the Bank Account or it will default to Bk-TR Account
ConceptOneRequest.ReceiptProcess.Receipt.On_Account = New ConceptOneRequestReceiptProcessReceiptOn_Account() With 'Required if AutoRecon_Object @Object_Code is On Account.
{
  .Role_Type = ICCustom5, 'Valid values are: BK, CN, EM, PR, SP, TA, TP.
  .Entity_ID = ICCustom1}
Save ReceiptID to the BillerReponseData for the datapump.
…
Include Credits & Chargebacks?
Credits?
Yes/No
Chargebacks?
Yes/No
Sent a Negative value, using dash indicator?
Yes/No
Alt. credit indicatator :
Data Transmission: Invoice Data
upx_InvoiceCloud_GetInvoice
Used to pull invoice data from TeamFocus
GET:
	https://c1sdkprod.teamfocusins.com/ETM/C1/dbquery/upx_InvoiceCloud_GetInvoice?cr.@book_entity_id_in=2610102&cr.@BeginDate_in={0}&cr.@EndDate_in={1}
XML
Set the beginDate param to Today.AddDays(-1) and EndDate to Today.
File Mapping
Invoice File
File Summary/Purpose: The purpose of this file is transfer bill/invoice data to IC from the biller.
File Extension: TXT
File Delimiter: NA
Specification: XML, Main tag is 
<Invoice>
.
Sample File: 
Invoice File Transmission: Epic will require IC to pull the file from their API. A process called BillerAPIDataImport will run once a day at 7 am CST and use the following credentials to pull the file and run the file through StratusWebServices to be converted to a BIF and then imported to IC.
File Transfer Frequency: Once a day
IC FileSpecID
IC Field
In File (Y/N)
Required (T/F)
Partner Field Name
Notes
Record Type
1
RowType
NA
TRUE
NA
File Header
2
BillerGuid
NA
TRUE
NA
File Header
3
ThirdPartyFileReference
NA
FALSE
NA
File Header
4
FileCreationDate
NA
TRUE
NA
File Header
5
InvoiceCount
NA
TRUE
NA
File Header
6
TotalInvoiceAmount
NA
TRUE
NA
File Header
7
RowType
NA
TRUE
NA
Always IH
Invoice Header
8
RecordType
NA
TRUE
<Voiding>
Always N unless 
<Voiding
> is set to 
Y
 or 
V
, then D.
Invoice Header
9
InvoiceFormatGuid
NA
TRUE
NA
Epic PDF Viewer 
5E3327D7-6DED-4CB4-A26E-2C8668F25379
 (To be set via BIF Customization)
Invoice Header
10
InvoiceNumber
TRUE
<InvoiceNumber>
Invoice Header
11
InvoiceDate
TRUE
<InvoiceDate>
Invoice Header
12
InvoiceDueDate
TRUE
<InvoiceDueDate>
Invoice Header
13
TotalAmountDue
TRUE
<TotalAmountDue>
Invoice Header
20
AllowPartialPayments
FALSE
<AllowPartialPayments>
Also set to Yes via BIF customizations.
Invoice Header
23
FirstNotifyRequestedDate
FALSE
NA
Set via BIF customizations.
Invoice Header
24
SecondNotifyRequestedDate
FALSE
NA
Set via BIF customizations.
Invoice Header
25
ThirdNotifyRequestedDate
FALSE
NA
Set via BIF customizations.
Invoice Header
38
Custom1
FALSE
<ReceivableID>
Invoice Header
39
Custom2
FALSE
<ContractID>
Invoice Header
40
Custom3
FALSE
<Voiding>
Invoice Header
41
Custom4
FALSE
<DocumentID>
Invoice Header
42
Custom5
FALSE
<ReceivableRole>
Invoice Header
43
Custom6
FALSE
<CustomerEntityID>
Invoice Header
44
Custom7
FALSE
<EmailAddressBK>
Invoice Header
45
Custom8
FALSE
<EmailAddressBKAffiliate>
Invoice Header
93
BalanceDue
FALSE
<BalanceDue>
If empty, set to 
0.0
.
Invoice Header
194
BalanceForward
FALSE
NA
Set via BIF customizations: No
Invoice Header
248
AutoPayCollectionDate
FALSE
NA
Set via BIF customizations.
Invoice Header
252
InvoiceTypeID
TRUE
NA
Set to Insurance Type 1
Invoice Header
345
BillerInstallmentNumber
FALSE
<InstallmentNumber>
Invoice Header
346
BillerBillYear
FALSE
<BillYear>
Invoice Header
347
BillerInvoiceNumber
FALSE
<BillNumber>
Invoice Header
375
Active
FALSE
NA
Always 1
Invoice Header
407
PastDue
FALSE
NA
NA
Invoice Header
58
RowType
TRUE
NA
Always CR
Customer Record
59
AccountNumber
TRUE
<PolicyNumber>
Customer Record
60
CustomerName
TRUE
<CustomerName>
Customer Record
61
Address1
FALSE
<Address1>
Customer Record
62
Address2
FALSE
<Address2>
Customer Record
63
City
FALSE
<City>
Customer Record
64
State
FALSE
<State>
Customer Record
65
Zip
FALSE
<Zip>
Customer Record
66
Phone
FALSE
<Phone>
Customer Record
67
EmailAddress
FALSE
If 
<ReceivableRole>
=BK then use 
<EmailAddressBK>
, otherwise use 
<EmailAddress>
.
Customer Record
356
BlockPaymentsCC
FALSE
<BlockCreditCard>
Customer Record
357
BlockPaymentsEFT
FALSE
<BlockACH>
Customer Record
373
DisplayAccountNumber
FALSE
<PolicyNumber>
Customer Record
409
Active
FALSE
<PolicyNumber>
Customer Record
70
RowType
TRUE
Always ID
Invoice Detail
Advanced Settings
Setting
Description
Value
8
RTDR Endpoint
https://c1sdkprod.teamfocusins.com/ETM/C1/dbquery/upx_InvoiceCloud_GetInvoiceBalance|https://c1sdkprod.teamfocusins.com/ETM/C1/dbquery/upx_invoiceCloud_PostInvoice
9
RTDR UserName
InvoiceCloud
10
RTDR Password
Pr0d!nCetM
11
DP Payments URL
https://c1sdkprod.teamfocusins.com/etm/c1/accounting/receipt
12
DP Payments Username
InvoiceCloud
13
DP Payments Password
Pr0d!nCetM
20
Remote PDF Endpoint
https://c1sdkprod.teamfocusins.com/etm/c1/document/{0}.pdf
21
Remote PDF Username
InvoiceCloud
22
Remote PDF Password
Pr0d!nCetM
88
Invoice Data Import Endpoint
https://c1sdkprod.teamfocusins.com/ETM/C1/dbquery/upx_InvoiceCloud_GetInvoice?cr.@book_entity_id_in=2610102&cr.@BeginDate_in={0}&cr.@EndDate_in={1}
89
Invoice Data Import Username
InvoiceCloud
90
Invoice Data Import Password
Pr0d!nCetM
101
DP ACH Rejects URL
https://c1sdkprod.teamfocusins.com/etm/c1/accounting/journalentry
102
DP ACH Rejects Username
InvoiceCloud
103
DP ACH Rejects Password
Pr0d!nCetM
BIF Customization's
Feature
BIF CUSTOMIZATIONS
AllowPartialPayments
No
AutoPayCollectionDate
Invoice due date
BalanceForward
No (because insurance)
FirstNotifyRequestedDate
Upload Date Plus 2 Day(s)
 (TODAY|2)
InvoiceFormatGuid
EPIC - PDF Viewer
 (5E3327D7-6DED-4CB4-A26E-2C8668F25379)
PaymentExpirationDate
Invoice Due Date Plus 27 Day(s)
 (12|27)
PaymentExpirationMessage
This policy has been cancelled for non-payment. We cannot accept a past due payment. For questions call (800) 432-3072 and select option 1.
SecondNotifyRequestedDate
Invoice Due Date
 (12|0)
ThirdNotifyRequestedDate
Invoice Due Date Plus 5 Day(s)
 (12|5)
User Interaction and Design
Data Flow - Invoice
Data Flow - Adjustments
Data Flow - Payment
Data Flow - Void
Data Flow - ACH Reject
Data Flow - Change Log
Data Flow - Bill Presentment
Payer Experience
Payers will access Invoice Cloud from the Biller website (URL redirect). Payers will use the IC Virtual Site and Customer Portal.
Biller Experience
User Stories
Invoice Cloud Web Services
API Name
API Use/Purpose
Integration Modifications
Jira INT
Date Released
Previous Behavior
Desired Behavior
Business Case / Solution
 URL:/spaces/IM/pages/2049933598/Epic+Technical+Design