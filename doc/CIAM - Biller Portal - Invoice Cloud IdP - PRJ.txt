We are transitioning from the application's dedicated login functionality to a centralized Customer Identity and Access Management (CIAM) solution (SecureAuth), which will serve as the Identity Provider (IdP). This strategic shift aims to modernize our authentication architecture by decoupling identity-related logic from the application itself.
CRM Biller / Organization Onboarding 
2
1
0
0
4497506599
4497637420
1
Untitled Diagram-1752596699029.drawio
2
2
https://invoicecloud.atlassian.net/wiki
Untitled Diagram-1752596699029.drawio
0
501
301
CRM User Management
2
1
0
0
4498129140
4497637420
1
Untitled Diagram-1752597052034.drawio
3
3
https://invoicecloud.atlassian.net/wiki
Untitled Diagram-1752597052034.drawio
0
501
301
Biller Portal User Management
2
0
1
0
4497637420
4671930435
Untitled Diagram-1758313319956.drawio
1
2
2
https://invoicecloud.atlassian.net/wiki
Untitled Diagram-1758313319956.drawio
0
501
301
Login Flow
2
1
0
0
4498128938
4497637420
1
Untitled Diagram-1752582669679.drawio
3
3
https://invoicecloud.atlassian.net/wiki
Untitled Diagram-1752582669679.drawio
0
421
1071
1. User Accesses Biller Portal
The user navigates to Biller Portal with Biller context.  Biller GUID as a query string parameter or some other URI component. (e.g., 
www.invoicecloud.com/portal/login.aspx?bg=adf89298oasd982udja92n
).  
The Biller Portal detects the user is not authenticated.
The Biller Portal looks up the biller authentication settings using the Biller GUID
If the biller is set up to use SecureAuth go to step 2
Else redirect to the existing login flow
2. 
Redirect to SecureAuth (CIAM)
The Biller Portal redirects the user to SecureAuthâ€™s 
OIDC
 authorization endpoint.
Example: 
https://secureauth.example.com/oauth2/authorize?...
3. 
User Authenticates with SecureAuth
SecureAuth presents a login screen.
The user enters credentials (username/password, MFA, etc.).
SecureAuth validates the credentials against its 
identity pool
.
4. 
SecureAuth Issues Tokens
Upon successful authentication, SecureAuth:
Issues an code 
ID token
 (user identity)
Issues an 
access token
 (API access)
Optionally issues a 
refresh token
 (for session continuation)
5. 
User Redirected Back to Biller Portal
SecureAuth redirects the user back to the Biller Portal with the code.
The Biller Portal exchange the code for a ID token.
The Biller Portal validates the token and reads the claims (identity identifier, organization identifier / biller ) 
6. 
Session Established
The Biller Portal maps the identity identifier to a user record and role
Creates a session
The user is now authenticated and can access Biller Portal resources.
Constraint: Unique Email Requirement for Password Reset
Context:
In organizations where our platform serves as the Identity Provider (IdP), users must be able to reset their passwords via email.
Constraint:
For each organization where we are the IdP, 
email addresses must be unique within that organization's identity pool
.
Rationale:
Password reset workflows rely on email as the primary communication channel. If multiple user accounts share the same email address within an organization, it would be impossible to securely and accurately deliver password reset instructions to the correct user.
Implications:
During user registration or import, the system must enforce email uniqueness within the organization.
Admins attempting to create or update users must be notified of email conflicts.
Email uniqueness is scoped 
per organization
, not globally across all tenants.
 URL:/spaces/EA/pages/4497637420/CIAM+-+Biller+Portal+-+Invoice+Cloud+IdP+-+PRJ