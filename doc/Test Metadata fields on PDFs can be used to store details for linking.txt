The proposed approach to maintain the extraction fields for the new extraction process is to save the extraction fields within the PDFs metadata. We need to test the persistence of PDF metadata to ensure it can be used to store information as the PDFs are moved from one process to another.
Testing Criteria:
Verify that PDF metadata can be read from existing files.
Confirm that metadata can be written to PDF files.
Ensure that metadata persists when PDFs are moved between processes.
Test the persistence of metadata when PDFs are saved to Azure Blob Storage.
Validate that metadata remains intact when PDFs are pulled from Azure Blob Storage.
Test Environment:
Storage Azurite Emulator
: Used to emulate queue triggers, streaming a pdf from a blob container, uploading the pdf back to the blob container, moving a pdf from one blob container to another
BitMiracle Library
: Used to view/insert metadata into the pdf
Verify that PDF metadata can be read from existing files
Process:
Streamed pdf into a memory stream
Used 
BitMiracle library
 to convert the Bytes into a 
PdfDocument
 object
Successfully viewed the Pdf’s metadata
Viewing the pdf’s metadata
Confirm that metadata can be written to PDF files
Process:
Streamed pdf into a memory stream
Used 
BitMiracle library
 to convert the Bytes into a 
PdfDocument
 object
Use 
BitMiracle
 
XmpSchema
 class to insert new custom properties to the Pdf
Successfully able to retrieve/view the custom properties
Custom properties written to pdf
Note:
The custom properties are added to the Pdf as 
Xmp
 (XML file embedded in a PDF) which is not viewable in the properties tab of the metadata when viewing through the 
Properties
 option in file explorer or Adobe Acrobat’s 
Document Properties
, to view this information you can choose the 
edit with Notepad++
 option in the file explorer
Viewing custom properties in Notepad++
Ensure that metadata persists when PDFs are moved between processes / Test the persistence of metadata when PDFs are saved to Azure Blob Storage / Validate that metadata remains intact when PDFs are pulled from Azure Blob Storage
Process:
Streamed pdf into a memory stream
Used 
BitMiracle library
 to convert the Bytes into a 
PdfDocument
 object
Use 
BitMiracle
 
XmpSchema
 class to insert new custom properties to the Pdf
Convert the 
PdfDocument
 object into a 
MemoryStream
 to copy to a 
FileInfo
 object
Use the 
BlobClient
 to upload the pdf
Move the pdf from its current blob container to another blob container
Successfully able to retrieve/view the custom properties
Custom properties persisted after pdf was moved to pdf-filename blob container
Errors
Possible errors encountered:
Attempting to add the name of an existing property will throw an error
 URL:/spaces/IM/pages/4095934488/Test+Metadata+fields+on+PDFs+can+be+used+to+store+details+for+linking