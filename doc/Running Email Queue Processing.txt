This document will detail the steps for running the EmailQueueProcessing repository. 
*Testing works in TermServer-2 and fails in all Bastion Servers
You will need the email queue type ID you are using.
You will need to inserted an email into the email queue table or modify an invoice to match the conditions to run, See what Query is being used in GetEmailQueueItemsSql() to verify
This will run using the DevTest Environment, this will not effect production. 
ic-dbtest-east-server1.database.windows.net
Clone the EmailQueueProcessing repository and ensure your on the branch in question
Go to the EmailQueueProcessing project-> Properties 
Go to Debug-> in Command line argument put the email queue type ID you’re working with
SELECT * FROM tblEmailQueueType ORDER BY 1 ASC
Additional Note: If testing Invoice First Notification it will be expecting 1 [1-9]
See 
Module1.vb 
StartProcessingEmails() for how the arguments above are taken and used
Go to the EmailQueue folder in Solution Explorer and select the queue you want to run. (using consolidated Receipt Queue as an example)
Go to the GetEmailQueueItemsSql() function of your queue and specify the BID
Go to the constructor and set AvailabeForAzureBatch to false
  Public Sub New()
      Me.AvailableForAzureBatch = FALSE
  End Sub
Go to the Nuget package manager -> Installed -> Search database -> click on IC.Database -> Change version to 1.0.7947.27924
Ensure that the Package Source is set to all, and search the Version Type to 1.0.7947.27924 and install it it will overwrite the current version
Go to the file 
DatabaseHandlerV2.vb
 and replace the code with the code at the end of this page in the code block
Go to EmailQueueProcessing’s 
app.config 
and replace the value of RunAsyncThreadCount to 1
Go to 
EmailQueue.vb 
-> ProcessRow-> insert the email address you want to test with
item.EmailAddressCC = "YOUR_EMAIL@invoicecloud.com"
Run
vbnet
'DatabaseHandlerV2 code

Imports IC.Database
Imports IC.Database.Databases
Imports IC.Database.Factories

Public Class DatabaseHandlerV2
    Implements IEmailQueueDatabase

    Private Shared _masterDb As DatabaseProxy = Nothing
    Private Shared ApplicationName As String = "IC.EmailQueue"
    Public Sub New()
        _masterDb = New DatabaseProxy()
    End Sub
    
    Private Shared Function CallDB(Of TResult)(BillerID As Integer, MethodCall As Func(Of DatabaseBase, TResult)) As TResult
        Return _masterDb.CallService(BillerID, String.Empty, MethodCall)
    End Function

    Public Function EXECUTE_COMMAND_NONQUERY(sql As String, billerid As Integer) As Integer Implements IEmailQueueDatabase.EXECUTE_COMMAND_NONQUERY
        Return CallDB(Of Integer)(billerid, Function(client) client.EXECUTE_COMMAND_NONQUERY(DatabaseBase.DatabaseName.DBDynamic, sql, 300))
    End Function

    Public Function EXECUTE_COMMAND_NONQUERY(databaseName As String, sql As String, billerid As Integer) As Integer Implements IEmailQueueDatabase.EXECUTE_COMMAND_NONQUERY
        Return CallDB(billerid, Function(c) c.EXECUTE_COMMAND_NONQUERY(GetDatabaseName(databaseName), sql, 300))
    End Function

    Public Function EXECUTE_COMMAND_SINGLE_RESULT(sql As String, billerid As Integer) As String Implements IEmailQueueDatabase.EXECUTE_COMMAND_SINGLE_RESULT
        Return CallDB(Of String)(billerid, Function(client) client.EXECUTE_COMMAND_SINGLE_RESULT(DatabaseBase.DatabaseName.DBDynamic, sql, 300))
    End Function

    Public Function EXECUTE_COMMAND_SINGLE_RESULT(databaseName As String, sql As String, billerid As Integer) As String Implements IEmailQueueDatabase.EXECUTE_COMMAND_SINGLE_RESULT
        Return CallDB(billerid, Function(c) c.EXECUTE_COMMAND_SINGLE_RESULT(GetDatabaseName(databaseName), sql, 300))
    End Function

    Private Shared Function GetDatabaseName(databaseName As String) As Object
        Return [Enum].Parse(GetType(IC.Database.DatabaseBase.DatabaseName), databaseName)
    End Function

    Public Function GET_DATASET(sql As String, billerid As Integer) As DataSet Implements IEmailQueueDatabase.GET_DATASET
        Return CallDB(Of DataSet)(billerid, Function(client) client.GET_DATASET(DatabaseBase.DatabaseName.DBDynamic, sql, 300))
    End Function

    Public Function GET_DATATABLE(sql As String, billerid As Integer) As DataTable Implements IEmailQueueDatabase.GET_DATATABLE
        Return CallDB(Of DataTable)(billerid, Function(client) client.GET_DATATABLE(DatabaseBase.DatabaseName.DBDynamic, sql, 300))
    End Function

    Public Function GET_DATATABLE_MULTISHARD(sql As String, billerList As List(Of Integer)) As DataTable Implements IEmailQueueDatabase.GET_DATATABLE_MULTISHARD
        Return CallDB(0, Function(client) client.GET_DATATABLE_MULTISHARD(sql, 300, billerList))
    End Function
End Class
Information Provided by Katelyn Espinoza
 URL:/spaces/DS/pages/2882895873/Running+Email+Queue+Processing