none
Technical Requirements
Python version-3.12.2
VS Code 
Python extension for Visual Studio Code - It can be installed from the Extensions view (
Ctrl+Shift+X
) on VS Code
Python packages -Openai, requests, ruamel.yaml
Guide to Tool Usage
The python tool to identify the dependencies and generate healthcheck code for the same could be run on any vb.net or c# code repository . 
The tool could be targeted to run on a local repository already downloaded on user’s system or through GIT URL on any specific branch. Both of these approaches require certain command line arguments to be provided for the code to perform all steps.
The tool can be run either through VS Code or via command prompt.
Using Visual Studio
 Follow the below steps to run the tool on your local system-
Download the tool from 
this URL
Open the 'Python' folder in your VSCode
Open the python file 
program.py
 this would be the startup file to run the project
Go to the Debug view by press Ctrl+Shift+D or click on the icon ‘Run and Debug’ present on the activity bar left hand side of VS Code
Click on 
create a launch.json file
 link. This will open a dropdown from which you should select 
Python File
 - this option will setup the configuration to run the current Python file
This will create a 
launch.json
 file in a 
.vscode
 directory at the root of your project folder, and open it in the editor
In the 
launch.json
 file, locate the "args" field in the configuration. It should look like this: 
"args": []
 . Add command line arguments within the square brackets
Save the 
launch.json
 file
Go back to your Python file 
program.py
To run the Python file with the specified command line arguments, you can click on the green 
Start Debugging
 arrow at the top of the Debug view, or you can press 
F5
 on your keyboard
Using Command Prompt
Download the tool from 
this URL
Open a terminal or command prompt on your local system  
Navigate to the directory 'AI.CodeDocumentation-> python' using the 
cd
 (change directory) command. For example, if your Python file is located in a directory called "my_project" on your desktop, you would type 
cd Desktop/my_project/AI.CodeDocumentation/python
 (on macOS/Linux) or 
cd Desktop\\my_project\\AI.CodeDocumentation\\python
 (on Windows).  
Once you're in the correct directory, you can run your Python file with the Python interpreter. The command to do this is 
python
 followed by the name of your file 
Program.py
. For example, you would type 
python Program.py
.  
Note
: If you have both Python 2 and Python 3 installed on your computer, you might need to use the 
python3
 command instead of 
python
.  
Since this tool requires command-line arguments, you can provide them after the filename. For example, 
python Program.py arg1 arg2
.  
Press 
Enter
 to run the command and execute your Python file. 
Command Line Arguments
Arguments
Description
Required
FolderScan 
This is the first expected argument if the scan is to be done on a local folder
Optional
GitScan
This is the first expected argument if the scan is to be done on a Git URL
Optional
-source
Path to the source code folder which needs to be scanned
Required if doing FolderScan
 -
main_project_filepath
The main vb or c# project file name with full path. This is where the health check code will be added.
Always
-
config_file
The web or app config file name with full path. 
Optional
-
fileType
Comma separated values of types of file extensions to consider. Eg-  
.vb,.cs
Always
-
exclude
Comma separated List of folders to be exclude from the scan
Always
-
openai_resourcename
 Name of the OpenAI resource to be used 
Always
-
openai_deploymentid
Deployment ID of the OpenAI service
Always
-
openai_apikey
API key for the OpenAI service
Always
-
openai_endpoint
Endpoint URL of the OpenAI service
Always
-
analysis_outputpath
Full Path where the analysis output will be saved as text files
Always
-
code_outputfolder
Folder structure where the code output will be saved in the project file given under -
main_project_filepath
 . Eg- HealthCheck\\Output
Optional. Default Value= 
HealthCheck
-
confluence_url
URL of the Confluence site
Always
-
confluence_username
 Username for the Confluence site
Always
-
confluence_pat
Personal Access Token for the Confluence site
Always
-
confluence_space
Space in Confluence where the report will be posted
Always
-
max_retry
Maximum number of retries in case of failure from openai. Default value is 3
Optional . Default value= 3
-
ado_pat
Personal Access Token from Azure Devops
Required if doing GitScan
-
repo_name
Repository name from Azure Devops
Required if doing GitScan
-
branch_name
Azure Devops Branch Name
Required if doing GitScan
-
ado_project_name
Project Name
Required if doing GitScan
Sample Inputs
Using Visual Studio -Launch.json
json
{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Python: Current File",
            "type": "python",
            "request": "launch",
            "program": "${file}",
            "console": "integratedTerminal",
            "justMyCode": true,
            "args": ["FolderScan","-source", "C:\\Users\\<FolderPath>",
            "-main_project_filepath","C:\\Users\\<Folder Path>\\<Filename>.vbproj",
            "-config_file", ,"C:\\Users\\<Folder Path>\\<App/Web>.config",
             "-fileType",".vb,.cs", 
             "-exclude","bin,obj,Object,.devops,packages", 
             "-openai_resourcename","<openai_resourcename>",
             "-openai_deploymentid","<openai_deploymentid>",
             "-openai_apikey","<openai_apikey>",
             "-analysis_outputpath","C:\\Users\\<Folder path>",
             "-code_outputfolder","HealthCheck\\Output",
             "-openai_endpoint","<openai_endpoint>",             
             "-confluence_url","<confluence_url>",
             "-confluence_username","<confluence_username>",
             "-confluence_pat","<confluence_pat>",
             "-confluence_space","<confluence_space>","-max_retry","3"]
        }
    ]
}
Using Command Prompt
python Program.py FolderScan -source C:\\Users\\<FolderPath> -main_project_filepath C:\\Users\\<Folder Path>\\<Filename>.vbproj -config_file C:\\Users\\<Folder Path>\\<App/Web>.config -fileType .vb,.cs -exclude bin,obj,Object,.devops,packages -openai_resourcename <openai_resourcename> -openai_deploymentid <openai_deploymentid> -openai_apikey <openai_apikey> -analysis_outputpath C:\\Users\\<Folder path> -code_outputfolder HealthCheck\\Output -openai_endpoint <openai_endpoint> -confluence_url <confluence_url> -confluence_username <confluence_username> -confluence_pat <confluence_pat> -confluence_space <confluence_space> -max_retry 3  
Tool Usage
 - this is the video explaining how the tool is used with the repo
 
Some Common Changes Required Post Tool Run
Namespace changes for Service Reference: As per below screenshot ==INSERT_NAMESPACE== needs to be updated with ICDatabaseService(highlighted right side in the solution explorer)
Apps needs to test recently added health checks in dev environment:
a. Console Apps- 
postDeploySteps
 - this is required to trigger exe from agent server. Health check logs need to be verified on the pipeline Task as console logs
postDeployJob
 - this is required if 1) and 2) conditions hold true. This step will trigger the job on skybot server and health check logs needs to verified from the skybot server
1) if skybot job triggers only and only app exe(not multiple exes). 
2) if skybot job is 
not
 configured under 
Agent/Group
 as 
Type
 
All Agents Group
 
 
  b. WebApp/WebApi/Website Apps-
postDeploySteps
- this is required to trigger health check endpoint on the deployed server. Health check logs need to be verified on the pipeline Task as console logs or in the newrelic dashboard depending on how logging is configured.
Verify Added Health Checks
Console Apps- there can be a 2 scenarios 
a) Skybot job is triggered in deploy pipeline - in this case we need to verify health check logs at 2 places
Health Check On Server - 
verify success logs on the task itself
Skybot Job HealthCheck - 
verify success logs on the skybot server by downloading job logs
 
b) Skybot job is not triggered in deploy pipeline - in this case we need to verify health check logs at only place
Health Check On Server - 
verify success logs on the task itself
 
 
  WebApp/WebApi/Website Apps- We need to verify logs depending on where they are being omitted, generally it is newrelic. We also need to verify app health status(
isSuccess
) as true from this task.
 
 URL:/spaces/EN/pages/3087827000/AI.CodeDocumentation