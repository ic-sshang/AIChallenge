This document will detail the steps for running the EmailQueueProcessing repository. You will need to have inserted an email into the email queue table of your biller beforehand. You will also need the email queue type ID you are using.
Running EmailQueueProcessing 
Clone the EmailQueueProcessing repository
Ensure you have the version for the 4.6.1 version of the .Net Framework installed 
You can download this in the Company Portal on your machine
Go to the EmailQueueProcessing project-> Properties
Go to Debug-> in Command line argument put the email queue type ID you’re working with
SELECT * FROM tblEmailQueueType ORDER BY 1 ASC
Note: Some Email Queue Types require a second number. Review 
Module1.vb’s 
function called StartProcessingEmail. For example, Credit Card Expiration Notifications requires the command line arguments to be the following: “30 -MonthlyBatch”
 
Go to the EmailQueue folder in Solution Explorer and select the queue you want to run. (using consolidated Receipt Queue as an example)
Go to the GetEmailQueueItemsSql() function of your queue and specify the BID
Go to the constructor and set AvailabeForAzureBatch to false
  Public Sub New()
      Me.AvailableForAzureBatch = FALSE
  End Sub
Go to EmailQueueProcessing’s 
app.config
 and replace the value of RunAsyncThreadCount to 1
Go to the Database and insert a record into the email queue and use your test email as the EmailRecipient. 
For example, you can insert into the db with the following query for Declined Scheduled payments. Do keep in mind this will change for different EmailQueueTypes.
exec insEmailQueue @EmailQueueTypeID=4, @FKID={InvoiceID}, @BillerID={BillerID}, @EmailRecipient='YourEmail@invoicecloud.com', @EmailSubject='**BillerDBA** Invoice# **InvoiceNumber** Notification', @EmailBody='CARD NUMBER NOT ALLOWED'
Run
EQP Test Notes
Identify the Stored Procedure Call
:
Check the "base" method of each queue.
If the stored procedure call is 
selemailqueue
, you can insert directly into the 
EmailQueue
 table.
Ensure the data is getting picked up by testing the SP in SSMS under your Biller shard
Ensure you have the relevant data (e.g., payment receipts, AP/SP reminders) for correct processing.
Handle Different Stored Procedures
:
If the stored procedure differs, stage additional data tailored for that specific call.
Verify and Create Jobs in DevTest
:
QA has attempted to create all jobs in 
devtest
 that exist in 
prod
, but some queues may be missing.
If you're working on a queue without a job, copy an existing job:
Right-click on the job.
Change the name/description.
Modify the command argument to pass a different 
emailqueuetypeid
.
Ensure your Biller has RTDR disabled:
Can be found in CRM under Invoicing → Advanced Configuration → Disable “Real Time Data Refresh“ checkbox
 
 URL:/spaces/PE/pages/3960373249/How+To+Test+EmailQueueProcessing+Repository