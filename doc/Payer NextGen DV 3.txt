1
6
false
default
list
false
Overview
EBPP-16893
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
 
Requested handoff to App Dev Team: 2/19/2024
Branch for App Deployment Testing and Example
Supported Application Services
The following 
Application Services
 are currently supported in the Payer V3 Clusters in each 
Environment
.
This can be changed by updating the 
values found in the Payer_Infrastrucutre repo
.
one-time-payment-service = {
  application_service_indicator       = "one-time-payment-api"
  application_service_short_indicator = "otp"
  crypto_vault_access                 = true
  environment_vault_access            = true
  biller_shared_db_access             = true
},
pay-by-text-service = {
  application_service_indicator       = "pay-by-text-api"
  application_service_short_indicator = "paytxt"
  crypto_vault_access                 = true
  environment_vault_access            = true
  biller_shared_db_access             = false
},
payer-portal = {
  application_service_indicator       = "payer-portal-ui"
  application_service_short_indicator = "pyrprtl"
  crypto_vault_access                 = false
  environment_vault_access            = false
  biller_shared_db_access             = false
},
payer-account-service = {
  application_service_indicator       = "payer-account-api"
  application_service_short_indicator = "pyracts"
  crypto_vault_access                 = true
  environment_vault_access            = true
  biller_shared_db_access             = true
},
pay-by-text-ui = {
  application_service_indicator       = "pay-by-text-ui"
  application_service_short_indicator = "pytxtui"
  crypto_vault_access                 = true
  environment_vault_access            = true
  biller_shared_db_access             = false
},
payer-branding-service = {
  application_service_indicator       = "payer-branding-api"
  application_service_short_indicator = "pyrbrnd"
  crypto_vault_access                 = true
  environment_vault_access            = true
  biller_shared_db_access             = true
},
payer-user-service = {
  application_service_indicator       = "payer-user-api"
  application_service_short_indicator = "pyruser"
  crypto_vault_access                 = true
  environment_vault_access            = true
  biller_shared_db_access             = true
},
payer-support-service = {
  application_service_indicator       = "payer-support-api"
  application_service_short_indicator = "pyrsapi"
  crypto_vault_access                 = true
  environment_vault_access            = true
  biller_shared_db_access             = true
},
payer-support-ui = {
  application_service_indicator       = "payer-support-ui"
  application_service_short_indicator = "pyrsui"
  crypto_vault_access                 = false
  environment_vault_access            = false
  biller_shared_db_access             = false
}
Application Service Suffixes Explained
Each Application instance should end with one of the following suffixes to signify the type of Application:
-ui
 = long running, user interface exposed over HTTP
-svc
 = long running, can expose ports but over non standard HTTP
-job
 = long or short running, typically do not expose ports
-api
 = long running, expose data over HTTP
Supported Application Instances
The InvoiceCloud Infrastructure and Platform team supports the concept of multiple 
Application Instances per Environment
. 
The Payer Team has decided to only use the mandatory 
main
 Application Instance since the architecture of the Payer NextGen Application is centered on Microservices and currently only a single developer works on each individual Application Microservice at any given time.
If additional Applications Instances are desired in the Development Environment or Internal User Acceptance Testing Environment, this can easily be supported by making a request to update the 
Environment Variable file in the Payer_Infrastructure
 repo.
main-branch = {
  application_instance_indicator       = "main"
  application_instance_short_indicator = "main"
}
Supported URLs
Each Environment currently supports 4 flavors of a URL for each Application Service as follows:
https://payer.{env}.invoicecloud.com/payer/{application-service-specifier}

https://payer-v3.{env}.invoicecloud.com/payer{-application-instance-specifier}/{application-service-specifier}

https://payer-v3.{env}.invoicecloud.com/payer/{application-service-specifier}

https://payer.{env}.invoicecloud.com/payer{-application-instance-specifier}/{application-service-specifier}
It is recommended that we take out the 
/payer{-application-instance-specifier}/
 because it is redundant with the Root DNS Record of 
payer-v3
 and 
payer
, and replace it with just 
/{application-instance-specifier}/
 for when targeting a 
non-main
 Application Instance.
More info on 
Application Services
 and 
Application Instances
 as defined by the InvoiceCloud Infrastructure and Platform team.
Note the URLs are specific to a given InvoiceCloud NextGen Environment and are only accessible on the InvoiceCloud NextGen Private Network, which is what the AVDs are connected for the NonProd Environments.
Examples of a URL for each Environment is provided below.
Development (dev) Environment
https://payer-v3.dev.invoicecloud.com/payer-main/pay-by-text-api
 
https://payer.dev.invoicecloud.com/payer/pay-by-text-api
 
Internal User Acceptance Testing (iat) Environment
https://payer-v3.iat.invoicecloud.com/payer-main/pay-by-text-api
 
https://payer.iat.invoicecloud.com/payer/pay-by-text-api
 
Quality Assurance Regrestion (qar) Testing Environment
https://payer-v3.qar.invoicecloud.com/payer-main/pay-by-text-api
 
https://payer.qar.invoicecloud.com/payer/pay-by-text-api
 
External User Acceptance Testing (xat) Testing Environment
https://payer-v3.xat.invoicecloud.com/payer-main/pay-by-text-api
 
https://payer.xat.invoicecloud.com/payer/pay-by-text-api
 
Production (prd) Environment
https://payer-v3.prd.invoicecloud.com/payer-main/pay-by-text-api
 
https://payer.prd.invoicecloud.com/payer/pay-by-text-api
 
Must Haves




2


complete


Take the 
Proxy_Infrastructure
 templatize it in Platform as our Platformâ€™s Version 0 of an AKS Spoke






3


complete


Take the AzDo Terraform Pipeline Templates repo we have in 
System_Src
 and move them into 
Platfrom
 and update for 
platform-0






9


complete


Manual Firewall rules for 
Payer_Infrastructure
 DV 3 VNets






4


complete


Deploy DV 3 of Payer_NextGen






5


complete


Take the AzDo Pipeline Template for App Deployments and move them into 
Platform
 and update for 
platform-0






19


complete


Update the 
Global_AAD
 to support new Environment Stack






20


complete


Update the 
Global_Infrastrcture
 to support new Environment Stack






21


complete


Update the 
Hub_Infrastrcture
 to support new Environment Stack






16


complete


Update the Payer V3 to support new Environment stack.






12


complete


Create Helm Chart for Web App in the Platform AzDo Project.






17


complete


Update the Helm Deployment for changes needed to support Helm Chart for Web App






23


complete


Do DB Access ServiceDesk Ticket with Pipeline based approvals for NonProd Environments






25


complete


Update to utilize the External DNS inside the Web App Helm Chart in the Ingress and write to 
{env}.invoicecloud.com






26


complete


Provide Example of Platform Components usage in a 
Src
 App Repo






27


complete


Pull in 
linux-container-build.yaml@templates
 to 
Platform
 and remove the Build Helm Stage






28


complete


Do DB Access ServiceDesk Ticket with Pipeline based approvals for Prod Environments






15


complete


Update Helm Deployment to promoted images between XAT and PRD Stages.






13


complete


Add Secret Provider Class support to Web Helm Chart






18


complete


Add 
*.{env}.invoicecloud.com
 TLS Certs to IAT, XAT, and UAT






29


complete


Add IAT, XAT, and QAR to Legacy to NextGen KeyVault Sync






30


complete


 Add PRD to Legacy to NextGen KeyVault Sync






8


complete


Do payer-api CNAME cut over from payer-api-v2 to payer-api-v3
 We now use 
payer-v3
 and 
payer
 for the Private DNS Zone records since API and UI are hosted in the same AKS Cluster.






14


incomplete


Monitor and provide support to Payer NextGen Team as they update the remaining App Repos in 
Src




Nice to Haves




10


incomplete


Create new Payer AzDo Project and use that for all Infrastructure and App Repos.






11


incomplete


Use Ansible Playbook to do Firewall Rules setup




Handover Meeting Recording
payer-v3-handoff-meeting.mp4
 URL:/spaces/platform/pages/2989719749/Payer+NextGen+DV+3