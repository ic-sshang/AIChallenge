Fill in project details in the table below. Type /date to quickly add the target release date, /jira to link to Jira epics or issues, and @mention functional owners to keep everyone on the same page.
Page Navigation:
ITR
16347 - Integration coding
17080- ACH Rejec
16862 - Autopay Datapump
Document status
complete
Green
 
Document owner
 
 
Solution engineer
 
Knowledge Transfer
Gong | NLS-Duck Creek System Integration - Knowledge Transfer
API Documentation
IC Use
Partner API Name
Description
Request
Response
Specifications
RTDR: Balance Update
Account Balances- Returns account balances
GET URL: 
http://
nlsinvoicecloud.northcentralus.cloudapp.azure.com:8080/DuckCreek/api/v1/billing/account/{accountNumber}/balance?accountNumber=136&userKey=UserKey123Ex&userToken=UserToken456Ex
Params
accountNumber- Required. Account number. The account that will be used to return balance amounts
userKey- Required. Biller specific info. (not required)
userToken- Required. Biller specific info. (not required)
Successful response info:
pastDue- Equivalent to Invoice Header (IH) spec ID 93
curretInvoiceAmount
- Invoice amount charged during the period
totalAmountDue - Equivalent to IH spec 13. (Entire cost of the policy that has not been paid.)
balanceDue- Equivalent to IH spec 93.  Sum of total billed amount due on the invoice (pastDue + currentInvoiceAmount).
No 
past 
due amount:
{
    "pastDue": 0.0,
    "currentInvoiceAmount": 202.95,
    "totalAmountDue": 1290.06,
    "balanceDue": 202.95
}
With a balance due amount:
{
    "pastDue": 4.0,
    "currentInvoiceAmount": 139.89,
    "totalAmountDue": 1091.11,
    "balanceDue": 143.89
}
Failed response info:
{
    "ResponseInfo": {
        "Message": "Payment not posted.",
        "Status": "failure",
        "ErrorDetail": {
            "FailureReason": "Error: 50000, Severity: 16, State: 1, in proc DC_SP_BIL_ProcessAutoPaymentAllocation at line 222, Message: \"AccountId: 199 not found.\"",
            "ExceptionType": "SqlException",
            "ExceptionSource": "SqlException"
        }
    }
}
Data Pump: Payment
Post Payment- Posts a payment to duck billing system
PUT URL: 
http://
nlsinvoicecloud.northcentralus.cloudapp.azure.com:8080//DuckCreek/api/v1/billing/account/{accountNumber}/paymentMethod/{paymentMethod}/paymentAmount/{paymentAmount}/postAccountPayment?accountNumber=199&paymentMethod=ACH&paymentAmount=198.95&paymentSource=MANUAL&paymentSourceSystem=CSRConnect
 &confirmNumb=ACBCDEF-CONFIRM&userKey=UserKey123&userToken=UserToken456&invoiceNumber=Dev-Line1000153-0000000415&paymentID=PaymentID-0000000415&paymentDateTimeStamp=2020-09-18 16:59:40.200&payeeName=IC Joe Spoon&payeeAddress=123 Maine 
Street&payeeCity=Witford&payeeState=MO&payeeZip=12209&payeePhone&payeeEmail=janeDoe@jane.com
&paymentDescription&cardType=Visa&paymentMessage&convenienceFee&remoteIP=12.01.25.63
Params
 accountNumber- Optional. Account number.  Equivalent to Customer Record (CR) spec 59. Note- if not provided payment will get posted as an unidentified payment.
paymentMethod- Required. Options are: "CC", "CK”, "ACH". CC for credit card. CK for Check. ACH for automatic clearing house.
paymentAmount- Required. Amount of payment being made. Format as 12.0, 12.00 , 12 are all acceptable options
paymentSourceSystem- Required. Any string text that defines source of the payment. Examples are "CSRConnect", "CloudPay", "CustomerPortal".
paymentDateTimeStamp- Required. Example format 2020-09-18 16:59:40.200
confirmNumb- Required. Confirmation number associated with the payment.
paymentSource- Optional. Options are: "manual", "unidentified". Unidentified, should be used if no account number is not provided or an unidentified payment is being made. Else payment type of Manual should be sent. If this field is left blank and no accountNumber is provided payment method will be systemically set to unidentified.
userKey- Required.
userToken- Required.
invoiceNumber- Required. Equivalent to Header Record (HR) spec 10. 
Example Dev-Line1000153-0000000415
paymentID- Invoice cloud unique Payment Identification .
payeeName- Customer Name.
payeeAddress- Customer Address.
payeeCity- Customer City.
payeeState- Customer State.
payeeZip- Customer Zip.
payeePhone- Customer Phone.
payeeEmail- Customer Email.
paymentDescription- Description of the payment. Example: Credit Card Ending in xxxx
cardType- Card used for payment. Examples: American Express, Visa, MasterCard or Discover.
paymentMessage- Payment message. Approved 123456
convenienceFee- Amount of convenience fee.
remoteIP- Remote IP.
Successful call response:
{
    "ResponseInfo": {
        "Message": "Payment for $150.20 successfully
                            entered.",
        "Status": "success",
        "PostPaymentInfo": {
            "Amount": "$150.20",
            "ApppliedTo": "accountBalance",
            "PaymentMethod": "CC",
            "PaymentID": "47",
            "AccountNumber": "23"
        }
    }
}
Failed call response:
{
    "ResponseInfo": {
        "Message": "Payment not posted.",
        "Status": "failure",
        "ErrorDetail": {
            "FailureReason": "Error: 50000, Severity: 16, State: 1, in proc DC_SP_BIL_ProcessAutoPaymentAllocation at line 222, Message: \"AccountId: 350 not found.\"",
            "ExceptionType": "SqlException",
            "ExceptionSource": "SqlException"
        }
    }
}
 
Data Pump: Refund
Reverse Payment- reverses a previously posted payment
GET URL: 
http://
nlsinvoicecloud.northcentralus.cloudapp.azure.com:8080/DuckCreek/api/v1/billing/account/{accountNumber}/paymentID/{paymentID}/reversalReason/{reversalReason}/paymentReversal?accountNumber=20&paymentID=29&reversalReason=NF&userKey=ABC&userToken=3665321
Params
 accountNumber- Required. Account number.
paymentID- Required. Payment ID that was provided when payment was successful
reversalReason- Required. Reason for the reversal. Options are: "NF","CM", "OT".
"NF" for Non-sufficient funds, "CM" for Company mistake, "OT" for Other
userKey- Required.
userToken- Required.
Successful call response:
{
    "ResponseInfo": {
        "Message": "$2532.17 Payment was reversed. Reason: Non-sufficient funds",
        "Status": "success",
        "ReversalInfo": {
            "ReversalAmount": "$2532.17",
            "Reason": "NF",
            "ReversedPaymentID": "29",
            "AccountNumber": "20",
            "ReturnCode": "0"
        }
    }
}
Failed call response:
{
    "ResponseInfo": {
        "Message": "Payment not reversed.",
        "Status": "failure",
        "ErrorDetail": {
            "FailedPaymentID": "2",
            "FailureReason": "Value cannot be null.\r\nParameter name: parent",
            "ExceptionType": "ArgumentNullException",
            "ExceptionSource": "ArgumentNullException"
        }
    }
}
See InvoiceCloudAPI doc above
Data Pump: ACH Reject
ACH Reject - Provides information to NLS/Duck Creek in the event of an ACH reject. 
GET URL: 
http://
nlsinvoicecloud.northcentralus.cloudapp.azure.com:8080/DuckCreek/api/v1/billing/account/{accountNumber}/paymentID/{paymentID}/reversalReason/{reversalReason}/paymentReversal?accountNumber=20&paymentID=29&reversalReason=NF&userKey=ABC&userToken=3665321
Params
 accountNumber- Required. Account number.
paymentID- Required. Payment ID that was provided when payment was successful.
reversalReason- Required. Reason for the reversal. See linked document for details. 
userKey- Required.
userToken- Required.
Successful call response:
{
    "ResponseInfo": {
        "Message": "$2532.17 Payment was reversed. Reason: Non-sufficient funds",
        "Status": "success",
        "ReversalInfo": {
            "ReversalAmount": "$2532.17",
            "Reason": "NF",
            "ReversedPaymentID": "29",
            "AccountNumber": "20",
            "ReturnCode": "0"
        }
    }
}
Failed call response:
{
    "ResponseInfo": {
        "Message": "Payment not reversed.",
        "Status": "failure",
        "ErrorDetail": {
            "FailedPaymentID": "2",
            "FailureReason": "Value cannot be null.\r\nParameter name: parent",
            "ExceptionType": "ArgumentNullException",
            "ExceptionSource": "ArgumentNullException"
        }
    }
}
See InvoiceCloudAPI docx above
Data Pump: Paperless Enrollment
Update Account Setting 
PUT URL:
http://
nlsinvoicecloud.northcentralus.cloudapp.azure.com:8080//DuckCreek/api/v1/billing/account/{accountNumber}/settingsType/{settingType}/settingsValue/{settingValue}?accountNumber=134&settingType=PAPERLESS&settingValue=1&userKey=UserKey123&userToken=UserToken456
Params
accountNumber- Account number.
settingType- Required. Options are: 
”PAPER”, "PAPERLESS", "AUTOPAYEFT", "AUTOPAYEFTC". Use "PAPERLESS" for changing paperless option. "AUTOPAYEFT” for changing the auto pay ACH/Check auto pay option. "AUTOPAYEFTC" for recurring credit card payment option.
settingValue- Options are 1 or 0. If AUTOPAYEFT or AUTO PAYEFTC is turned off (0 sent with ‘PAPER’ as settingType) system will systematically switch to paper invoices.
userKey- Required.
userToken- Required.
Successful call response:
{
    "ResponseInfo": {
        "Message": "The following account configuration changes were made: Electronic Invoice was enabled.  The Account was rescheduled.",
        "Status": "success",
        "SettingChangeInfo": {
            "Setting": "PAPERLESS",
            "SettingValue": "1",
            "Message": "The following account configuration changes were made: Electronic Invoice was enabled.  The Account was rescheduled.",
            "AccountNumber": "21"
        }
    }
}
See InvoiceCloudAPI docx above
Data Pump: AutoPay Enrollment
Update Account Setting
PUT URL:
http://nlsinvoicecloud.northcentralus.cloudapp.azure.com:8080//DuckCreek/api/v1/billing/account/{accountNumber}/settingsType/{settingType}/settingsValue/{settingValue}?accountNumber=134&settingType=PAPERLESS&settingValue=1&userKey=UserKey123&userToken=UserToken456
Params
accountNumber- Account number.
settingType- Required. Options are: “PAPER”, "AUTOPAYEFT", "AUTOPAYEFTC". Use "AUTOPAYEFT” for changing the auto pay ACH/Check auto pay option. "AUTOPAYEFTC" for recurring credit card payment option.
settingValue- Options are 1 or 0. If AUTOPAYEFT or AUTO PAYEFTC is turned off (0 sent  with ‘PAPER’ as settingType) system will systematically switch to paper invoices.
userKey- Required.
userToken- Required.
Successful call response:
{
    "ResponseInfo": {
        "Message": "The following account configuration changes were made: Electronic Invoice was enabled.  The Account was rescheduled.",
        "Status": "success",
        "SettingChangeInfo": {
            "Setting": "AUTOPAY",
            "SettingValue": "1",
            "Message": "The following account configuration changes were made: Electronic Invoice was enabled. The Account was rescheduled.",
            "AccountNumber": "21"
        }
    }
}
See InvoiceCloudAPI docx above
GET PDF invoice
Invoice Form- Get PDF version of the invoice record
GET URL: 
http://
nlsinvoicecloud.northcentralus.cloudapp.azure.com:8080/DuckCreek/api/v1/billing/account/{invoiceNumber}/InvoiceForm?invoiceNumber=Dev-Line1000153-0000000415&userKey=ABC&userToken=3665321
Params
i.    invoiceNumber- Required. Invoice Number Equivalent to Header Record (HR) spec 10. Example Dev-Line1000153-0000000415.
ii.    userKey- Required.
iii.   userToken- Required.
Successful call response:
{
    "ResponseInfo": {
        "Message": "PDF request success. See response details",
        "Status": "success",
        "FormPDFInfo": {
            "PdfFileBytes": "JVBERi0xLjUKJYCAgIANMSAwIG9iago8PAovVGl0bGUgPD4KL0F1dGhvciA8PgovS2V5d29yZHMgPD4KL1N1YmplY3QgPD4KL0NyZWF0b3IgPDRENjk2MzcyNkY3MzZGNjY3NDIwNEY2NjY2Njk2MzY1MjA1NzZGNzICDhBP3nDRCmWnD4vGY2hBC533JUvFQmtUrKwYIW/HY2o0vC53RaPSROLZPUUq/1mlO/OaXSFCmIDYbXbbdn6ndRjMwbTz3b7Dfzyn8HjcfD7vlP/V76ebTkaJP0zm9Hrder8vd72CZ+Ls+g7mL9DsRLL0ry+n1UDtbu2QfvO8QQ0wK+PRmN+uH5GMu/9P/ACQH/AcCQLA0DwRAZnhAGBPnfBMBtCg8COKhQIE+f7uIgEECurAMJwRDUPxHEiDQhE8TnergIDAZ8IPnEBHoYGEXQyjogQK18SgBHEEQlHcgR3FEhwO8iCBAR8HwNH6CF+Z8dIIOElRsjg4QI/0goIMEEyNLMvP/IkwwHGCECgV8DTIghXvehAITPAsRIcR8CTjEhAQTCqCggIE+T6IE2ABJBfwMd5fjhKCFxYT9BwMZ5PjBRCBT3P0+0igQYUpPlAIJSdM04MBXymf8ZIWIBAF+b8D0KQFNoUEFMiBNIgE/GsCG+V78o9U1UUJQ00oeCAoEfRkC1vSCEzFIjwIYEBAVSf8mUkhQYWfOCO2JaMgTfA8PIEKEEPtQNtwSd7BIeEEMSIT9foJb8EUsAFiQLcKDStBCBkBUU6ITM0xF/bqDXTdd8Sa9rUjnLPf6hNcsT9XY1yVMzouaqKF2up4uK4rwUq8cRCg5TirJt20/E/pn+KGvfDzx34R1Lw54q1Twtd6Tq0LW15Z317CEnjYYKkFs/j1BGRXjv7HX7H37Pv7HfivWNX+HV7pK6rrkf2aWebXlvZI4dwbyY9znam4Anudq5JwK/nbKKSSVGT7UvdCA0NCAwIFIKL0luZm8gMSAwIFIKL0lEIFs8RDZCNTcyNzRENjMwMUQ1QUE2QUIxMDRFREMzRkUwRjU+PEQ2QjU3Mjc0RDYzMDFENUFBNkFCMTA0RURDM0ZFMEY1Pl0KPj4Kc3RhcnR4cmVmCjEzMDUyNA0lJUVPRgo="
        }
    }
}
Failed call response:
{
    "ResponseInfo": {
        "Message": "No Invoice available for NBUS invoice.",
        "Status": "failure",
        "ErrorDetail": {
            "FailedIvoiceID": "Line1000047-NBUS",
            "FailureReason": null,
            "ExceptionType": "Invoice form not found in the system.",
            "ExceptionSource": "No Invoice found on lookup"
        }
    }
}
See InvoiceCloudAPI docx above
File Mapping
Invoice File
File Extension: .BIF
File Naming Convention: standard (BID_MMDDYYYYHHMMSS.BIF)
File Delimiter: Pipe
Specification: N/A
Sample File: 
File Transfer Frequency: Multiple times per day as policies are generated. 
IC FileSpecID
IC Field
In File (Y/N)
Required (T/F)
Partner Field Name
Partner Field Format
Partner Field Description
Partner Field Character Limit
Record Type
1
RowType
TRUE
File Header
2
BillerGuid
TRUE
File Header
3
ThirdPartyFileReference
FALSE
File Header
4
FileCreationDate
TRUE
File Header
5
InvoiceCount
TRUE
File Header
6
TotalInvoiceAmount
TRUE
File Header
7
RowType
TRUE
Invoice Header
8
RecordType
TRUE
Invoice Header
9
InvoiceFormatGuid
TRUE
Invoice Header
10
InvoiceNumber
TRUE
Invoice Header
11
InvoiceDate
TRUE
Invoice Header
12
InvoiceDueDate
TRUE
Invoice Header
13
TotalAmountDue
TRUE
Invoice Header
20
AllowPartialPayments
FALSE
Invoice Header
21
MinimumAmountDue
FALSE
Invoice Header
23
FirstNotifyRequestedDate
FALSE
Invoice Header
24
SecondNotifyRequestedDate
FALSE
Invoice Header
25
ThirdNotifyRequestedDate
FALSE
Invoice Header
93
BalanceDue
FALSE
Invoice Header
194
BalanceForward
FALSE
Invoice Header
248
AutoPayCollectionDate
FALSE
Invoice Header
252
InvoiceTypeID
TRUE
Invoice Header
317
PaymentExpirationDate
FALSE
Invoice Header
318
PaymentExpirationMessage
FALSE
Invoice Header
375
Active
FALSE
Invoice Header
407
PastDue
FALSE
Invoice Header
59
AccountNumber
TRUE
Customer Record
60
CustomerName
TRUE
Customer Record
61
Address1
FALSE
Customer Record
62
Address2
FALSE
Customer Record
63
City
FALSE
Customer Record
64
State
FALSE
Customer Record
65
Zip
FALSE
Customer Record
66
Phone
FALSE
Customer Record
67
EmailAddress
FALSE
Customer Record
356
BlockPaymentsCC
FALSE
Customer Record
357
BlockPaymentsEFT
FALSE
Customer Record
373
DisplayAccountNumber
FALSE
Customer Record
70
RowType
TRUE
Invoice Detail
BIF Customization's
Feature
BIF CUSTOMIZATIONS
AchServiceFee
N/A
AllowPartialPayments
Provided via BIF or BIF customization. 
AutoPayCollectionDate
Provided via BIF or BIF customization. 
BalanceForward
Provided via BIF or BIF customization. 
CreditCardServiceFee
N/A
FirstNotifyRequestedDate
Provided via BIF or BIF customization. 
InvoiceDate
Provided via BIF
InvoiceDueDate
Provided via BIF
InvoiceFormatGuid
Provided via BIF
InvoiceTypeID
Provided via BIF
LateFeeDate
N/A
LocationReference
N/A
MinimumAmountDue
Provided via BIF
PaymentExpirationDate
Provided via BIF or BIF customization. 
PaymentExpirationMessage
Provided via BIF or BIF customization. 
PromptPayExpirationDate
N/A
RegistrationValue
N/A
SecondNotifyRequestedDate
Provided via BIF or BIF customization. 
ThirdNotifyRequestedDate
Provided via BIF or BIF customization. 
Advanced Settings
Setting ID
Description
Value (Example values below from CRM BID 2112)
Is value unique per biller? (Y/N)
8
RTDR EndPoint/WebService URL
http://nlsinvoicecloud.northcentralus.cloudapp.azure.com:8080/DuckCreek/api/v1/billing/account/{0}/balance?userKey=&userToken=
Y
9
RTDR Username if Applicable
admin
Y
10
RTDR Key or Password if Applicable
 
 Y
11
DataPump Payments EndPoint/WebService URL
http://nlsinvoicecloud.northcentralus.cloudapp.azure.com:8080/DuckCreek/api/v1/billing/
Y
12
DataPump Payments EndPoint/WebService Username
admin
Y
13
DataPump Payments EndPoint/WebService Password
Y
14
DataPump Paperless EndPoint/WebService URL
http://nlsinvoicecloud.northcentralus.cloudapp.azure.com:8080/DuckCreek/api/v1/billing
Y
15
DataPump Paperless EndPoint/WebService Username
admin
Y
16
DataPump Paperless EndPoint/WebService Password
Y
20
Remote PDF EndPoint/WebService URL
http://nlsinvoicecloud.northcentralus.cloudapp.azure.com:8080/DuckCreek/api/v1/billing/account/{invoiceNumber}/InvoiceForm?invoiceNumber={0}&userKey=&userToken=
Y
21
Remote PDF EndPoint/WebService Username
admin
Y
22
Remote PDF EndPoint/WebService Password
 
Y 
User Interaction and Design
Data Flow - Invoice
Data Flow - Adjustments
Data Flow - Payment
Data Flow - Refund
Data Flow - ACH Reject
Data Flow - Change Log
Data Flow - Bill Presentment
Payer Experience
Payers will access Invoice Cloud from the Biller website (URL redirect). Payers will use the IC Virtual Site and Customer Portal.
Biller Experience
Billers will interact within DuckCreek (NLS) and 
process payments via CloudPay (unidentified payments) or CloudCSRConnect (identified policy or account number).
 For reporting, they will use the standard Biller Portal dashboard. 
Flow diagram with screenshots at the following link: 
https://invoicecloud.app.box.com/file/785061962989?s=jeqmx21fq9vuucgkirypl7o1wkhgrtv4
 
Invoice Cloud Web Services
API Name
API Use/Purpose
UploadInvoice
Uploading single invoices on the fly.
UploadInvoiceFile
Uploading a set of invoices. 
 URL:/spaces/IM/pages/505315329/Next+Level+Solutions+NLS+-+Duck+Creek+Technical+Design