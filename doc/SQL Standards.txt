SQL Development Standards
We primarily use Microsoft SQL Server, on Azure, to store our relation data about our customers.
Our current database architecture is as follows:
1 Master database 
 This database contains basic information about our billers and an ID we can use to identify their shard. 
N number of Shards
 A shard is simply a database 
1 Shard Map Manager database 
 This database contains a map from the master database to the shards. This facilitates communication from the master database to a number of shards or from a shard to the master database. 
How do we connect to the database server using Microsoft SQL Management Studio?
Here is a link to a Guru Card that documents how to connect to our database servers. 
Guru Card: 
https://app.getguru.com/card/eTkb6xzT/SSMS-Connection-Requirements
How do we connect to the database in our applications?
There are many ways we can communicate with our SQL databases, but we have two preferred routes. 
Use the IC.Database NuGet package.
 The NuGet package IC.Database can be found in our private NuGet feed. This library is the backbone of our Database Service.
 We should only use this library if we encounter the following scenarios: 
The application is running outside of our network.
Examples are: 
Azure Functions
Azure Batch jobs
Azure Web Apps
We have a serious performance reason as to why the database service is not sufficient for the application.
Examples:
My dataset is too large to get a response back from the database service in time. 
We may have jobs that run every 5 minutes, and the expectation for that job is to finish within the 5 minute window. 
Having a direct call to the database may improve the performance on the application. 
My application will run in many instances, and each instance will perform a multishard call every x minutes. 
We can remove the strain of heavy calls from the Database Service by moving the database call inside the application. 
This will help the app performance and overall system health. 
We do not use entity framework or 
http://ADO.NET
  on our main applications. 
We want to abstract that layer from our applications. 
What kind of queries can be used in an application?
The perferred method of using queries is to use stored procedures. 
The format we expect for database queries are as follows: 
Exec storedProcedure @Pram1={data1}, @Param2='{data2}'; 
How many stored procedures can we use in one database command?
One stored procedure. 
Here are the reasons we limit one stored procedure per database call: 
If there are any issues, we will get an alert/email notification that the stored procedure failed. 
Having more than one stored procedure used will increase the time to resolution since the team may have to look at multiple areas to determine those that are not problematic. 
For instrumentation. NewRelic has an out of the box tracing mechanism for database calls. 
If we limit the database call for one stored procedure, we can tell how long that took for the client. 
This is helpful to identify which stored procedures need fine tuning. 
If any of these standards are not met, the pull request will be subject for rejection.
Conventions
DateTime Columns
Traditionally DateTimes have been stored in Central Time.
Any new DateTime columns should be stored in UTC and converted to the local time zone as required.
New DateTime columns should have a “Utc” suffix to indicate that they are stored in UTC.
Existing columns without the “Utc” suffix should be assumed to be in Central Time.
Related
Capitalization Conventions
 
Exception Guidelines
 
Logging Standards
 
 URL:/spaces/ED/pages/2806284375/SQL+Standards