Page Navigation:
Jira tickets
Document status
Completed
Document owner
Solution engineer
 
Payment/Lockbox File
File Summary/Purpose: The purpose of this file is transfer payment data from IC to the biller
File Extension: .txt
File Naming Convention: Peoria_ICPayment_YYYYMMDD
File Delimiter: Fixed position
Specification: 
Specification for Invoice Type ID 39, 70, 95, 96:
Specification for Invoice Type ID 65:
Sample File:
SFTP File Path:
File Transfer Frequency: Daily
Int Mod: This file already exists for Utility - this 
int mod
 is to add Invoice Type 1 (API payments) and Invoice Type 63 (Cloud Store Payments) to the payment file. This will require adding these invoice types to the file export logic and using a store procedure to fetch the needed data. This is a file that sums payment and credit batches for that invoice type. Logic already exists for utility, please replicate for Invoice type 1 and Invoice Type 63. This shouldn’t affect the existing rows for Utility. The existing logic filters payments by InvoiceType (API payments are represented by payments without an InvoiceID), then groups payments and reports them according to SettledBatchID. 
Field Mapping
1800
Header record (can be multiple per file, 1 for each invoice type)
Field
Data Type
Character Limits
Format
Values
RECORD_TYPE
Length 1, Position 1
'H'
BUSINESS_UNIT
Length 5, Position 2
‘COPAZ’
JOURNAL_ID
Length 10, Position 7
‘IC#’ where # is the header # in the file (IC1, IC2, IC3)
JOURNAL_DATE
Length 8, Position 17
MMDDYYYY
ADJUSTING_ENTRY
Length 1, Position 25
'N'
Blank
Length 11, Position26
Blank
LEDGER_GROUP
Length 10, Position 37
‘ACTUALS’
Blank
Length 10, Position 47
Blank
REVERSAL_CD
Length 1, Position 57
'N'
Blank
Length 11, Position 58
Blank
REVERSAL_CD_ADB
Length 1, Position 69
'S'
Blank
Length 8, Position 70
Blank
Source
Length 3, Position 78
IC
Blank
Length 8, Position 81
Blank
DESCR
Length 30, Position 89
‘InvoiceCloud’
FOREIGN_CURRENCY
Length 3 Position 119
‘USD’
Blank
Length 53, Position 122
Blank
BUDGET_HDR_STATUS
Length 1, Position 175
'N'
KK_AMOUNT_TYPE
Length 1, Position 176
'7'
Blank
Length 268, Position 177
Blank
Detail Record
Field
Data Type
Character Limits
Format
Values
RECORD_TYPE
Length 1, Position 1
'L'
BUSINESS_UNIT
Length 5, Position 2
‘COPAZ’
JOURNAL_LINE
Length 9, Position 7
Each line within file must be unique value, start at 1 and iterate (1, 2, 3, 4)
LEDGER
Length 10, Position 16
'ACTUALS”
ACCOUNT
Length 10, Position 26
See mapping below for corresponding entry #
Blank
Length 10, Position 36
Blank
DEPTID
Length 10, Position 46
Blank for all invoice types. 
Blank
Length 14, Position 56
Blank
FUND_CODE
Length 5, Position 70
See mapping below for corresponding entry #
CLASS_FLD
Length 5, Position 75
Blank
PROGRAM_CODE
Length 5, Position 80
Blank for all invoice types. 
 
Blank
Length 131, Position 85
Blank
MOVEMENT_FLAG
Length 1, Position 216
'N'
Blank
Length 65 Position 217
Blank
FOREIGN_AMOUNT
Length 28, Position 282
See mapping below for corresponding entry #
Blank
Length 309, Position 310
Blank
Mapping for Invoice Type 1, 42 and 63
Entry
Account
Fund Code
Foreign Amount
1
010020
9990
Transaction Amount (Debit)
2
170000
9990
Transaction Amount (Credit)
3
015000
2050
Transaction Amount (Debit)
4
134300
2050
Transaction Amount (Credit)
Mapping for Invoice Type 188 (Donations)
Entry
Account
DEPTID
Fund Code
CLASS_FLD
PROGRAM_CODE
Foreign Amount
1
010020
9990
Transaction Amount (Debit)
2
170000
9990
Transaction Amount (Credit)
3
015000
8013
Transaction Amount (Debit)
4
481500
0000
8013
NA
00000
Transaction Amount (Credit)
Mapping for Invoice Type 39 (Police Fees), 95 (City Records), 96 (Police Records)
Entry
Account
DEPTID
Fund Code
CLASS_FLD
PROGRAM_CODE
Foreign Amount
1
010020
9990
Transaction Amount (Debit) Amex Payments Only
2
010020
9990
Transaction Amount (Debit) All Other Payment Types (Excluding Amex)
3
170000
9990
Transaction Amount (Credit)
4
015000
1000
Transaction Amount (Debit)
5
438002 
(InvoiceTypeID 96)
0000
1000
NA
00000
Transaction Amount (Credit)
6
438000 
(InvoiceTypeID 95)
0000
1000
NA
00000
Transaction Amount (Credit)
7
430700 
(InvoiceTypeID 39)
0000
1000
NA
00000
Transaction Amount (Credit)
Mapping for Invoice Type 65 (Water Payment Assistance Program)
Entry
Account
DEPTID
Fund Code
CLASS_FLD
PROGRAM_CODE
Foreign Amount
1
010020
9990
Transaction Amount (Debit) Amex Payments Only
2
010020
9990
Transaction Amount (Debit) All Other Payment Types (Excluding Amex)
3
170000
9990
Transaction Amount (Credit)
4
015000
8013
Transaction Amount (Debit)
5
481500
0000
8013
NA
00000
Transaction Amount (Credit)
Payment/Lockbox File NEW - Workday
File Summary/Purpose: The purpose of this file is to transfer payment data from IC to the biller.
This report uses a JSON configuration 131 to group invoice type IDs, define eCommerce MID descriptions, and manage GL posting accounts.
File Extension: .txt
File Naming Convention: Peoria_AHBT_ICPayment_YYYYMMDD
File Delimiter: , (comma)
Specification:
Summary
The Peoria_AHBT_ICPayment export groups payments by eCommerce MID description name, and provides the Total Amount for all invoice types with the same group name.  The eCommerce MID grouping should only be reported if invoice type ID totals > or < 0. 
Each grouping is reported by payment type AMEX and OTHER (EFT (Check), Credit/Debit Card - Visa, Credit/Debit Card - Discover, Credit/Debit Card - Mastercard).  A max of 2 lines for each ecommerce MID grouping (AMEX, OTHER).  For each grouping, the GL codes within the table below must be used.  
Sample File:
SFTP File Path:
File Transfer Frequency: Daily
Field Mapping
1800
Field
Description
Example Values
AdHocBankTransactionKey
Unique number used to ID each transaction grouping.  A transaction grouping is based on the ecommerce MID grouping name, payment type, and transaction date.  When the grouping changes, the sequence number should be increased.
Example:
AHBT_1 
    IC_UTILITY_OTHER
AHBT_2    IC_UTILITY_AMEX
AHBT_3    IC_PERMITS_OTHER
AHBT_4    IC_PERMITS_AMEX
“AHBT_1”
”AHBT_2”
This value (1, 2, etc) is a sequence number and can be repeated when a file is generated on a different date.
AdHocBankTransactionID
This is a unique Journal ID (IC-generated sequence number) that can only be used once for transaction grouping.
“IC1395251
1
”
IC+
WSReportID
+iterate by 1
Each line within the file must be a unique value, and the WSReportId is used to obtain the starting number.  Each row will iterate the WSReportID by 1.
This number can never be repeated within any file.
TransactionDate
Transaction Group Header Line - Transaction Date
YYYY-MM-DD (must be in this format)
TransactioMemo
Transaction Group Header Line - Hardcode
“Invoice Cloud Import”
BankAccountreferenceID
Hardcode
“WF-5671”
DepositOrWithdrawal
If transactionAmount >0, then “Deposit”.
If transactionAmount <0, then “Withdrawal”
“Deposit” or “Withdrawal”
TransactionAmount
Total amount based on the transaction grouping (sum of all invoice types within the grouping) by eCommerce MID grouping name and Payment_type.   Format includes decimal and 2 places.
15000.00
TransactionID
Transaction Group:
Concantenate
IC_+
eCommerce MID Grouping Name_
+Payment Type Grouping
Each grouping would never contain more than two entries:
AHBT_1     IC_PERMITS_OTHER
AHBT_2    IC_PERMITS_AMEX
There is always 1 line for AMEX, and the OTHER represents EFT (Check), Credit/Debit Card - Visa, Credit/Debit Card - Discover, Credit/Debit Card - Mastercard.
Examples:
IC_UTILITY_AMEX
IC_UTILITY_OTHER
ExternalReference
Set to AdHocBankTransactionID (unique sequence number)
“IC13952511” (Same as calculated value in AdHocBankTransactionId)
JournalSource
Hardcode
“INVOICE_CLOUD”
LineOrder
Hardcode to ‘1’.
“1”
LedgerAccountReferenceID
Set the journal account from the table below for the eCommerce MID grouping name.
22215
LineAmount
Total amount based on the transaction grouping (sum of all invoice types within the grouping) by eCommerce MID grouping name and Payment_type.
15000.00
LineMemo
Hardcode
“Invoice Cloud Deposit”
Worktag_Spend_Category_ID
Blank
Blank
Worktag_Revenue_Category_ID
Set the journal account as indicated in the table below for the eCommerce MID grouping name.  If no entry exists, then blank.
RC0308
Worktag_Fund_ID
Set the journal account as indicated in the table below for the Invoice Type ID. 
F2050
Worktag_Custom_Organization_Reference_ID
Set the journal account as indicated in the table below for the Invoice Type ID.  If no entry exists, then blank.
FX003
GL Code Field Mapping by Invoice TypeID
1800
Invoice Type ID
Description
eCommerce MID Grouping Name
LedgerAccountReferenceID
Worktag_Fund_ID
Worktag_Revenue_
Category_ID
Worktag_Custom_Organization_
Reference_ID
1
Utilities
UTILITY
22215
F2050
42
Utilities
UTILITY
22215
F2050
63
Utilities
UTILITY
22215
F2050
65
Utilities
DONATION
48000
F8013
RC0308
FX001
43
Permit
PERMITS
22230
F1000
39
Police Fees Leads Online
LEADS
43000
F1000
RC0052
FX003
70
Miscellaneous Police
POLICE
43000
F1000
RC0191
FX003
96
Police Records
POLICE
43000
F1000
RC0191
FX003
95
City Records
CLERK
43000
F1000
RC0189
FX001
71
Miscellaneous Fire
FIRE
43000
F1000
RC0190
FX003
69
Library Passport Application
LIBRARYPASSPORT
43000
F1000
RC0195
FX002
Advanced Settings
Advanced setting 131 - JSON Configuration was created to control the grouping of the Workday report and indicate which GL codes should be used for each grouping.  An InvoiceTypeID can only exists in 1 grouping.
wide
1800
{
    "CityOfPeoria": {
        "PaymentExports": {
            "WorkdayGroupMappings": [
                {
                    "InvoiceTypeIds": [
                        1,
                        42,
                        63
                    ],
                    "CommerceMidGroupingName": "UTILITY",
                    "LedgerAccountReferenceId": "22215",
                    "WorktagFundId": "F2050"
                },
                {
                    "InvoiceTypeIds": [
                        65
                    ],
                    "CommerceMidGroupingName": "DONATION",
                    "LedgerAccountReferenceId": "48000",
                    "WorktagFundId": "F8013",
                    "WorktagRevenueCategoryId": "RC0308",
                    "WorktagCustomOrgReferenceId": "FX001"
                },
                {
                    "InvoiceTypeIds": [
                        43
                    ],
                    "CommerceMidGroupingName": "PERMITS",
                    "LedgerAccountReferenceId": "22230",
                    "WorktagFundId": "F1000"
                },
                {
                    "InvoiceTypeIds": [
                        39
                    ],
                    "CommerceMidGroupingName": "LEADS",
                    "LedgerAccountReferenceId": "43000",
                    "WorktagFundId": "F1000",
                    "WorktagRevenueCategoryId": "RC0052",
                    "WorktagCustomOrgReferenceId": "FX003"
                },
                {
                    "InvoiceTypeIds": [
                        70,
                        96
                    ],
                    "CommerceMidGroupingName": "POLICE",
                    "LedgerAccountReferenceId": "43000",
                    "WorktagFundId": "F1000",
                    "WorktagRevenueCategoryId": "RC0191",
                    "WorktagCustomOrgReferenceId": "FX003"
                },
                {
                    "InvoiceTypeIds": [
                        95
                    ],
                    "CommerceMidGroupingName": "CLERK",
                    "LedgerAccountReferenceId": "43000",
                    "WorktagFundId": "F1000",
                    "WorktagRevenueCategoryId": "RC0189",
                    "WorktagCustomOrgReferenceId": "FX001"
                }
            ]
        }
    },
    "InvoiceOnDemand": {
        "Integration": "CitizenServe"
    }
}
Integration Modifications
Jira INT
Date Released
Previous Behavior
Desired Behavior
Business Case / Solution
ITG-2551
New Request for 2249-The City of Peoria, Arizona
05/30/2024
Export payment report did not include invoice type 188
Include invoice type 188 on export
Biller will test new export and when verified, enable invoice 188 in production.
ITG-2667
City of Peoria Custom Payment File - Additional needs requested
07/02/2024
Export file for invoice type 188 had incorrect journal_ID as it was duplicated and must be unique.  In addition, the 4th journal entry has the incorrect DeptID, Fund Code, Class_fld, and Program_code.
Ensure that Journal_ID is unique and correct journal entries to have the proper accounts.
Biller will test new export and when verified, enable invoice 188 in production.
ITG-3339
New Request for 2249-The City of Peoria, Arizona
TBD
Export payment report did not include invoice type ids 39 Police Fees (LeadsOnline), 95 City Records (GovQA), and 96 Police Records (GovQA).
Include invoice type ids 39, 95, and 96.
Biller will test new export on BID 2290 and when verified, enable invoice type ids 39, 95, 96 in production.
ITG-3478
New Request for 2249-The City of Peoria, Arizona
TBD
Export payment report did not include invoice type ids 65.
Include invoice type id 65.
Biller will test new export on BID 2290 and when verified, enable invoice type id 65 in production.
ITG-3581
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
 
INT-14147
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
 
TBD
Export file needs to include invoice type ID 70.
Include invoice type ID 70
Biller will test new export on BID 2290 and when verified, enable invoice type id 70
ITG-3581
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
  in production.
 URL:/spaces/IM/pages/2456027137/BID+2249+City+of+Peoria+AZ