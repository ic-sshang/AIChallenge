none
Objective:- Add Email History Features to Dropdown menu in the Customer Email History Section of the Biller Portal.
PULSE-153
As a biller, I want to view the customer‚Äôs email history for the expiring credit card notifications, as well as the ability to export this to Excel so that I can more easily research this type of issue to avoid water shut offs.
Expiring Credit Card Notification 
Adding the ‚Äúexpiring credit card notification‚Äù emails to the Email History tab of the Customer Profile.
Adding an Excel export feature to allow exporting it.
Findings
Storage Locations: - 
Fetching emails from
 
spCustomersWithExpiringCardsBillerPortal
 stored Procedure.
Frontend Components: - 
This will require changes
 
in 
ctrlCustomerEmailHistory.ascx.vb
 
file to add the ‚ÄúExpiring Card Notification‚Äù to dropdown
Backend Components
: -This will require following files to be altered
CustomerEmailHistory.vb
 (adding Enum as CreditCardExiprationEmai)
CustomerEmailHistoryService.vb
 
(works as repository to fetch data from sp)
Export To Excel
 Adding
 ‚ÄúExport to Excel‚Äù
 Feature for ‚ÄúCredit Card Expiration‚Äù Notification
As we are 
fetching Table details from BillerInvoices in a similar way
 we need to add excel export feature to ‚ÄúCredit Card Expiration‚Äù Notification. 
Taking reference
 from 
BillerInvoice.aspx.vb
 
having 
btnExportToExcel_Click
 as a 
parameterized constructor.
Using 
GridTableView
 
file for taking data from Frontend Table and exporting it to excel
Pulse-154
As a biller, I want to see a complete history of all invoice and account-related notifications sent to my customers, so that I can better understand their account activities and provide improved customer service.
Late Fee Notification Under Invoice Notification History
Provided the Biller is Logged in, when he/she goes to Email History ‚Üí dropdown ‚Üí ‚ÄúInvoice Notification History‚Äù, the biller should be able to see the data of "Late Fee Notification" under this.
Backend Components: - Updating 
CustomerEmailHistoryService.vb
 and executing SP 
‚ÄúrptEmailHistoryLateFees‚Äù.
Possible Approaches: -
We can change the SP of Invoice Notification History and by using JOINS we can fetch data from the table from which SP of Late Fee Notification is fetching.
Do changes in the existing MYIIS code and write a function to return data from both the Stored Procedures. 
Make a separate SP that is fetching data for both ‚ÄúInvoiceNotificationHistory‚Äù & also for ‚ÄúLateFeeNotification‚Äù
Which is Better 1 or 2 or 3 ü§î?
Approach 3 is better as if we do changes in SP then it might have dependencies on their repos also which may obstruct the existing functionality. So, taking 
Approach-3 is better. 
As we
 
need 
custom logic, optimized performance, or a unified output format.
Why Approach 3??
For ‚ÄúInvoiceNotification History‚Äù the SP is using 
EMAILTRACKING
, 
tblEmailNotificationType
, 
EMAILBLOCKED
, 
Customers, Invoices
 
For ‚ÄúLateFeeNotification‚Äù the SP is using 
EMAILQUEUE
, 
Customers, Invoices
 Tables.
Createing a New Stored Procedure
This is 
better than combining at code level
 for the following reasons:
1. 
Performance Optimization
A single SP can use 
efficient joins
, 
filters
, and 
indexes
.
Avoids multiple round-trips to the database (which async helps with, but still adds overhead).
2. 
Unified Logic
We can customize the logic as per UI format of the Business Requirements.
Easier to apply business rules (e.g., filtering by notification type, date range, customer status).
3. 
Maintainability
One SP is easier to debug and optimize than two separate ones being merged in code.
Future changes (e.g., adding new columns or filters) can be done in one place.
Removing Late Fee Notification from Dropdown
Removing Late Fee Notification from the Dropdown in the Email History Section (should no longer be visible).
Frontend Components: - Remove Late Fee Notification (ctrlCustomerEmailHistory.ascx.vb).
Backend Components: - Removing from ‚ÄúLate Fee Notification‚Äù from PopulateDropdown in 
ctrlCustomerEmailNotification.ascx.vb 
 &  from
 CustomerEmailHistoryType.
PUL-198
Consolidated Payment Transaction Receipt
Adding "
Consolidated Payment Transaction Receipt
" to the "Payment Receipts".
Backend Components: - Using 
AddCloudPaymentConsolidatedQueue
 from
 PaymentRepository.vb 
to catch the data and present it.
Need to write a Combined function for ‚ÄúPayment Receipts‚Äù & ‚ÄúConsolidated Payment Transaction Receipts‚Äù so as to fetch both the data simultaneously. and call it in 
CustomerEmailHistoryService.vb
PUL-197
Account Management Notification
Creating a new dropdown category called 
"Account Management Notifications"
 with the columns:
Date Sent
Type
Sent To
Account #
Frontend Components: - Add "Account Management Notification" to 
ctrlCustomerEmailHistory.ascx.vb 
 . Populate Data in 
EmailHistoryGrids
 in the same Frontend Component. Declare the above-mentioned Columns in the frontend file 
ctrlCustomerEmailHistpry.ascx.
Account Status & notification emails to Account Management Notifications
Move the specified account status and notification emails to the new "Account Management Notifications" dropdown category.
Registered Customer Welcome Email
Multiple Registered Customers Welcome Email
Account Deactivation Notification
Password Reset Email
Payment Method Block Notification
AutoPay Registration Completed Notification
AutoPay Registration Notification
AutoPay Off Confirmation
AutoPay with Paperless Registration Completed
Paperless Registration Completed Notification
Paperless Registration Notification
Paperless Off Confirmation
Recurring Scheduled Payment Canceled
Recurring Scheduled Payment Confirmation
Flexpay Auto Enrollment
Flexpay Confirmation Notification
Backend Components: - 1. Add 
"Account Management Notification"
 to CustomerEmailHistoryType as Enum.
2. We are supposed to create a 
new Stored Procedure
 to fetch the above-mentioned types of email notifications.
Each type of mail notifications mentioned above are mapped to a particular EmailQueueTypeID which has EmailQueueTypeDesc and they are available in 
tblEmailQueueType
.
For these 4 tables are required 
EmailQueue
, 
tblEmailQueueType
, 
Customers
.Also the screenshot is attached for reference.
Conclusion
This particular document talks about the changes that are to be made in Email History of a Customer in Biller Portal. It includes stored procedures, Frontend Files & Backend Files as well for reference.
 URL:/spaces/PE/pages/4552130791/Pulse-171+Spike+Includes+Pul-153+Pul-154+PUL-197+PUL-198