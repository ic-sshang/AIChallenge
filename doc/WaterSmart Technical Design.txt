Fill in project details in the table below. Type /date to quickly add the target release date, /jira to link to Jira epics or issues, and @mention functional owners to keep everyone on the same page.
Page Navigation:
Jira ticket 
n/a
ITR
15512
Document status
COMPLETE
Green
Document owner
 
Solution engineer
 
Salesforce SOW
Link to SOW
Knowledge Transfer
Gong Link
File Mapping
Invoice File
File Extension: .csv
File Naming Convention: N/A
File Delimiter: Comma
Specification: N/A
Sample File: 
*File contains generic data that can be used to submit a coding ITR for any WaterSmart biller. To use the above file for IT coding, please validate the invoicetypeID (and possibly the invoicedate and invoicedudate for current invoices)
File Transfer Frequency: Daily
Field Mapping
IC FileSpecID
IC Field
In File (Y/N)
Required (T/F)
Partner Field Name
Partner Field Format
Partner Field Description
Partner Field Character Limit
Record Type
1
RowType
N
TRUE
N/A- Generated by IC- Always FH
File Header
2
BillerGuid
N
TRUE
N/A- Generated by IC
File Header
4
FileCreationDate
N
TRUE
N/A- Generated by IC
File Header
5
InvoiceCount
N
TRUE
N/A- Generated by IC
File Header
6
TotalInvoiceAmount
N
TRUE
N/A- Generated by IC
File Header
7
RowType
N
TRUE
N/A- Generated by IC- Always IH
Invoice Header
8
RecordType
N
TRUE
N/A- Generated by IC- Always N
Invoice Header
9
InvoiceFormatGuid
N
TRUE
N/A- Generated by IC
Invoice Header
10
InvoiceNumber
Y/N
TRUE
InvoiceNumber
Numeric
If blank in file, please use AccountNumber-invoicedate
Position12
Invoice Header
11
InvoiceDate
Y
TRUE
InvoiceDate
DateTime
If WaterSmart does not have a true invoice date, the due date will be passed as the invoice date
Position8
Invoice Header
12
InvoiceDueDate
Y
TRUE
InvocieDueDate
DateTime
Position9
Invoice Header
13
TotalAmountDue
Y
TRUE
TotalAmountDue
Currency
Position 10
Invoice Header
252
InvoiceTypeID
Y
TRUE
InvoiceTypeID
Numeric
1
IC IM must setup Invoice Type ID =1 for WaterSmart integrations
Position 13
Invoice Header
407
PastDue
Y
FALSE
PastDue
Currency
Position 11
Invoice Header
58
RowType
N
TRUE
N/A- Generated by IC- Always CR
Customer Record
59
AccountNumber
Y
TRUE
AccountNumber
Numeric
Position 1
Customer Record
60
CustomerName
Y
TRUE
CustomerName
VarChar
Position 2
Customer Record
61
Address1
Y
FALSE
Address1
VarChar
Position 3
Customer Record
62
Address2
Y
FALSE
Address2
VarChar
Position 4
Customer Record
63
City
Y
FALSE
City
VarChar
Position 5
Customer Record
64
State
Y
FALSE
State
VarChar
Position 6
Customer Record
65
Zip
Y
FALSE
Zip
Numeric
Position 7
Customer Record
356
BlockPaymentsCC
Y
FALSE
BlockPaymentsCC
1 = Yes, 0 = No
Position 14
Customer Record
357
BlockPaymentsEFT
Y
FALSE
BlockPaymentsEFT
1 = Yes, 0 = No
Position 15
Customer Record
373
DisplayAccountNumber
Y
FALSE
DisplayAccountNumer
Numeric
May or may not have a value. Should work eithe rway.
Position 16
Customer Record
70
RowType
N
TRUE
N/A- Generated by IC- Always ID
Invoice Detail
Adjustment/Daily Balance File
File Extension: .csv
File Naming Convention: N/A
File Delimiter: Comma
Specification: N/A
Sample File: 
*File contains generic data that can be used to submit a coding ITR for any WaterSmart biller
File Transfer Frequency: Daily
Notes: Customer Name and Past Due are not currently part of the adjustment file process, so the values are ignored. 
Field Mapping
IC FileSpecID
IC Field Name
In File (Y/N)
Required (T/F)
Partner Field Name
Partner Field Format
Partner Field Description
Partner Field Character Limit
Record Type
305
RowType
N
TRUE
N/A- Generated by IC- Always AH
File Header
306
BillerGuid
N
TRUE
N/A- Generated by IC
File Header
308
FileCreationDate
N
TRUE
N/A- Generated by IC
File Header
309
AdjustmentCount
N
TRUE
N/A- Generated by IC
File Header
310
TotalAdjustmentAmount
N
TRUE
N/A- Generated by IC
File Header
311
RowType
N
TRUE
N/A- Generated by IC
Adjustment Record
313
AccountNumber
Y
TRUE
AccountNumber
Numeric
Position 1
Adjustment Record
314
AdjustmentAmount
Y
TRUE
Adjustment Amount
Currency
Position3
Adjustment Record
316
AdjustmentTypeID
Y
TRUE
AdjustmentTypeID
Numeric
Position 4
Adjustment Record
Customer Name
Y
CustomerName
Varchar
Position 2
PastDue
Y
PastDue
Currency
Position 5
Payment/Lockbox File
File Extension: .csv
File Naming Convention: ICPayments_YYYYMMDDHHMMSS.csv
File Delimiter: Comma
Specification: 
Sample File:
File Transfer Frequency: Daily
NOTES:
If there are fields in the file that have commas, they will be removed (Example: “Smith, Joseph A.” will be passed as “Smith Joseph A.” so that the commas are used only to separate field values)
Billers have the option to have the payment file split into 3 files, one for CC (no Amex), Amex only, ACH:
ICPayments_AMEX_YYYYMMDDhhmmss.csv
ICPayments_CC_YYYYMMDDhhmmss.csv
ICPayments_Bank_YYYYMMDDhhmmss.csv
Field Mapping
Field
Data Type
Format
Values
InvoiceNumber
Numeric
 InvoiceNumber
InvoiceGUID
Varchar
Randomly generated ID associated with the invoice
AccountNumber
Numeric
AccountNumber
CustomerName
Varchar
CustomerName
PaymentGUID
Varchar
Randomly generated ID associated with the payment
PaymentDate
DateTime
MMDDYYYYHHMMSS
Converted to biller's time zone
PaymentTypeID
Numeric
1 is CC and 2 is ACH
PaymentTypeDesc
Varchar
Write out of the payment type
PaymentAmount
Currency
Amount of payment
ConvenienceFee
Currency
Amount of convenience fee (if applicable)
PaymentReference
Varchar
Randomly generated ID in case the payment needs to be tracked for any reason
PaymentMessage
Varchar
The response from the payment processor
Approved
Varchar
True/False if the transaction was approved or declined
BillerReference
Varchar
Input made by the biller upon payment submission
Offline
Varchar
Offline payments can be entered to update the account balance but not processed through IC
LocationReference
Varchar
Used for branding – generally n/a
WSReportID
Numeric
Used by IC in the settled batch records to track if the payments have been exported
CheckNumber
Numeric
Optional check number provided by the customer/payer at the time of payment via a CSR in the biller portal
Change Log File
File Extension: .csv
File Naming Convention: ICChangeLog_YYYYMMDDHHMMSS.csv
File Delimiter: Comma
Specification: 
Sample File: 
File Transfer Frequency: Daily
Field Mapping
Field
Data Type
Character Limits
Format
Values
Account Number
Varchar 
30 
Account Number from IC database
AutoPay Sign Up Date
Datetime
MMDDYYYYHHMMSS
Date customer completed enrollment in AutoPay
AutoPay Cancel Date
Datetime
MMDDYYYYHHMMSS
Date customer completed un - enrollment in AutoPay
Email Address
Varchar
100
Customer email address
Email Address change date
Datetime
MMDDYYYYHHMMSS
Date email address was change on IC
Phone Number
Varchar 
15
Phone number of the customer
Phone Number change date
Datetime
MMDDYYYYHHMMSS
Date phone number was changed on IC
Paperless Sign Up Date
Datetime
MMDDYYYYHHMMSS
Date customer completed enrollment in paperless
Paperless Cancel Date
Datetime
MMDDYYYYHHMMSS
Date customer un-enrolled in paperless
ACH Rejects File
File Extension: .csv
File Naming Convention: ICRejects_YYYYMMDDHHMMSS.csv
File Delimiter: Comma
Specification: 
Sample File: 
File Transfer Frequency: Daily
If there are fields in the file that have commas, they will be removed (Example: “Smith, Joseph A.” will be passed as “Smith Joseph A.” so that the commas are used only to separate field values)
Field Mapping
Field
Data Type
Values
Transaction Date
Datetime
Date of original transaction
Reject Date
Datetime
Date reject was received
Account Number
Varchar
Account Number in Invoice Cloud
Customer Name
Varchar
Customer Name in Invoice Cloud
Invoice Number
Varchar
Invoice Number in Invoice Cloud
Invoice Type
Varchar
Varies based on integration
Amount
Currency
Amount of reject
Code
Varchar
Reject Code from Banking Institution
Auth Order Number
VarChar
Original Authorization Order received from processor
Reference Number
Varchar
Reference number from processor
Biller Reference
Varchar
Optional field only entered on manual payments through Invoice Cloud’s Biller Portal
Advanced Settings
EBPP Integration
Setting ID
Description
Details and Logic
Value
Is value unique per biller? (Y/N)
 29
RemoteAuthenticationWS - Create Customer
 
1
N
 
 
 
 
 
BIF Customization's
Feature
BIF CUSTOMIZATIONS
AchServiceFee
N/A
AllowPartialPayments
On Biller Questionnaire
AutoPayCollectionDate
On Biller Questionnaire
BalanceForward
Required - On Biller Questionnaire
CreditCardServiceFee
N/A
FirstNotifyRequestedDate
On Biller Questionnaire
InvoiceDate
in invoice file
InvoiceDueDate
in invoice file
InvoiceFormatGuid
N/A
InvoiceTypeID
in invoice file
LateFeeDate
N/A
LocationReference
N/A
MinimumAmountDue
On Biller Questionnaire
PaymentExpirationDate
On Biller Questionnaire
PaymentExpirationMessage
On Biller Questionnaire
PromptPayExpirationDate
N/A
RegistrationValue
N/A
SecondNotifyRequestedDate
On Biller Questionnaire
ThirdNotifyRequestedDate
On Biller Questionnaire
User Interaction and Design
Data Flow - Invoice
att457506855
418545918
1
WaterSmart Invoice File Flow
IM
att457474082
att457474077
0
Data Flow - Adjustments
att455704615
418545918
1
Watersmart Adjustments
IM
att454983710
att457572391
0
Data Flow - Payment
att457375871
418545918
1
lockbox
IM
att455082088
att455704678
0
Data Flow - ACH Reject
att529399809
418545918
1
ACH Rejects
IM
att529039419
att529006609
0
Data Flow - Change Log
att529072134
418545918
1
WaterSmart Change Logs
IM
att529006614
att529399816
0
Payer Experience
The WaterSmart portal has IC screens embedded for the SSO integration. Below is a walk through of a payment in the customer portal as well as menu navigation to IC screens:
Paperless signup
Pay By Text
Scheduled Payments
Stored Payment Methods
AutoPay
Biller Experience
Billers will use the standard IC biller portal for account management.
Invoice Cloud Web Services
Web Service Name
Purpose
KeepRemoteSessionAlive
Called every time user navigates onto/between pages in their billing panel - InvoiceCloudSession.php
SetInvoiceBalance
Called when the "Renew User" button is clicked, only in IC demo (resets the invoice balance for demo use)
RemoteAuthentication
Called when user signs into WS, also when user registers via the WS registration flow (if they are using the same email/password combination as they did in IC, we simply allow them to authenticate in IC without needing to re-register them in IC)
Customer Portal Redirects:
2 = Customer Portal Paperless Settings
3 = Customer Portal AutoPay Settings
5 = Customer Portal Payment Options
8 = Customer Portal Open Bill Listing
9 = Customer Portal Scheduled Payments Listing
11 = Customer Portal Pay By Text Enrollment
RemoteRegistration
Called upon login when user is registered in WS but not authenticated successfully in IC, when the user registers via the WS registration flow, and when the user changes their password
UnregisterAccounts
Called when account is removed in account preferences page or when account is reset by utility staff on the dashboard customer details page
LinkCustomerAccount
Called when account is added in account preferences page, when a user registers the same email/pw combination for a new account in WS, or when a utility has configured a flag to sync account linking upon login in IC to the account linking in WS (newly deployed change that is mostly only for utilities push us account linking updates via file loads that they do not push to IC)
SetCustomerEmailAddress
Called when user changes their email in the account preferences page or when the email is changed by utility staff on the dashboard customer details page
REST API Retrieve CustomerGUID and Retrieve Customer Account
Called in the WS authentication process to find the account associated with a successful IC authentication so that we know what account to link or register from an IC auth token
 URL:/spaces/IM/pages/418545918/WaterSmart+Technical+Design