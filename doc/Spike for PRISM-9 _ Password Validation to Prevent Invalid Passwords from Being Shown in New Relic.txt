Objective
The objective of this spike is to enhance password validation mechanisms and implement measures to prevent invalid passwords from being logged in New Relic. This will ensure that passwords meet stricter validation criteria and improve the security of the application by avoiding the exposure of sensitive information in logs.
The updated password validation should match the criteria shown in the screenshot below in the customer portal.
Update Regex in 
bindInputValidation
 for Password Validation
File
: 
ic-client-validation-ADA.js
Change
: Update the regex pattern to restrict allowed special characters for password validation.
Old Regex
:
var regex = new RegExp("^[a-zA-Z0-9-,.!@&$;+:`’‘<>=~}{|?$#^%*()\\\\[\\]\\/\\_\\s']{" + min_length + "," + max_length + "}$");

New Regex
:
var regex = new RegExp("^[a-zA-Z0-9@#$%^&+=!]{" + min_length + "," + max_length + "}$");

Explanation
: The new regex pattern allows alphanumeric characters and the special characters 
@#$%^&+=!
as per the password guidelines, which has mentioned on the above screenshots
2. Add
ValidateRequest="false"
 in 
BillerLogin.aspx
File
: 
BillerLogin.aspx
Change
: Add 
ValidateRequest="false"
 to the 
@Page
 directive.
Code
:
<%@ Page Language="vb" AutoEventWireup="false" CodeBehind="BillerLogin.aspx.vb" Inherits="YourNamespace.BillerLogin" ValidateRequest="false" %>
Explanation
: This change will suppress the default form validation and allow us to use the custom validation going to be implemented (refer point 3).
3. Introduce 
isValidPasswordEntry
 in 
clsValidation.vb
File
: 
clsValidation.vb
Change
: Add the 
isValidPasswordEntry
 method with a new regex pattern for password validation.
Code
:
Public Shared Function isValidPasswordEntry(ByVal DataToValidate As String, ByVal MinimumLength As Integer, ByVal MaximumLength As Integer) As Boolean
    Try
        Dim pattern As String = "^[a-zA-Z0-9@#$%^&+=!]{" & MinimumLength.ToString & "," & MaximumLength.ToString & "}$"
        Dim myregex As New Regex(pattern)
        Return myregex.IsMatch(DataToValidate.Trim)
    Catch ex As Exception
        Return False
    End Try
End Function
Explanation
: The new method 
isValidPasswordEntry
 enforces stricter criteria for password validation.
4. Change Password Validation Method in 
BillerLogin.aspx.vb
File
: 
BillerLogin.aspx.vb
Change
: Update the password validation method to use 
isValidPasswordEntry
 instead of 
isValidTextEntry
.
Old Code
:
If clsValidation.isValidTextEntry(Me.txtCurrentPassword.Text, 1, 20) = False Then
New Code
:
If clsValidation.isValidPasswordEntry(Me.txtCurrentPassword.Text, 8, 20) = False Then
Explanation
: The new regex pattern ensures that the entered passwords comply with length and character requirements.
 URL:/spaces/PE/pages/4027842601/Spike+for+PRISM-9+Password+Validation+to+Prevent+Invalid+Passwords+from+Being+Shown+in+New+Relic