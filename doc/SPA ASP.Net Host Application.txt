*** BETA: USING THE PAYER PORTAL AND MICRO UIs TO OPERATIONALIZE THE DOTNET HOST IMAGE ***
A React SPA will use a 
ASP.Net
 MVC application to render the index HTML page and serve the static content (CSS, Image, JS, etc..) required for the application.  A docker image, 
reacthost:0.1.1-EBPP-12218.1
, of the .Net host application is used in multistage docker files as a layer.  SPA multistage docker files will use a node.js SDK image to build the javascript assets.  The node.js SDK image will use npm to install and build the target React application assets.  The npm build output are copied into the .Net host application image layer as the final image.  The .Net host application image’s DLL, 
ReactHost.WebApp.dll
, is used as the entry point.  The .Net host application will dynamically create and serve a JavaScript configuration file, config.js, containing all the environment variables starting with “REACT_APP_”.
.Net Image Layer Entry Point
/app/ReactHost.WebApp.dll
.Net Image Layer Static Content Folder (copy React build assets into this folder)
/app/wwwroot
.Net application SPA index HTML page URL relative to the application root
/home/index
.Net application JavaScript configuration URL relative to the application root
/js/config.js
Docker
 Dockerfile Example
# helpful link on using private nuget feed in build process - http://mikehadlow.blogspot.com/2020/08/restoring-from-azure-artifacts-nuget.html
ARG NUGET_USERNAME
ARG NUGET_PAT
ARG IC_ACR


#react application build
FROM node:latest as react

WORKDIR /PayerPortal.Host.UI/
COPY PayerPortal.Host.UI .
RUN npm install \
    && npm run build

#final image, dontnet web application for hosting react
FROM {$IC_ACR}/reacthost:latest as final

WORKDIR /app

#copy react assets into the dontnet web application's wwwroot
COPY --from=react /PayerPortal.Host.UI/build ./wwwroot

#create non root user
RUN addgroup --group www --gid 2000 \
	&& adduser \
	--uid 1000 \
	--gid 2000 \
	"webapp"

#apply user permissions
RUN chown webapp:www /app
USER webapp:www

#run the dontnet web application
ENTRYPOINT ["dotnet", "ReactHost.WebApp.dll"]
Environment Variables
The .Net host application uses environment variables to configure what JavaScript and CSS files need to be rendered in the index HTML header as well as the base path of where the application root is in relation to being proxied. 
Name
Description (Usage)
CSS_LIST
Comma separate list of either relative or fully qualified URLs to CSS files.  This list is rendered in the index HTML for the SPA. Optional.
JS_LIST
Comma separate list of either relative or fully qualified URLs to JS files.  This list is rendered in the index HTML for the SPA. Required for SPAs.
BASE_PATH
The absolute URL of the application root.  This is used to express any upstream proxy routing when rendering links in the HTML for the SPA. Required for SPAs.
TITLE
This is the page title of the SPA. Optional.
FAV_ICON
This is the relative or fully qualified URL to the favorite icon.  This is rendered in the index HTML for the SPA.  Optional.
REACT_APP_*
All variables starting with REACT_APP_ are rendered in the SPA configuration JavaScript file /js/config.js.  If the SPA has configurations that change per environment these variables should be used.
JavaScript Configuration
Environment variables starting with “REACT_APP_” will be rendered in the .Net host application’s “/js/config.js” file.  This JavaScript will set the values in on the global window object for use in other scripts.
Example
Environment Variable
REACT_APP_MYIIS_URL=
https://www.invoicecloud.com/portal
“/js/config.js”
window.invoiceCloud = {
  configuration: {
    "REACT_APP_MYIIS_URL": "https://www.invoicecloud.com/portal"
  }
};
Index HTML markup rendered by the .Net host application
2
1
0
0
2899738763
2703360189
1
Untitled Diagram-1700179167198.drawio
2
2
https://invoicecloud.atlassian.net/wiki
Untitled Diagram-1700179167198.drawio
0
2404
697
 URL:/spaces/EN/pages/2703360189/SPA+ASP.Net+Host+Application