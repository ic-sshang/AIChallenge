Overview
This document explains how to use the reusable popup user control (MyPopup.ascx) in an ASP.NET    Web Forms (VB.NET  ) parent page. It describes how to add the control to your page, available properties and methods, events, examples for dynamic form fields and best practices
Files included in the control (recommended)
ReusablePopup.ascx — markup for the popup (header, body placeholder, footer buttons). • ReusablePopup.ascx.vb — code-behind with properties, methods, events and dynamic control reconstruction logic. 
Step-by-step Usage
Add the control files to your project under Controls/ (e.g., ~/Controls/ReusablePopup.ascx and ReusablePopup.ascx.vb). 
Ensure the top of MyPopup.ascx contains the correct Inherits and CodeBehind attributes and the code-behind class namespace matches. 
Register the control on your page using the Register directive: <%@ Register Src="~/Controls/ReusablePopup.ascx" TagPrefix="uc" TagName="ReusablePopup" %>. 
Place the control inside a Content block (if using a Master Page) or inside for non-master pages: 
In the parent page code-behind wire event handlers and set properties before calling Show ().
Important: Master Page / Content Pages 
If your site uses a Master Page, ensure the control is placed inside an control that targets a ContentPlaceHolder in the master page. Do not put page-level HTML outside Content tags in content pages.
Public Methods (what you can call from parent page)
 
Show() — Display the popup. Example: MyPopup.Show()
Hide() — Hide the popup. Example: MyPopup.Hide() 
SetBodyContent(controls As List(Of Control)) — Adds a list of dynamically created server controls to the popup body and stores descriptors in ViewState so they persist across postbacks.
AddBodyControl(ctrl As Control) — Alternative: add single control at a time; the control will be persisted via descriptor list. 
FindControlInBody(id As String) As Control — Helper to find a control inside the popup body (if exposed).
Public Properties (configurable from parent page)
TitleText — String — title displayed in popup header. 
PrimaryButtonText — String — label for primary button. 
SecondaryButtonText — String — label for secondary button. 
ShowPrimaryButton — Boolean — whether the primary button is visible. 
ShowSecondaryButton — Boolean — whether the secondary button is visible.
ButtonAlign — Enum (Left, Center, Right) — sets alignment of footer buttons. (Optional) 
Events
The control exposes server-side events the parent page should handle: 
PrimaryButtonClick — Raised when primary button is clicked. Use to collect values and submit to backend. 
SecondaryButtonClick — Raised when secondary (Cancel) button is clicked.
Common Usage Patterns and Examples
A) 
Simple static content example 
<%@ Register Src="~/Controls/MyPopup.ascx" TagPrefix="uc" TagName="MyPopup" %> 
<uc:MyPopup ID="MyPopup" runat="server" />
Code-behind (VB): 
Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load 
     AddHandler MyPopup.PrimaryButtonClick, AddressOf MyPopup_PrimaryButtonClick 
     AddHandler MyPopup.SecondaryButtonClick, AddressOf MyPopup_SecondaryButtonClick 
End Sub 
Protected Sub btnOpen_Click(sender As Object, e As EventArgs) 
    MyPopup.TitleText = "Save Prompt" MyPopup.SetBodyContent(New List(Of Control) From { New LiteralControl("Are you sure?") }) 
    MyPopup.PrimaryButtonText = "Save" 
    MyPopup.SecondaryButtonText = "Cancel" 
    MyPopup.Show() 
End Sub
B)
 Dynamic form controls (recommended approach) — Add multiple controls
and persist across postbacks
' Create controls and add to popup
Dim controls As New List(Of Control)
controls.Add(New LiteralControl("<label>Name:</label>"))
controls.Add(New TextBox() With {.ID = "txtName"})
controls.Add(New LiteralControl("<br/>"))
controls.Add(New LiteralControl("<label>Email:</label>"))
controls.Add(New TextBox() With {.ID = "txtEmail"})
MyPopup.SetBodyContent(controls)
MyPopup.TitleText = "User Details"
MyPopup.PrimaryButtonText = "Save"
MyPopup.SecondaryButtonText = "Cancel"
MyPopup.Show()
' Handle the primary click and read values (controls recreated from descriptor in OnInit)
Protected Sub MyPopup_PrimaryButtonClick(sender As Object, e As EventArgs) Handles MyPopup.PrimaryButtonC 
    Dim txtName As TextBox = CType(MyPopup.FindControl("txtName"), TextBox)
    Dim txtEmail As TextBox = CType(MyPopup.FindControl("txtEmail"), TextBox)
    Dim nameValue = If(txtName IsNot Nothing, txtName.Text, "")
    Dim emailValue = If(txtEmail IsNot Nothing, txtEmail.Text, "")
 ' Process values...
End Sub
C) 
Primary-only button example ' 
Configure popup to show only primary button aligned center 
MyPopup.ShowSecondaryButton = False 
MyPopup.ShowPrimaryButton = True 
MyPopup.ButtonAlign = MyPopup.ButtonAlignment.Center 
MyPopup.PrimaryButtonText = "Next" 
MyPopup.SetBodyContent(...) 
MyPopup.Show()
Implementation details (how persistence works)
When you call SetBodyContent(controls), the control stores a descriptor (Type, ID and common properties) for each control in ViewState. On each subsequent postback the popup's OnInit reads the descriptors and recreates the server controls with the same IDs so ASP.NET can restore their ViewState and posted values automatically.
Final notes 
This control pattern keeps your pages clean and centralizes popup behavior. Use the descriptor approach for dynamic controls to preserve state. If you prefer to return values directly via custom EventArgs, the popup can be updated to raise PrimaryButtonClick with a typed argument containing field values.
 URL:/spaces/PE/pages/4567466021/Draft+Reusable+Popup+User+Control+-+Usage+Guide+VB.NET+WebForms