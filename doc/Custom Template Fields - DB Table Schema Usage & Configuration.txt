Overview
The 
CustomTemplateFields
 table is designed to store customizable fields for invoice templates. This allows for dynamic updates to template fields without requiring code changes, enabling quick and easy modifications through a user interface.
SPIKE: 
[INT-13298] [SPIKE] - Template configuration schema - JIRA
Table Schema
Table Name:
 
CustomTemplateFields
Column Name
Data Type
Description
FieldID
INT
Primary key, auto-incremented.
InvoiceFormatID
INT
Identifier for the invoice format.
BillerID
INT
Identifier for the biller.
FieldName
NVARCHAR(255)
Name of the field (e.g., CompanyName, CompanyEmail).
FieldValue
NVARCHAR(MAX)
Value of the field.
FieldType
NVARCHAR(50)
Type of the field (e.g., String, Int).
StartDate
DATE
Start date for the field's validity.
DateRecAdded
DATE
Date the field was created.
Active
BIT
Indicates if the field is active (1) or inactive (0).
CustomTemplateSourceID
INT
Indicates what source we’re going to be pulling the custom value from. Here is a list of current sources: 
1 - Field Value
2 - Invoice
3 - InvoiceDetail
4 - Customer
5 - Biller
6 - Adjustment
7 - Payment
8 - TemplateCustomization
Rationale for Schema Design
Flexibility
: The schema allows for various types of fields to be added dynamically, supporting different data types and values.
Ease of Updates
: By storing field values in the database, updates can be made through a user interface without requiring code changes or redeployments.
Version Control
: The 
StartDate
 and 
CreationDate
 fields help track when fields were added or became valid, aiding in version control and auditing.
Activation Control
: The 
IsActive
 field allows for fields to be enabled or disabled without deletion, providing flexibility in managing active fields.
Interaction with the Table
Adding a New Field
To add a new field, the following information is required:
InvoiceFormatID
BillerID
FieldName
FieldValue
FieldType
StartDate
The 
FieldID
 and 
CreationDate
 are auto-generated.
Updating an Existing Field
To update an existing field, the 
FieldID
 is used to identify the record. The following fields can be updated:
InvoiceFormatID
BillerID
FieldName
FieldValue
FieldType
StartDate
Example Use Case
In the .NET WebForms application, literals are used to display the field values dynamically. For example, to display the company name, a literal control is used:
wide
760
<asp:Literal ID="litCompanyName" runat="server" />
In the code-behind, the value is assigned from the 
CustomTemplateFields
 table:
wide
760
litCompanyName.Text = customFields.CompanyName;
This approach allows for easy updates to the template fields through a user interface, ensuring that changes are reflected immediately in the displayed templates.
Proof of Use Case - Displayable Invoices
For this case and ease of interacting with the data, we created a Database in Microsoft Access and created the 
CustomTemplatesFields 
 Table.
Also, we created a quick .NET Webform's application to replicate our current ICTemplates repository.
In this case, we have an interface where we can search and view invoices by 
Invoice Number 
and if we search the invoice we have as a sample, we’re going to be able to actually view and fetch the information that is coming right from our database.
The information that is highlighted on yellow is the information that is coming from the 
CustomTemplatesFields 
 Table.
Proof of Use Case - Custom Editable Template Fields
The way we can work with the data in the 
CustomTemplatesFields 
 Table can be pretty extensive and useful in many ways, but for the purpose of this research we decided to follow the quick and easiest way to interact and make the fields editable, which is making some sort of CRUD operations with it.
For this we created a 
manage templates fields page, 
In the following screenshot you will be able to view all the custom fields that we have available for our invoice:
Here you can either 
Add New Field or Edit Field
, In our case we are going to add a new field called 
PhoneNumber.
After saving the new field, we will be able to see it on our list of 
custom template fields.
To add our new field into our current template, we will modify our code for this one only time, and since we had a harcoded phone number:
We will proceed and create a literal for it and should look like this:
And in our back-end all we have to do is the following:
Add field into the model:
Add field into our assignation logic:
Assign value to the literal:
And that all we need to do, so this way we proceed to run our application once again and view the invoice to see our new field reflected into the invoice:
And that easy we can just integrate a new custom field on our template, and after having this field integrated we can proceed to modify it directly on our 
Manage template fields interface
:
And if we save the changes, we can see them reflected right away:
And if we run the template invoice once again, we will also see the change reflected in there:
This approach allows for easy updates to the template fields through a user interface, ensuring that changes are reflected immediately in the displayed templates.
Future Considerations
Migration to SQL Server
: The table structure can be easily migrated to SQL Server using the provided SQL script. This ensures consistency and scalability.
Modern Front-End Integration
: In the future, the system can be enhanced with a modern front-end framework like React. This would allow for live editing of templates, including drag-and-drop functionality for adding and arranging fields.
API Integration
: Consider creating APIs to interact with the 
CustomTemplateFields
 table, enabling integration with various front-end applications and services.
SQL Script for SQL Server
wide
760
CREATE TABLE CustomTemplateFields (
    FieldID INT IDENTITY(1,1) PRIMARY KEY,
    InvoiceFormatID INT NOT NULL,
    BillerID INT NOT NULL,
    FieldName NVARCHAR(255) NOT NULL,
    FieldValue NVARCHAR(MAX) NOT NULL,
    FieldType NVARCHAR(50) NOT NULL,
    StartDate DATE NOT NULL,
    CreationDate DATE NOT NULL,
    IsActive BIT NOT NULL DEFAULT 1
);
Conclusion
The 
CustomTemplateFields
 table provides a flexible and efficient way to manage template fields dynamically. This documentation outlines the schema, rationale, and interaction methods, ensuring that the system can be easily maintained and extended in the future.
 URL:/spaces/IM/pages/4179427335/Custom+Template+Fields+-+DB+Table+Schema+Usage+Configuration