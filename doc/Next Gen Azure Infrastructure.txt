This sections in this article along with the set of sub articles describe the Azure Infrastructure the InvoiceCloud Cloud Infrastructure team has created and manages.
Sections in this article:
1
4
false
list
false
Disaster Recovery and Resiliency Regions
Regions
To enable high-availability architectures for both infrastructure and applications, InvoiceCloud uses a region-based approach to solve for high-availability.
The current defined regions are as follows below:
Global
Abbreviation: 
glb
Used for Azure Platform-as-a-Service (PaaS) resources that are intended to be singletons within the InvoiceCloud Azure ecosystem and are PaaS resources that provide their own High-Availability feature. 
Networking for Global Resources
Global Resources get Private Endpoints to both the Primary and Secondary Network Lanes and hence the Private Endpoint terraform for these Resources is managed in the 
Hub_Infrastructure 
repo as opposed to the 
Global_Infrastructure 
repo.
Primary
Abbreviation: 
pri
Used as the Primary Region of a workload’s High-Availability redundancy strategy.
Secondary
Abbreviation: 
sec
Used as the Secondary Region of a workload’s High-Availability redundancy strategy.
Environments
Environments
To enable effective and reliable application development, testing, and release, InvoiceCloud has defined a set of environments for Infrastructure Resources as listed below in environmental chain order:
Sandbox
Abbreviation: 
sbx
Azure Resource Environment Specifier: 
-sbx
Used for the initial development of Infrastructure and CI/CD pipeline code.  All infrastructure or application changes should be first done in this environment however the developer sees fit, and then codify those changes within the Repo and test the deployment of the codified changes via a CI/CD pipeline deployment back into the Sandbox environment.  Once the codified changes have been verified in Sandbox via the CI/CD deployment, then the changes should be promoted to the DevTest environment for official Development team usage.  Any ClickOps Resources created prior to the codification should be deleted to reduce clutter in the Sandbox environment as well as minimize ongoing costs and prevent shadow application proliferation that could be utilized to penetrate other InvoiceCloud resources.
Subscription: 
Sandbox
PCI Scope: NonProd
Audience: Infrastructure and Platform Engineers
Number of Application Instances: Ephemeral Resources and Application deployment used for initial IaC and CI/CD Developement.
URL Patterns:
sbx.invoicecloud-beta.com
sbx{N}.invoicecloud-beta.com
Development
Abbreviation: 
dev
Azure Resource Environment Specifier: 
-dev
Used for the application development and testing by the Application Team.  All infrastructure in this environment should come from codified IaC and be deployed via a CI/CD deployment pipeline to help test the deployment in an effort to reduce/prevent the deployment of breaking changes to the Production environment. 
Subscription: 
Enterprise Dev/Test
PCI Scope: NonProd
Audience: Application Team and QA Team
Number of Application Instances: Many instances per application are allowed
URL Patterns:
devtest.invoicecloud.com
devtest{N}.invoicecloud.com
dev.invoicecloud-beta.com
dev{N}.invoicecloud-beta.com
Internal User Acceptance Testing
Abbreviation: 
iat
Azure Resource Environment Specifier: 
-iat
Used for testing of new Features by PSN, Product Owners, Product Stakeholders to provide feedback on whether the feature is achieving the goal.  Outcome from this testing will be either moving the Feature to QA Testing or additional development work to achieve the Business Goal.
Subscription: 
Enterprise Dev/Test
PCI Scope: NonProd
Audience: Product Owners, PSN, other InvoiceCloud Employees who desire to do early-stage testing on new features and functionality of the software.
Number of Application Instances: Only one instance per application
URL Patterns:
cert.invoicecloud.com
iat.invoicecloud-beta.com
Quality Assurance Regression Testing
Abbreviation: 
qar
Azure Resource Environment Specifier: 
-qar
Used for testing of application code that is targeted for release to ensure the application code behaves as expected and does not break other application’s that are dependent on the application code targeted for release.
Subscription: 
Enterprise Dev/Test
PCI Scope: NonProd
Audience: QE Team
Number of Application Instances: Only one instance per application
URL Patterns:
regression.invoicecloud.com
qar.invoicecloud-beta.com
External User Acceptance Testing
Abbreviation: 
xat
Azure Resource Environment Specifier: 
-xat
Used for demoing of new Features to our Customers and Partners by Product Owners, as well as, a place for Customers and Partners to try to new Features before they are released to Production.
Subscription: 
Enterprise Prod
PCI Scope: Production
Audience: Billers and Partners
Number of Application Instances: Only one instance per application
URL Patterns:
preview.invoicecloud.com
www.invoicecloud-beta.com
Production:
Abbreviation: 
prd
Azure Resource Environment Specifier pre 2024: 
 
Azure Resource Environment Specifier 2024 and beyond: 
-prd
Used for hosting applications and workloads for processing of Biller and Payer data.  Limited access to the Azure Resources requiring PIM to activate the pre-configured access for the internal users.
Subscription: 
Enterprise Prod
PCI Scope: Production
Audience: End Users of the Production Software
Number of Application Instances: Only one instance per application
URL Patterns:
www.invoicecloud.com
Deployment Version
To enable immutable infrastructure, all resources will have a number in the name to indicate the 
deployment_version
 of the workload that the resource is a part of.
Azure Resource Naming Convention
All Azure Resources will follow the naming convention outlined below:
{resource_type_abbreviation}-{region}-{workload_name}{deployment_version}-{environment}
resource_type_abbreviation
:  Should be 3 letters or less and stands for the type of Azure Resource the name is used for.
region
: The InvoiceCloud High Availability Region the Azure Resource will be deployed.  
Valid values are:
glb
: The Global InvoiceCloud High Availability Region for an Environment used for Azure Resources that have a built in High Availability feature as part of the Platform as a Service resource offering.
pri
: The Primary InvoiceCloud High Availability Region for Azure Resources that do not provide their own High Availability feature.
sec
: The Secondary InvoiceCloud High Availability Region for Azure Resources that do not provide their own High Availability feature.
workload_name
:  The name of the Application/Workload that will use the Azure Resources as Infrastructure.  The name of the Workload must be 12 characters or less to abide by Azure Resource name length constraints.
deployment_version
:  The version of the Infrastructure represented by the Azure Resources.  Used to enable the immutable infrastructure management pattern as well as blue-green Infrastructure deployments.  This is a number from 1 to 9.
environment
: The InvoiceCloud Environment the Azure Resources belongs to.
Valid Values are:
sbx
: Sandbox
dev
: Development
iat
: Internal User Acceptance Testing
qar
: Quality Assurance Regression Testing
xat
: External User Acceptance Testing
prd
: Production
NextGen Application Architecture
Application Services
Each “Application” (think Payer application and Biller application) in the InvoiceCloud NextGen Architecture is comprised of multiple Application Services.  For example the NextGen Payer Application is comprised of the following Application Services:
One Time Payment Service
Payment Route
Pay by Text
Autopay
Paperless
Each Application Service is intended to provide API Endpoints that support the functionality of Features supported by each Application Service.  
The NextGen Infrastructure for Applications is compromised of Resources from to types of providers:
Kubernetes
Azure
The Kubernetes Resources specific to each Application Service are segmented within the Application’s AKS Cluster via Namespaces, i.e. each Application Service will get its own Kubernetes Namespace within the Application’s AKS Cluster and is expected not need to access any Kubernetes Resources within the Application’s AKS Cluster outside of its own Namespace.
The Azure Resources specific to each Application Service are segmented within the Application’s Azure Subscription via Resource Groups, i.e. each Application Service will get its own Resource Group within the Application’s Azure Subscription, however the Application will be permitted to access other Azure Resources in the same Subscription that do not reside within the Application’s Resource Group.  In some cases, such as the Shared Biller Database, the Application will be permitted to access other Azure Resources that reside in Subscriptions outside the Application’s Subscription.
Each Application Service will have its own Application Service Identifier (and Short Identifier) defined which will be used in the Resource Naming Conventions to avoid Resource Naming collision within the Kubernetes and Azure ecosystems.
Application Instances 
In lower 
Environments
, such as Sandbox and DevTest, there may be multiple Instances of the same Application deployed to support Feature and Branch based development and testing on Kubernetes and Azure Resources within those Environmental Subscriptions.
The Kubernetes Resources specific to each Application Instance are segmented within the Application’s AKS Cluster via Namespaces, i.e. each Application Instance will get its own set of Kubernetes Namespaces that represent the Application Services for that Application Instance.
The Azure Resources specific to each Application Instance are segmented within the Application’s Azure Subscription via Resource Groups, i.e. each Application Instance will get its own Resource Group within the Application’s Azure Subscription that contains the Resources for each of the Application Services related to that Application Instance.
Each Application Instance will have its own Application Instance Identifier (and Short Identifier) defined which will be used in the Resource Naming Conventions to avoid Resource Naming collision within the Kubernetes and Azure ecosystems.
Network Architecture
See article 
https://invoicecloud.atlassian.net/wiki/spaces/icinfradoc/pages/2687893549/NextGen+Network#Network-Architecture
 
Network Ingress
 See article 
https://invoicecloud.atlassian.net/wiki/spaces/icinfradoc/pages/2687893549/NextGen+Network#Network-Ingress
 
Azure Infrastructure Workload Requirements Questionnaire
The following set of questions is needed to be answered when a new Azure Infrastructure Workload request is made to help the Infrastructure team fit the new Workload needs into the existing Azure Network architecture as well as design for Security and plan for Implementation.
Is this a request for new Infrastructure or updates/enhancements to existing Infrastructure.
Is there an initial idea of which Azure Resources are needed and an initial Workload Architectural design?
If it is a new Workload, which Environment(s) does the new Workload need to exist?
Sandbox
DevTest
Production
Legacy
If it is a new Workload, which Region(s) per environment should the Workload be deployed to?
Primary
Secondary
Global
Does the Workload have resources that need be accessed via the Private Network?
If yes,
Private IP Address for IaaC Resources?
Private Endpoint for PaaS Resources?
Service Endpoint for PaaS Resources?
Does the Workload need to access existing resources via the Private Network?
If yes,
Which resources need to be accessed?
What type of access is needed?
Does the workload process data, and does that data need to be processed inside the Private Network.
What is the Access Model for the internal team developing/utilizing the Workload?
What internal personas will be developing/utilizing the Workload, such as Administrators, Developers, Readers, Reviewers, QA, etc…
Will access be granted via AAD Groups or another mechanism?
Does internal access to the Resource need to go thru the Firewall for access auditing?
What is the Access Model for public users of the Workload?
What public personas will be accessing the Workload and for what purposes?
Does public access need to go thru the Firewall for access auditing?
Does public access need to go thru a VPN for additional access validation/protection?
Will public access require some type of authentication?
Application Service K8s Workload Requirements Questionnaire
Which AKS Cluster (set of AKS Clusters) will the Application be deployed?
What type of workloads will the application consist of?
UI
API
Backend Service
What is(are) the name(s) of the workload(s) along with the type of workload?
Do any of the workloads need access to existing Azure Resources? If so, please list each workload and which Azure Resource(s) the workload needs to access, and the type of access (i.e. read, write, readwrite, etc…).
 URL:/spaces/icinfradoc/pages/2479751174/Next+Gen+Azure+Infrastructure