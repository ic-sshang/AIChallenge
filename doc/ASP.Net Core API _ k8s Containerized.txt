none
Setting Up the Development Environment
Install .Net 8 SDK
Install Visual Studio Professional / Visual Studio Code
Creating a New ASP.NET Core Web API Project
Create a new code repository in Azure DevOps (use Pascal naming convention).
{YourProject}
Code repositories are now being organized by domain, check to see if your API’s domain has a ADO project (example “Biller”).  If you are not sure what domain your API falls under or the correct ADO project to use then work with your team's architect.
Use the appropriate project structure for your project’s assets, 
Solution/Project Structure
 
Typical .Net API solutions have the following projects:
{YourProjectName}.WebAPI
{YourProjectName}.Core
{YourProjectName}.Infrastructure
Tests\{YourProjectName}.UnitTests 
Visual Studio Code
Create sub folders
{YourProjectName}.WebAPI
{YourProjectName}.Core
{YourProjectName}.Infrastructure
Tests\{YourProjectName}.UnitTests
Use the 
dotnet new webapi
cli command to scaffold {YourProjectName}.WebAPI. 
Use the 
dotnet new classlib
cli command to scaffold {YourProjectName}.Core and {YourProjectName}.Infrastructure. 
Use the 
dotnet new nunit
cli command to scaffold {YourProjectName}.UnitTests.
Visual Studio
Use the ASP.Net Core Web API template
Configure your new project
Solution name: {YourProjectName}
Project name: {YourProjectName}.WebApi
Additional information
Framework: .Net 8.0
Authentication type: None
Uncheck - Configure for HTTPS
Uncheck - Enable container support
Check - Enable OpenAPI support
Uncheck - Do not use top-level statements
Check - Use controllers
Uncheck - Enlist in .Net Aspire orchestration
Add new projects to your solution using the 
Class Library
 template for the below projects.
{YourProjectName}.Core
{YourProjectName}.Infrastructure
Add new project to your solution using the 
NUnit 3 Test Project
 template for the unit test project, be sure to put it under a subfolder called 
Tests
{YourProjectName}.UnitTests
Nuget
Create a 
nuget.config
 in the root of your project folder
json
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <packageSources>
    <clear />
    <add key="nuget.org" value="https://api.nuget.org/v3/index.json" protocolVersion="3" />
    <add key="ICPackages" value="https://pkgs.dev.azure.com/invoicecloud/_packaging/ICPackages/nuget/v3/index.json" />
    <add key="ICQE" value="https://pkgs.dev.azure.com/invoicecloud/QA_Src/_packaging/QE-Framework/nuget/v3/index.json" />
    <add key="test-feed" value="https://pkgs.dev.azure.com/invoicecloud/_packaging/test-feed/nuget/v3/index.json" />
  </packageSources>
  <packageSourceCredentials>
    <ICPackages>
      <add key="Username" value="%NUGET_USERNAME%" />
      <add key="ClearTextPassword" value="%NUGET_PAT%" />
    </ICPackages>
    <ICQE>
      <add key="Username" value="%NUGET_USERNAME%" />
      <add key="ClearTextPassword" value="%NUGET_PAT%" />
    </ICQE>
    <test-feed>
      <add key="Username" value="%NUGET_USERNAME%" />
      <add key="ClearTextPassword" value="%NUGET_PAT%" />
    </test-feed>
  </packageSourceCredentials>
</configuration>
Docker
Create a 
Dockerfile
 in the root of your project folder
docker
# helpful link on using private nuget feed in build process - http://mikehadlow.blogspot.com/2020/08/restoring-from-azure-artifacts-nuget.html
ARG NUGET_USERNAME
ARG NUGET_PAT
ARG SEMVER=0.0.0.0
ARG NUGET_VERSION=0.0.0

# build layer
FROM mcr.microsoft.com/dotnet/sdk:8.0 AS build
ARG NUGET_USERNAME
ARG NUGET_PAT
ARG SEMVER
ARG NUGET_VERSION
ENV NUGET_USERNAME=${NUGET_USERNAME}
ENV NUGET_PAT=${NUGET_PAT}

WORKDIR /src
COPY ./ .
RUN dotnet restore -p:Configuration=Release  -v:n || exit 1
RUN dotnet build --no-restore -c:Release -p:Version=$SEMVER -p:NuGetVersion=$NUGET_VERSION ./YourProject.WebApi
RUN dotnet publish --no-build -o /publish -c:Release ./YourProject.WebApi

# deployed layer
FROM mcr.microsoft.com/dotnet/aspnet:8.0 AS runtime
WORKDIR /app
COPY --from=build /publish .

# create a new group and non root user
RUN addgroup --group www --gid 2000 \
	&& adduser \
	--uid 1000 \
	--gid 2000 \
	"webapp"

# apply new user ownership, run as the new user
RUN chown webapp:www /app
USER webapp:www

# run on port 8080
ENV ASPNETCORE_URLS="http://*:8080"
ENTRYPOINT ["dotnet", "YourProject.WebApi.dll"]
Build Pipeline
Create a 
.devops
 subfolder in the root your project folder, if it does not already exist.
Create a 
build.yaml
 file in the 
.devops
 folder
yaml
resources:
  repositories:
    - repository: templates
      type: git
      name: Platform/azure-pipelines-container-templates
      ref: refs/tags/platform-0/2.1.0

extends:
  template: stages/dotnet-container-build.yaml@templates
  parameters:
    projectName: YourProject
    nugetConfigPath: nuget.config
    dockerfile: Dockerfile
    imageName: yourproject-api
    registry: acrglbimages1npd.azurecr.io
    gitversionYml: .devops/gitversion.yaml
    extraBuildArgs: --build-arg NUGET_USERNAME=$(nuget_username) --build-arg NUGET_PAT=$(nuget_pat) --build-arg SEMVER="$(GitVersion.SemVer)" --build-arg NUGET_VERSION="$(GitVersion.NuGetVersion)"

variables:
  - group: Nuget Feed Reader
  - group: yourproject-dev
Create a 
gitversion.yaml
 file in the 
.devops
 folder
yaml
mode: Mainline
branches:
  master:
    prevent-increment-of-merged-branch-version: true
    regex: main
Deployment Pipeline
Create a 
.devops
 subfolder in the root your project folder (if it does not already exist, see Build Pipeline).
Create a 
deploy.yaml
 file in the 
.devops
 folder
yaml
trigger: none

parameters:
  - name: devInstance
    displayName: 'Development Instance'
    default: main
    type: string
  - name: enablePostDeploymentTests
    displayName: 'Enable Post Deployment Tests'
    type: boolean
    default: false

resources:
  repositories:
    - repository: templates
      type: git
      name: azure-pipelines-container-templates
      project: Platform
      ref: refs/tags/platform-0/2.2.2

extends:
  template: stages/helm-deploy.yaml@templates
  parameters:
    spoke: biller
    serviceName: 'biller-reporting-chat-api'
    chartName: web
    chartVersion: 1.2.0
    infrastructureVersion: 0
    gitVersionConfigFile: .devops/gitversion.yml
# use your cluster name, in this ex biller is used
    variableGroupWithNonProdAcrAccess: biller-application-dev
    enablePostDeploymentTests: ${{ parameters.enablePostDeploymentTests }}
    environments:
      dev:
        testFilter: ""
        testFilterExtension: ""
        instance: ${{ parameters.devInstance }}
        agentPool: "sbx-agents"
        testingPool: sbx-agents
# use your cluster name, in this ex biller is used
        variableGroupName: "biller-application-dev"
        subscription: "Enterprise Dev/Test"
        promoteImagesPrior: false
        acrName: acrglbimages1npd
      iat:
        testFilter: "Category=smoke"
        testFilterExtension: ""
        instance: main
        agentPool: "sbx-agents"
        testingPool: sbx-agents
# use your cluster name, in this ex biller is used
        variableGroupName: "biller-application-iat"
        subscription: "Enterprise Dev/Test"
        promoteImagesPrior: false
        acrName: acrglbimages1npd
      qar:
        testFilter: "Category=smoke"
        testFilterExtension: ""
        instance: main
        agentPool: "sbx-agents"
        testingPool: sbx-agents
# use your cluster name, in this ex biller is used
        variableGroupName: "biller-application-qar"
        subscription: "Enterprise Dev/Test"
        promoteImagesPrior: false
        acrName: acrglbimages1npd
      xat:
        testFilter: "Category=smoke"
        testFilterExtension: ""
        instance: main
        agentPool: "prd-agents"
        testingPool: prd-agents
# use your cluster name, in this ex biller is used
        variableGroupName: "biller-application-xat"
        subscription: "Enterprise Prod"
        promoteImagesPrior: true
        acrName: acrglbimages1
      prd-pri:
        testFilter: "Category=smoke"
        testFilterExtension: ""
        instance: main
        agentPool: "prd-agents"
        testingPool: prd-agents
# use your cluster name, in this ex biller is used
        variableGroupName: "biller-application-prd"
        subscription: "Enterprise Prod"
        promoteImagesPrior: false
        acrName: acrglbimages1
Helm Environment Configurations
Create a 
.helm
 subfolder in the root your project folder
Create a 
environments
 subfolder under 
.helm
Create a YAML file for each environment under 
environments
 using the following naming convention 
{env_abbrv}.yaml
dev.yaml
 (Development)
yaml
replicaCount: 2

image:
  repository: acrglbimages1npd.azurecr.io/yourproject-api

ports:
  - name: http
    port: 80
    protocol: TCP
    targetPort: 8080

extraEnvVars:
  - name: COMPlus_EnableDiagnostics
    value: "0"

# use your cluster name, in this ex biller is used
ingressPathRootName: biller

# use your cluster name, in this ex biller is used
hosts:
  - tlsSecretName: star-invoicecloud-beta-com
    hostnames:
      - biller-v0-dev.invoicecloud-beta.com
      - biller-dev.invoicecloud-beta.com

infrastructureVersion: v0

# use your cluster name, in this ex biller is used
secretProvider:
  keyVaultName: "kv-pri-biller0-dev"
  secretObjects:
    - secretName: "Jwt-SigningCertificate"
      envVarName: "Jwt__SigningCertificate"

nodeSelector:
  agentpool: app
iat.yaml
 (Internal Acceptance Testing)
yaml
replicaCount: 2

image:
  repository: acrglbimages1npd.azurecr.io/yourproject-api

ports:
  - name: http
    port: 80
    protocol: TCP
    targetPort: 8080

extraEnvVars:
  - name: COMPlus_EnableDiagnostics
    value: "0"

# use your cluster name, in this ex biller is used
ingressPathRootName: biller

# use your cluster name, in this ex biller is used
hosts:
  - tlsSecretName: star-invoicecloud-beta-com
    hostnames:
      - biller-v0-iat.invoicecloud-beta.com
      - biller-iat.invoicecloud-beta.com

infrastructureVersion: v0

# use your cluster name, in this ex biller is used
secretProvider:
  keyVaultName: "kv-pri-biller0-iat"
  secretObjects:
    - secretName: "Jwt-SigningCertificate"
      envVarName: "Jwt__SigningCertificate"

nodeSelector:
  agentpool: app
qar.yaml
 (Quality Assurance Regression)
yaml
replicaCount: 2

image:
  repository: acrglbimages1npd.azurecr.io/yourproject-api

ports:
  - name: http
    port: 80
    protocol: TCP
    targetPort: 8080

extraEnvVars:
  - name: COMPlus_EnableDiagnostics
    value: "0"

# use your cluster name, in this ex biller is used
ingressPathRootName: biller

# use your cluster name, in this ex biller is used
hosts:
  - tlsSecretName: star-invoicecloud-beta-com
    hostnames:
      - biller-v0-xat.invoicecloud-beta.com
      - biller-xat.invoicecloud-beta.com

infrastructureVersion: v0

# use your cluster name, in this ex biller is used
secretProvider:
  keyVaultName: "kv-pri-biller0-xat"
  secretObjects:
    - secretName: "Jwt-SigningCertificate"
      envVarName: "Jwt__SigningCertificate"

nodeSelector:
  agentpool: app
xat.yaml
 (External Acceptance Testing)
Note: Images are pulled from the the production ACR 
acrglbimages1prd.azurecr.io
 for XAT, PRD-PRI, and PRD-SEC
yaml
replicaCount: 2

image:
  repository: acrglbimages1prd.azurecr.io/yourproject-api

ports:
  - name: http
    port: 80
    protocol: TCP
    targetPort: 8080

extraEnvVars:
  - name: COMPlus_EnableDiagnostics
    value: "0"

# use your cluster name, in this ex biller is used
ingressPathRootName: biller

# use your cluster name, in this ex biller is used
hosts:
  - tlsSecretName: star-invoicecloud-beta-com
    hostnames:
      - biller-v0-xat.invoicecloud-beta.com
      - biller-xat.invoicecloud-beta.com

infrastructureVersion: v0

# use your cluster name, in this ex biller is used
secretProvider:
  keyVaultName: "kv-pri-biller0-xat"
  secretObjects:
    - secretName: "Jwt-SigningCertificate"
      envVarName: "Jwt__SigningCertificate"

nodeSelector:
  agentpool: app
prd-pri.yaml
 (Production Primary)
Note: Images are pulled from the the production ACR 
acrglbimages1prd.azurecr.io
 for XAT, PRD-PRI, and PRD-SEC
Note: Host configuration uses the production SSL certificate and there is no env component in the host name 
yaml
replicaCount: 2

image:
  repository: acrglbimages1prd.azurecr.io/yourproject-api

ports:
  - name: http
    port: 80
    protocol: TCP
    targetPort: 8080

extraEnvVars:
  - name: COMPlus_EnableDiagnostics
    value: "0"

# use your cluster name, in this ex biller is used
ingressPathRootName: biller

# use your cluster name, in this ex biller is used
hosts:
  - tlsSecretName: star-invoicecloud-com
    hostnames:
      - biller-v0.invoicecloud.com
      - biller.invoicecloud.com

infrastructureVersion: v0

# use your cluster name, in this ex biller is used
secretProvider:
  keyVaultName: "kv-pri-biller0-prd"
  secretObjects:
    - secretName: "Jwt-SigningCertificate"
      envVarName: "Jwt__SigningCertificate"

nodeSelector:
  agentpool: app
prd-sec.yaml
 (Production Secondary) 
Note: Images are pulled from the the production ACR 
acrglbimages1prd.azurecr.io
 for XAT, PRD-PRI, and PRD-SEC
Note: Host configuration uses the production SSL certificate and there is no env component in the host name 
*PRD_SEC is not operationalized
yaml
replicaCount: 2

image:
  repository: acrglbimages1prd.azurecr.io/yourproject-api

ports:
  - name: http
    port: 80
    protocol: TCP
    targetPort: 8080

extraEnvVars:
  - name: COMPlus_EnableDiagnostics
    value: "0"

# use your cluster name, in this ex biller is used
ingressPathRootName: biller

# use your cluster name, in this ex biller is used
hosts:
  - tlsSecretName: star-invoicecloud-com
    hostnames:
      - biller-v0.invoicecloud.com
      - biller.invoicecloud.com

infrastructureVersion: v0

# use your cluster name, in this ex biller is used
secretProvider:
  keyVaultName: "kv-pri-biller0-prd"
  secretObjects:
    - secretName: "Jwt-SigningCertificate"
      envVarName: "Jwt__SigningCertificate"

nodeSelector:
  agentpool: app
 URL:/spaces/ED/pages/3976232976/ASP.Net+Core+API+k8s+Containerized