Jira 
EBPP-26700
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
Reported by
3002 - City of West Melbourne, FL
Reviewed the analysis with
 
Purpose
The purpose of this page is to explain the error encountered when a user(payer) is trying to make a payment from Customer Portal with invoice type of Cloud Store and biller with RTDR setup.  RTDRâ€™s main purpose is get the latest balance value from CIS and show it to customer(payer). 
Option 61 functionality
As part for the reported issue, it is mentioned that for biller i.e. 
3002 - City of West Melbourne, FL 
the option 61 value is set to True i.e., checked
Option 61 behaviour
 
If 
Option 61 is checked
 and 
Biller is setup for RTDR
, it is expected that payer should not be able to make the payment if there is a failure while fetching the current balance values from CIS systems via RTDR call. 
If 
Option 61 is unchecked
 and 
Biller is setup for RTDR
, it is expected that payer should be allowed to make the payment even if there is a failure while fetching the current balance values form CIS systems via RTDR call. 
 If option 61 is checked, then irrespective of logged in user or one-time payment route, payment should be blocked. 
Error message
Blocked Payment
Analysis
Option 61 is behaving as expected and is not the root cause of issue reported in 
EBPP-26700
, the error is encountered due to RTDR call against invoice type of Cloud Store. Currently the logic of when to make the call is written on page (payment route), so in order to handle this error we have to stop making RTDR calls when Invoice type of Cloud Store as 
RTDR is not application for Cloud Store item as there will be no invoices for IC to refresh 
Just an example, current check where RTDR is failing (there can be more reference in current code) 
Repo Name
:  MyIIS
File Name:
 
CustomerSelectedInvoices.aspx.vb
So, we should change how page interacts with RTDR service call i.e. by not making the call if invoice type is Cloud Store as we will not have any balances to refresh. If a customer has multiple invoices with a mix of invoice types of Cloud Store and Utility, then RTRD call should only be make for Utility not for Cloud Store. 
Rule of thumb
: Do not make RTDR call for Cloud Store   
:warning:
atlassian-warning
#FFF0B3
IMPORTANT
Check all the reference wherever page is making the call to RTDR service when Invoice Type Cloud Store is involved.   
Question for SPAM Team
Considering the above code, if RTDR is failing at line number 201 when why we are executing 
RefreshInvoicesForCustomers(customerID, PageBiller.BillerID) 
Thank you 
  for helping me understand the issue! 
 URL:/spaces/PE/pages/4133781542/EBPP-26700+Cloud+Store+-+Customer+unable+to+make+cloud+store+payment+if+the+Option+61+is+enabled.