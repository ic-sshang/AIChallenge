Fill in project details in the table below. Type /date to quickly add the target release date, /jira to link to Jira epics or issues, and @mention functional owners to keep everyone on the same page.
Page Navigation:
Jira tickets
ITG-3700
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
 
Document status
draft
 
Document owner
 
 
 
Solution engineer
 
 
Solutions Design Document: 
CIS: Continental Utility Solutions (CUSI)
Please note that the CIS was not involved in this integration and Lakehaven’s IT team are the ones that create, import and export files. 
API Documentation
Data Synchronization Integration
This section documents the webhook endpoints that the Biller’s system integration team (custom integration) needs to provide to achieve the agreed upon data exchange and synchronization requirements for a real-time integration.
User Experience Integration
This section documents the initial, recommended user experience design for this integration. Since user experience integration uses Invoice Cloud web services that are available to a Biller, it’s possible for the Biller to change at any time without notifying Invoice Cloud after Go-Live how they use our web services.
Cloud Payments V2
Purpose/Summary: Default CityWorks integration will be used to process Permit payments with InvoiceCloud. 
Sample Request:
Additional Details
Biller Request Parameters:
Parameter
Required
True/False
In Request
Y/N
Partner Field Name
Partner Field Description
ReturnURL
False
PostBackURL
False
BillerReference
False
ViewMode
True
CssUrl
False
Customers
True
Customer Data Object:
Parameter
Required
True/False
In Request
Y/N
Partner Field Name
Partner Field Description
AccountNumber
True
Y
CaseID
DisplayAccountNumber
False
Name
False
Address
False
City
False
State
False
Zip
False
EmailAddress
False
Invoices
False
Optional Invoice Data Object
Parameter
Required
True/False
In Request
Y/N
Partner Field Name
Partner Field Description
InvoiceNumber
True
Y
CaseID-Today’sDate
TypeID
False
InvoiceDate
False
DueDate
False
BalanceDue
False
CCServiceFee
False
ACHServiceFee
False
MinimumAmountDue
False
AllowPartialPayments
False
Cloud Payment Settings
Parameter
Required
True/False
In Request
Y/N
Partner Field Name
Partner Field Description
AllowSwipe
False
AllowEMV
False
EMVDeviceID
False
EMVLocationID
False
CashierName
False
AllowCCPayment
False
AllowACHPayment
False
CreateCustomerRecord
False
RemoteAuthenticationToken
False
PageLoadOverride
False
Optional Page User Result UI Options
Parameter
Required
In Request
Partner Field Name
Partner Field Description
InvoiceOptions
Optional
AllowRegisterAccount
Optional
Optional Invoice User Experience Options
Parameter
Required
In Request
Partner Field Name
Partner Field Description
AllowViewStatement
Optional
AllowRemove
Optional
AllowViewRelated
Optional
AllowRemindMe
Optional
User Stories:
CloudPayv2 - Permits
Workflow
Story
Assumptions/Requirements
Sample
Retrieve Invoice to Pay
User navigates to CloudPermit portal and retrieves invoice number to pay. 
Customer and Invoice must already exist on Invoice Cloud systems.
Pay Invoice
User clicks PAY ONLINE button.  This executes Cloud Pay V2 and the Invoice Cloud screen displays.
Invoice Cloud Receipt
After the user completes their payment, the Invoice Cloud receipt page displays.
Return to Home Page
User has completed payment and clicks Return to Home Page.  The CloudPermit portal page is displayed.
The Invoice is marked as PAID (blue highlighting).
Bill 
Presentment
File Summary/Purpose: The purpose of this file is to attach bill images to invoices on IC. PDF extraction will be done by account number. Single PDF file with all bill images
File Extension: .pdf
SFTP File Path: TBA
File Transfer Frequency: Once a week the invoice file is generated based on the cycle that is being billed (5-6 bill files per month) - Invoice batches are created bimonthly. 
Solution Details
PDF Extraction
Sample PDFs: 
 
 
File Mapping
Invoice File
File Summary/Purpose: The purpose of this file is transfer bill/invoice data to IC from the biller
File Extension: .txt
File Naming Convention: BFMMDDYYYY.
txt
File Delimiter: N/A
Specification: 
 
Sample File: 
 
SFTP File Path: TBA
File Transfer Frequency: Once a week the invoice file is generated based on the cycle that is being billed (5-6 bill files per month) - Invoice batches are created bimonthly. 
For Duplicate invoices available in the file (Occupant/Tenant, which have the same account and invoice number), CustomerName will have the value “Occupant” for the duplicate invoice. We will use the invoice that says “OCCUPANT” and customer name shall be saved as “Occupant”. For other accounts with no “Occupant” the Customer Name will be 
used
.
Field Mapping
IC
Record Type
IC
FileSpecID
IC
Field Name
IC Field Required
In Partner File (Y/N)
Partner 
Field Name
Partner 
Field Format
Partner Field Specification
Partner Field Char Limit
File Header
1
RowType
TRUE
N
Set by IC
File Header
2
BillerGuid
TRUE
N
Set by IC
File Header
3
ThirdPartyFileReference
FALSE
N
Set by IC
File Header
4
FileCreationDate
TRUE
N
Set by IC
File Header
5
InvoiceCount
TRUE
N
Set by IC
File Header
6
TotalInvoiceAmount
TRUE
N
Set by IC
Invoice Header
7
RowType
TRUE
N
Set by IC
Invoice Header
8
RecordType
TRUE
N
Set by IC
Invoice Header
9
InvoiceFormatGuid
TRUE
N
Set by IC
Invoice Header
10
InvoiceNumber
TRUE
N
Set by IC
AccountNumber-BillDate
Invoice Header
11
InvoiceDate
TRUE
Y
“Field5” - Billing Date
YYYYMMDD 
Start at 43 
Padding to Right
8
Invoice Header
12
InvoiceDueDate
TRUE
Y
“Field6” - Due Date
YYYYMMDD
Start at 51 
Padding to Right
8
Invoice Header
13
TotalAmountDue
TRUE
Y
“Field4" - Total Due
$ 
Start at 31
Padding to Left
12
Invoice Header
38
Custom1
FALSE
Y
“SvcNbr“ - LocationNo
Start at 4
Padding right
15
Invoice Header
39
Custom2
FALSE
Y
“Field8” - Mail Addr Line 1
Start at 89
Padding right
50
Invoice Header
40
Custom3
FALSE
Y
“Field9” - Mail Addr Line 2
Start at 139
Padding right
50
Invoice Header
41
Custom4
FALSE
Y
“Field10” - Mail City
Start at 189
Padding right
20
Invoice Header
42
Custom5
FALSE
Y
“Field11” - Mail State Code
Start at 209
Padding right
2
Invoice Header
43
Custom6
FALSE
Y
“Field12” - Mail ZIP
NNNNN or NNNNN-NNNN
Start at 211
Padding right
10
Invoice Header
93
BalanceDue
FALSE
N
Invoice Header
194
BalanceForward
FALSE
N
Balance forward will be set via BIF customization 
Invoice Header
407
PastDue
FALSE
Y
“PrvBal” - Previous Balance
$
Start at 223
Padding right
12
Customer Record
58
RowType
TRUE
N
Customer Record
59
AccountNumber
TRUE
Y
“Field3” - Account Number
Start at 19
Padding right
Location Number plus two digits
EX: 10001
12
Customer Record
60
CustomerName
TRUE
Y
“Field7” - Customer Name
If “Occupant”, user “Occupant” as the customer name. 
Start at 59
Padding right
30
Customer Record
61
Address1
FALSE
Y
“Field67” - Service Address
Start at 832
Padding right
30
Customer Record
62
Address2
FALSE
N
Customer Record
63
City
FALSE
Y
“Field68” - Service City
Start at 862
Padding right
20
Customer Record
64
State
FALSE
Y
“Field69” - Service State Code
Start at 882
Padding right
2
Customer Record
65
Zip
FALSE
Y
“Field70” - Service ZIP
Start at 884
Padding right
10
Invoice Detail
70
RowType
TRUE
N
Invoice Header
252
InvoiceTypeID
TRUE
N
Set by IC - 42
Adjustment/Daily Balance File
File Summary/Purpose: The purpose of this file is transfer bill/invoice updated balance data to IC from the biller
File Extension: .
csv
File Delimiter: , 
Specification: 
 
Sample File
: 
 
SFTP File Path: TBA
File Transfer Frequency: Daily
Field Mapping
IC Record Type
IC FileSpecID
IC Field Name
IC Data Type
IC Field Description
IC Field Required
In Partner File (Y/N)
Partner Field Name
Partner Field Format
Partner Field Description
Partner Field Char Limit
Adjustment Header (AH)
305
RowType
varchar(2)
Always AH
TRUE
 N
 Set by IC
 
 
 
Adjustment Header (AH)
306
BillerGuid
varchar(36)
Biller Guid assigned by IC
TRUE
 N
 Set by IC
 
 
 
Adjustment Header (AH)
308
FileCreationDate
date
Date/Time the file was created by the Biller. Used for tracking purposes
TRUE
 N
 Set by IC
 
 
 
Adjustment Header (AH)
309
AdjustmentCount
int
Total number of payments included in payment file
TRUE
 N
 Set by IC
 
 
 
Adjustment Header (AH)
310
TotalAdjustmentAmount
money
Sum of all the payments in the file
TRUE
 N
 Set by IC
 
 
 
Adjustment Record (AR)
311
RowType
varchar(2)
Always AR
TRUE
 N
 Set by IC
 
 
 
Adjustment Record (AR)
313
AccountNumber
varchar(30)
Account number of your customer
TRUE
 Y
 AcctNo
int
First column
 
Adjustment Record (AR)
314
AdjustmentAmount
money
Total amount of the adjustment for this invoice
TRUE
 Y
AcctBalance
int 
Second Column
 
Adjustment Record (AR)
316
AdjustmentTypeID
int
1=Fixed Amount 2=Balance Differential
TRUE
 N
Set by IC - Balance Differential
 
 
 
Customer Update File
File Purpose: The purpose of this file is update block flags on IC from the biller
File Extension: .txt
Sample File: 
 
 
SFTP File Path: TBA
Field Mapping
IC Record Type
IC FileSpecID
IC Field Name
IC Field Required
In Partner File (Y/N)
Partner Field Name
Partner Field Format
Partner Field Description
Partner Field Char Limit
Customer Record (CR)
58
RowType
True
N
 
 
 
Customer Record (CR)
59
AccountNumber
True
Y 
 Field1
12 character account number, left padded with zeros with a space right after
 
 12
Customer Record (CR)
356
BlockPaymentsCC
False
Y
 Field2
Credit card blocking; 1 = block, 0 = do not block with a space after
 
 1
Customer Record (CR)
357
BlockPaymentsEFT
False
Y 
 Field3
ACH blocking; 1 = block, 0 = do not block
 
 1
Payment
/Lockbox File
File Summary/Purpose: The purpose of this file is transfer payment data from IC to the biller
File Extension: .txt
File Naming Convention:
 
Approved Payments: ”MMDDYYYY-Payments.txt”
Non-Approved Payments: “MMDDYYYY-RejectedReversedPayments.txt”
Specifications: 
Non approved payments should not be added to the payment file. Do not include CloudPayv2 payments. 
Included Payment Types:
All Payment Channels (Payment File)
ACH Rejects - Only R Code (Reversed Payment File)
Credits
 (Reversed Payment File)
Chargebacks (Reversed Payment File)
Declines (Reversed Payment File)
Voids (Reversed Payment File)
Payment Code Mapping: Not requested. 
Payment Source ID - Payment Source Description:  Not requested. 
Sample File:
 SFTP File Path:
File Transfer Frequency: 
Daily
Field Mapping
Col
Width
Description
IC Value
 1
5
Reference number
Auth Order Number (in Biller Portal) 
IC RejectReference - payments.RejectReference (in Database)
6
4
Year
The date column needs to be 10 digits wide, with the month and day left padded with zeros.
Payment Year 
10
2
Month -  padded left “0”s
The date column needs to be 10 digits wide, with the month and day left padded with zeros.
Payment Month 
12
2
Day -  padded left “0”s
The date column needs to be 10 digits wide, with the month and day left padded with zeros.
Payment Day 
14
6
Location number - padded right space
Custom1
20
8
Account number - padded right space
IC Account Number
28
9
Payment amount, left padded with zeros, no decimal
padded left “0”s, no negatives or decimals
Payment Amount
Change Log File
File Summary/Purpose: The purpose of this file is transfer change log data from IC to the biller
File Extension: .txt
File Naming Convention: 
File Delimiter:  pipe 
Specification
: Default IC Change Log - 
#47 IF_Generic Pipe Changelogs - Account Number - w/Headers
 - Only the true daily changes being made will be included. 
Sample File: 
SFTP File Path: TBA
File Transfer Frequency: Daily
Field Mapping
Field
Data Type
Character Limits
Format
Values
Account Number
Varchar 
30 
Account Number from IC database
AutoPay Enrollment
Datetime
MMDDYYYYHHMMSS
Date customer completed enrollment in AutoPay
AutoPay Un-Enrollment
Datetime
MMDDYYYYHHMMSS
Date customer completed un - enrollment in AutoPay
Previous Email
Varchar
100
Previous Customer email address
New Email
Varchar
100
New Customer email address
Email Address change date
Datetime
MMDDYYYYHHMMSS
Date email address was change on IC
Paperless Enrollment
Datetime
MMDDYYYYHHMMSS
Date customer completed enrollment in paperless
Paperless Un-enrollment
Datetime
MMDDYYYYHHMMSS
Date customer un-enrolled in paperless
Advanced Settings
Setting ID
Required/Optional/N/A
Description
Details and Logic
Value
Is value unique per biller? (Y/N)
Invoice Types
Invoice Types
42
Required Options
Input required integration options below.
ID
Option Description
Details
74
ENABLE Multiple Customer Login Functionality
If enabled, the Biller will be able to use the Multiple Customer Login functionality in the Biller Portal as well as the Customer Portal. The Pay By Text and Autopay option will also be hidden through the payment route for non-authenticated sessions, and the use of saved method payments through the IVR will be disabled.
Make sure this is enabled 
Biller Invoice File (BIF) Customizations
Feature
BIF CUSTOMIZATIONS
AllowPartialPayments
BIF Customization 
AutoPayCollectionDate
BIF Customization 
BalanceForward
BIF Customization - Lakehaven will be Balance Forward
FirstNotifyRequestedDate
BIF Customization 
InvoiceDate
BIF
InvoiceDueDate
BIF
InvoiceFormatGuid
BIF Customization 
LateFeeDate
N/A
LocationReference
N/A
MinimumAmountDue
N/A
PaymentExpirationDate
N/A
PaymentExpirationMessage
N/A
PromptPayExpirationDate
N/A
RegistrationValue
N/A
SecondNotifyRequestedDate
BIF Customization 
ThirdNotifyRequestedDate
BIF Customization 
User Interaction and Design
Recording of Biller steps on how to create Invoice and Adjustment files and upload Payment files: 
https://us-21061.app.gong.io/call?id=4411129266800636590
 
Data Flow - Invoice
Invoice Files will be sent via SFTP. A conversion will occur to switch their file format to BIF. 
Data Flow - Adjustments
Adjustment Files will be sent via SFTP. A conversion will occur to switch their file format to BAF. 
Data Flow - Invoice Updates
Data Flow - Customer Update
Data Flow - Conveyance
Account Numbers are unique per service connection number so the account number will never be reused by a different customer. The account number changes when the property ownership changes. The location number is assigned to property while the account number is assigned to the individual. 
Data Flow - Payment
Payment Files will be sent via SFTP.
Data Flow - Void
Void payment Files will be sent via SFTP.
Data Flow - ACH Reject
ACH Reject Files will be sent via SFTP.
Data Flow - Change Log
Files will be sent via SFTP.
Data Flow - Bill Presentment
PDF Extraction
Payer Experience
Payers will access Invoice Cloud from the Biller website (URL redirect). Payers will use the IC Virtual Site and Customer Portal. 
Lakehaven will be using Multiuser Functionality for their Landlords and Tenants to be able to manage their accounts and process payments with separate login information. 
Biller Experience
Biller Portal will be used by CSR. Payments can be processed with an EMV device through the Biller Portal. Permits will be processed through the Cityworks portals with CloudPayv2. 
Integration Sizing
Total Initial LOE (By Story Points)
38
In Integration?
Name
Category
Component
Initial LOE (By Story Points)




1


1


incomplete


Y/N




Adjustments File Split
Adjustments
Biller File Split
5




2


2


incomplete


Y/N




Adjustments
Adjustments
Native Web Services
0




3


3


incomplete


Y/N




Balance Refresh
Adjustments
Real-Time Data Refresh
5




4


4


complete


Y/N




Adjustment File Conversion
Adjustments
File Conversion
8




5


5


incomplete


Y/N




Bill Presentment
Bill Presentment
HTML Template
8




6


6


incomplete


Y/N




Bill Presentment
Bill Presentment
Native Web Services
0




7


7


complete


Y/N




Bill Presentment
Bill Presentment
PDF Extraction
3




8


8


incomplete


Y/N




Bill Presentment
Bill Presentment
PDF Remote Linking
2




9


9


incomplete


Y/N




Change Logs
Change Logs
DataPump
5




10


10


incomplete


Y/N




Customer Status Report
Change Logs
File Export
3




11


11


complete


Y/N




Customer Change Log
Change Logs
File Export
2




12


12


incomplete


Y/N




Change Logs
Change Logs
Native Web Services
0




13


13


incomplete


Y/N




File Size Split
Invoices
Biller File Split
2




14


14


incomplete


Y/N




Invoice Update File Split
Invoices
Biller File Split
3




15


15


incomplete


Y/N




Pre-Processing
Invoices
Biller File Split
8




16


16


incomplete


Y/N




Batch Invoices
Invoices
Native Web Services
0




17


17


incomplete


Y/N




Single Invoices
Invoices
Native Web Services
0




18


18


incomplete


Y/N




Invoice Update
Invoices
Real-Time Data Refresh
1




19


19


incomplete


Y/N




Invoice Generation
Invoices
Real-Time Data Refresh
5




20


20


incomplete


Y/N




Invoice On-Demand
Invoices
Real-Time Data Refresh
13




21


21


complete


Y/N




Invoice File Conversion
Invoices
File Conversion
8




22


22


incomplete


Y/N




Invoice Generation
Invoices
Biller API Data Import
5




23


23


incomplete


Y/N




ACH Rejects
Payments
DataPump
5




24


24


incomplete


Y/N




Chargebacks
Payments
DataPump
5




25


25


incomplete


Y/N




Payment Export
Payments
DataPump
5




26


26


incomplete


Y/N




Voids
Payments
DataPump
3




27


27


complete


Y/N




ACH Rejects
Payments
File Export
5




28


28


complete


Y/N




Chargebacks
Payments
File Export
3




29


29


complete


Y/N




Payment Export
Payments
File Export
5




30


30


complete


Y/N




Voids
Payments
File Export
3




31


31


incomplete


Y/N




Payment Export
Payments
Native Web Services
0




32


32


incomplete


Y/N




Payment File Conversion
Payments
File Conversion
8




33


33


incomplete


Y/N




Conveyance File Split
Customers
Biller File Split
13




34


34


incomplete


Y/N




Customer Update File Split
Customers
Biller File Split
3




35


35


complete


Y/N




Customer Update
Customers
Real-Time Data Refresh
1




36


36


incomplete


Y/N




Endpoint Authentication
Real-Time Data Refresh
5




37


37


incomplete


Y/N




Endpoint Authentication
DataPump
5
Integration Modifications
Jira INT
Date Released
Previous Behavior
Desired Behavior
Business Case/Solution
 URL:/spaces/IM/pages/4266819585/LakeHaven+Technical+Design