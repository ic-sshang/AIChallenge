Overview
For 
SFB (BID: 
3898
) and TxFB (BID: 4037)
 Go Live commitments a new endpoint for adding, modifying, and deleting the email of Account numbers was created. This new endpoint allows Billers to modify the customers email address without needing a CustomerGUID as long as they can call an ICRESTAPI method with their Biller API key. 
Billers also requested that the new endpoint is able to handle all requests for adding, modifying and deleting the customerâ€™s email address using a single URL, which was solved by differentiating each function with a different http verb.
The deployment Date for these changes was: 
10/31/2024 ðŸŽƒ
Important Note:
InvoiceCloud policy is not to have any registered customer without an email address so when a Biller uses the delete function of the new endpoint it is also unregistering the account by removing the logins associated with it and creating a new blank login for the customer. By unregistering the account, all the information attached to that login (AutoPay, Paperless, Payment Methods, etc.) gets removed as well.
At the moment, these changes are not compatible with SSO SAML integrations. Billers with this configuration cannot use this service.
Adding Email Address
POST
By passing an account number and email address the biller can call this endpoint to add an email address for a Customer record without any email address associated with it
Modifying Email Address
PATCH
By passing an Account Number and email address the biller can call this endpoint to update an email address for a Customer record with an existing email address associated with it
Deleting Email Address
DELETE
By passing an Account Number the biller can call this endpoint to delete the email address associated with the Customer record and as per InvoiceCloud policies unregister the account and delete the Ownerâ€™s login information
Story
EBPP-20343
2278e126-27dc-36c8-aef9-a32d91bc7ad7
System Jira
 
Repo and Codebase
The changes are in ICRESTAPI repo under the 
Controllers/LoginsController.vb file
Biller Documentation Page
Add - 
https://www.invoicecloud.com/Documentation/webservicesrest/emailaddress/Add.aspx?path=Web+Services+(REST)%2FEmail+Address%2FAdd
Update - 
https://www.invoicecloud.com/Documentation/webservicesrest/emailaddress/Update.aspx?path=Web+Services+(REST)%2FEmail+Address%2FUpdate
Delete - 
https://www.invoicecloud.com/Documentation/webservicesrest/emailaddress/Delete.aspx?path=Web+Services+(REST)%2FEmail+Address%2FDelete
URL and Testing
To test this item and make changes do the following steps:
Download the ICRESTAPI repo in Visual Studio
Run the latest release of the repo in Visual Studio
Using the Postman scripts posted below, run the queries against the endpoints for going through the workflow
Production URL: 
https://www.invoicecloud.com/api/logins/v1?accountnumber=WTR-901810
Postman scripts:
Technologies Used
API Versioning
Allows for easy management of multiple versions of the same endpoints to implement new changes without losing support for existing code bases
https://weblogs.asp.net/ricardoperes/asp-net-core-api-versioning
 
API Verbs
Using multiple verbs we can use the same URL for different use cases in the endpoint. In this specific case, we are using ADD, PATCH, DELETE
https://docs.oracle.com/en/cloud/saas/marketing/eloqua-develop/Developers/GettingStarted/APIRequests/HTTP-verbs.htm
 
Command Design Pattern
This allows for creating a single command object that will take care of running all of the business logic with encapsulated dependencies to the data layer and any other one needed to function properly
https://www.geeksforgeeks.org/command-pattern/
 
Workflow
2
1
0
0
3853254819
3834118150
1
Untitled Diagram-1734993632671.drawio
2
2
https://invoicecloud.atlassian.net/wiki
Untitled Diagram-1734993632671.drawio
0
836.5
851
 URL:/spaces/PE/pages/3834118150/Email+Management+API