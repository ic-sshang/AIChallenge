Background
In 
CRM
, the current model designates entire 
domains
 as 
Default
. If an invoice type is not explicitly mapped to a domain, CRM falls back to this default domain for sending emails.
In 
Biller Portal
, however, the default designation is applied at the 
email (alias)
 level. Since a single domain can have multiple email aliases, this creates a mismatch in behavior.
 
Problem Statement
When CRM marks a 
domain
 as primary/default:
Multiple invoice types may be mapped to the same domain, but each may use a different alias.
In Biller Portal, this results in 
all aliases under that domain being shown as Default
, which is misleading.
CRM currently uses the 
primary domain
 for general notifications.
In Biller Portal, notification handling is tied to 
invoice type
, with its own specific email and sender name.
This mismatch leads to inconsistent behavior between systems.
Root Cause
CRM’s model treats “Default” at the 
domain level
.
Biller Portal treats “Default” at the 
email/alias level
.
Lack of separation between 
Default (per invoice type)
 and 
General Notification (system-wide)
 is causing overlap.
Proposed Solution
To align both systems, CRM must shift the “Default” designation from 
domain
 to 
alias
, ensuring consistency with Biller Portal.
 
Key Concept Change
Separate “IsPrimary” into two distinct flags:
IsDefault
 → Applied at the alias/email level (used per invoice type).
General Notification
 → A distinct setting for system notifications (independent of invoice types).
Scope of Change
Repositories Impacted
IC.EmailQueueFramework
EQP
BillerPortal
ICCRM
 
Detailed Changes
CRM
Remove 
IsPrimary
 from the Domains grid and the Add/Update Domain popup.
Introduce 
General Notification
 as an invoice type.
Update the Alias Configuration grid:
Add 
IsDefault
 column.
Add action to mark an alias as default.
Default handling to be alias-based instead of domain-based.
 
Biller Portal
Update logic to interpret 
IsDefault at the email (alias + domain) level
.
EQP
Modify logic to 
handle “General Notification” and “Default” separately
.
Ensure support for 
deactivated emails
.
Database Changes
Add 
IsDefault
 column to 
BillerEmailDomainInvoiceTypes
 table.
Data migration to update existing records accordingly.
Remove 
IsPrimary
 column from 
Domains
 table.
Make 
InvoiceTypeID
 nullable in 
BillerEmailDomainInvoiceTypes
 table.
Business Impact
Eliminates inconsistent default email behavior between CRM and Biller Portal.
Provides clearer separation of 
general system notifications
 vs 
invoice-specific communications
.
Reduces confusion for billers and customers, ensuring correct sender information per invoice type.
Improves maintainability and aligns CRM and Biller Portal with a unified data model.
 URL:/spaces/PE/pages/4644241471/Analysis+Domain+Alias+Default+Handling+in+CRM+and+Biller+Portal