Leading to outage
All web sites became unreachable soon after 10:23 am EST
Change causing outage - what and why
1
0
3337420832
3337453611
true
prodchanges.drawio.svg
2
0
7
https://invoicecloud.atlassian.net/wiki
prodchanges.drawio.svg
0
A73TjwA0_ZjkoHGAKFUq 1
581
auto
top
1
351
Why
k8s build agents in Production tooling infrastructure in Production hub was unable to reach Proxy load balancers (the 
green
 line over through 
blue
 double pipe indicating VNET peering) between InternalNetwork vnet and Production Hub, in the picture was not working.
This connection is necessary for the k8s build agents to run anything against the database service - in this particular instance, for them to utilize the service for data restaging for SIT testing.
What
New route was added to IC-LoadBalancer-RT to route return traffic to hub vnet CIDR and was associated with LoadBalancer subnet
Results
It turned out to be an incorrect resolution.
This change caused disruption in web traffic
Tactical mitigation
Changed was rolled back in 10:30 am est and web traffic resumed to be normal
Long term corrections
Testing in nonproduction
This change was not assumed to cause any production outage.  This assumption proved incorrect.
Correction:
 Reproduce change in nonprod (if possible) before performing change in production
Clean up Specific routes 
Currently, there are specifics routes for each subnet. This change was made as part of Barracuda L3 to Palo Alto gradual migration.
Correction:
 Removal specific routes
Ensuring opening a prod change ticket
A ticket was not opened and approved to perform a production change.
Correction:
 Any prod touchpoint going forward will not be allowed without a Service Management ticket approval (with due diligence).
If deemed necessary , this change will be held back for a planned or emergency maintenance window.
Removal of Primary subscription access
While cleaned up during SOX audit establishment, there is still more than desired modify access to production subscriptions (more so Primary Subscription than Enterprise Prod Subscription)
Correction:
 Contributor or owner role memberships should be reduced to minimal
Alerts based network volume
Currently there is no alerting if network traffic drops below a threshold or 0
Correction:
 Add alerting at each network layer (CF,AppGW, Kong, VMs)
Definition of whatâ€™s a production change
Currently, there is no clear definition of production scope (Azure, Palo, Cloudflare)
Correction:
 Define scope of production change
 URL:/spaces/icinfradoc/pages/3337453611/RCA-inc-7770_connection_timed_out