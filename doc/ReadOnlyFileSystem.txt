In 
Kubernetes (K8s)
, setting a 
readOnlyRootFilesystem
 in the 
Security Context
 of a pod or container is a powerful security measure. Read on to find out why it's important!
none
üîê What is 
readOnlyRootFilesystem
?
It's a Boolean setting in the container's 
security context
 that, when set to 
true
, mounts the container's root filesystem as 
read-only
. This means:
The container 
cannot write
 to its root filesystem.
Only explicitly mounted volumes (like 
/tmp
 or 
/data
) can be writable if needed.
‚úÖ Benefits of Using 
readOnlyRootFilesystem
Reduces Attack Surface
\ Prevents attackers from writing malicious files or modifying binaries if they gain access to the container.
Mitigates Persistence Risks
\ Malware or unauthorized changes can't persist across container restarts because the root filesystem is immutable.
Enforces Immutable Infrastructure
\ Encourages best practices where containers are treated as immutable units, promoting consistency and reliability.
Limits Misconfigurations
\ Prevents accidental writes to the root filesystem by applications or scripts.
Improves Compliance
\ Helps meet security standards like CIS Benchmarks and NIST guidelines for container hardening.
üõ†Ô∏è Example in a Pod Spec
apiVersion: v1
kind: Pod
metadata:
  name: secure-pod
spec:
  containers:
  - name: app
    image: myapp:latest
    securityContext:
      readOnlyRootFilesystem: true
    volumeMounts:
    - name: temp-storage
      mountPath: /tmp
  volumes:
  - name: temp-storage
    emptyDir: {}

In this example:
The root filesystem is read-only.
/tmp
 is writable via an 
emptyDir
 volume.
‚ö†Ô∏è Considerations
Some applications may require write access to certain directories. You‚Äôll need to mount writable volumes for those.
Logging, caching, or temporary file operations must be redirected to writable paths.
Logging should be done thru STDOUT or other Logging Frameworks that support structured logging to STDOUT such as 
Serilog
.
 InvoiceCloud Helm Chart Support
The 
readOnlyRootFilesystem
 is supported by the 
InvoiceCloud Web Helm Chart
.
Example usage from BillerReportingChatAPI‚Äôs 
DEV Helm Chart Values file
:
replicaCount: 2

image:
  repository: acrglbimages1npd.azurecr.io/biller-reporting-chat-api

ports:
  - name: http
    port: 80
    protocol: TCP
    targetPort: 8080

extraEnvVars:
  - name: COMPlus_EnableDiagnostics
    value: "0"
  - name: GraphQl__ApiUrl
    value: "https://api-dev.invoicecloud-beta.com/biller/biller-reporting-api"

ingressPathRootName: biller

hosts:
  - tlsSecretName: star-invoicecloud-beta-com
    hostnames:
      - biller-v0-dev.invoicecloud-beta.com

infrastructureVersion: v0

secretProvider:
  keyVaultName: "kv-pri-biller0-dev"
  secretObjects:
    - secretName: "OpenAi-ApiKey"
      envVarName: "OpenAi__ApiKey"
    - secretName: "OpenAi-ApiUrl"
      envVarName: "OpenAi__ApiUrl"
    - secretName: "OpenAi-DeploymentId"
      envVarName: "OpenAi__DeploymentId"
    - secretName: "Jwt-SigningCertificate"
      envVarName: "Jwt__SigningCertificate"

containerSecurityContext:
  readOnlyRootFilesystem: true

nodeSelector:
  agentpool: app
 URL:/spaces/platform/pages/4519067750/ReadOnlyFileSystem